(()=>{var __require=(x2=>typeof require!=="undefined"?require:typeof Proxy!=="undefined"?new Proxy(x2,{get:(a,b)=>(typeof require!=="undefined"?require:a)[b]}):x2)(function(x2){if(typeof require!=="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+x2+'" is not supported')});var __create=Object.create;var __defProp=Object.defineProperty;var __getOwnPropDesc=Object.getOwnPropertyDescriptor;var __getOwnPropNames=Object.getOwnPropertyNames;var __getProtoOf=Object.getPrototypeOf;var __hasOwnProp=Object.prototype.hasOwnProperty;var __require2=(x2=>typeof __require!=="undefined"?__require:typeof Proxy!=="undefined"?new Proxy(x2,{get:(a,b)=>(typeof __require!=="undefined"?__require:a)[b]}):x2)(function(x2){if(typeof __require!=="undefined")return __require.apply(this,arguments);throw new Error('Dynamic require of "'+x2+'" is not supported')});var __commonJS=(cb,mod)=>function __require22(){return mod||(0,cb[__getOwnPropNames(cb)[0]])((mod={exports:{}}).exports,mod),mod.exports};var __copyProps=(to,from,except,desc)=>{if(from&&typeof from==="object"||typeof from==="function"){for(let key of __getOwnPropNames(from))if(!__hasOwnProp.call(to,key)&&key!==except)__defProp(to,key,{get:()=>from[key],enumerable:!(desc=__getOwnPropDesc(from,key))||desc.enumerable})}return to};var __toESM=(mod,isNodeMode,target)=>(target=mod!=null?__create(__getProtoOf(mod)):{},__copyProps(isNodeMode||!mod||!mod.__esModule?__defProp(target,"default",{value:mod,enumerable:true}):target,mod));var require_sjcl=__commonJS({"services/e2ee/sjcl.js"(exports,module){"use strict";var sjcl2={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(a){this.toString=function(){return"CORRUPT: "+this.message};this.message=a},invalid:function(a){this.toString=function(){return"INVALID: "+this.message};this.message=a},bug:function(a){this.toString=function(){return"BUG: "+this.message};this.message=a},notReady:function(a){this.toString=function(){return"NOT READY: "+this.message};this.message=a}}};sjcl2.cipher.aes=function(a){this.s[0][0][0]||this.O();var b,c2,d3,e,f=this.s[0][4],g2=this.s[1];b=a.length;var h=1;if(4!==b&&6!==b&&8!==b)throw new sjcl2.exception.invalid("invalid aes key size");this.b=[d3=a.slice(0),e=[]];for(a=b;a<4*b+28;a++){c2=d3[a-1];if(0===a%b||8===b&&4===a%b)c2=f[c2>>>24]<<24^f[c2>>16&255]<<16^f[c2>>8&255]<<8^f[c2&255],0===a%b&&(c2=c2<<8^c2>>>24^h<<24,h=h<<1^283*(h>>7));d3[a]=d3[a-b]^c2}for(b=0;a;b++,a--)c2=d3[b&3?a:a-4],e[b]=4>=a||4>b?c2:g2[0][f[c2>>>24]]^g2[1][f[c2>>16&255]]^g2[2][f[c2>>8&255]]^g2[3][f[c2&255]]};sjcl2.cipher.aes.prototype={encrypt:function(a){return t(this,a,0)},decrypt:function(a){return t(this,a,1)},s:[[[],[],[],[],[]],[[],[],[],[],[]]],O:function(){var a=this.s[0],b=this.s[1],c2=a[4],d3=b[4],e,f,g2,h=[],k=[],l,n,m,p;for(e=0;256>e;e++)k[(h[e]=e<<1^283*(e>>7))^e]=e;for(f=g2=0;!c2[f];f^=l||1,g2=k[g2]||1)for(m=g2^g2<<1^g2<<2^g2<<3^g2<<4,m=m>>8^m&255^99,c2[f]=m,d3[m]=f,n=h[e=h[l=h[f]]],p=16843009*n^65537*e^257*l^16843008*f,n=257*h[m]^16843008*m,e=0;4>e;e++)a[e][f]=n=n<<24^n>>>8,b[e][m]=p=p<<24^p>>>8;for(e=0;5>e;e++)a[e]=a[e].slice(0),b[e]=b[e].slice(0)}};function t(a,b,c2){if(4!==b.length)throw new sjcl2.exception.invalid("invalid aes block size");var d3=a.b[c2],e=b[0]^d3[0],f=b[c2?3:1]^d3[1],g2=b[2]^d3[2];b=b[c2?1:3]^d3[3];var h,k,l,n=d3.length/4-2,m,p=4,r=[0,0,0,0];h=a.s[c2];a=h[0];var q2=h[1],v=h[2],w3=h[3],x2=h[4];for(m=0;m<n;m++)h=a[e>>>24]^q2[f>>16&255]^v[g2>>8&255]^w3[b&255]^d3[p],k=a[f>>>24]^q2[g2>>16&255]^v[b>>8&255]^w3[e&255]^d3[p+1],l=a[g2>>>24]^q2[b>>16&255]^v[e>>8&255]^w3[f&255]^d3[p+2],b=a[b>>>24]^q2[e>>16&255]^v[f>>8&255]^w3[g2&255]^d3[p+3],p+=4,e=h,f=k,g2=l;for(m=0;4>m;m++)r[c2?3&-m:m]=x2[e>>>24]<<24^x2[f>>16&255]<<16^x2[g2>>8&255]<<8^x2[b&255]^d3[p++],h=e,e=f,f=g2,g2=b,b=h;return r}sjcl2.bitArray={bitSlice:function(a,b,c2){a=sjcl2.bitArray.$(a.slice(b/32),32-(b&31)).slice(1);return void 0===c2?a:sjcl2.bitArray.clamp(a,c2-b)},extract:function(a,b,c2){var d3=Math.floor(-b-c2&31);return((b+c2-1^b)&-32?a[b/32|0]<<32-d3^a[b/32+1|0]>>>d3:a[b/32|0]>>>d3)&(1<<c2)-1},concat:function(a,b){if(0===a.length||0===b.length)return a.concat(b);var c2=a[a.length-1],d3=sjcl2.bitArray.getPartial(c2);return 32===d3?a.concat(b):sjcl2.bitArray.$(b,d3,c2|0,a.slice(0,a.length-1))},bitLength:function(a){var b=a.length;return 0===b?0:32*(b-1)+sjcl2.bitArray.getPartial(a[b-1])},clamp:function(a,b){if(32*a.length<b)return a;a=a.slice(0,Math.ceil(b/32));var c2=a.length;b=b&31;0<c2&&b&&(a[c2-1]=sjcl2.bitArray.partial(b,a[c2-1]&2147483648>>b-1,1));return a},partial:function(a,b,c2){return 32===a?b:(c2?b|0:b<<32-a)+1099511627776*a},getPartial:function(a){return Math.round(a/1099511627776)||32},equal:function(a,b){if(sjcl2.bitArray.bitLength(a)!==sjcl2.bitArray.bitLength(b))return false;var c2=0,d3;for(d3=0;d3<a.length;d3++)c2|=a[d3]^b[d3];return 0===c2},$:function(a,b,c2,d3){var e;e=0;for(void 0===d3&&(d3=[]);32<=b;b-=32)d3.push(c2),c2=0;if(0===b)return d3.concat(a);for(e=0;e<a.length;e++)d3.push(c2|a[e]>>>b),c2=a[e]<<32-b;e=a.length?a[a.length-1]:0;a=sjcl2.bitArray.getPartial(e);d3.push(sjcl2.bitArray.partial(b+a&31,32<b+a?c2:d3.pop(),1));return d3},i:function(a,b){return[a[0]^b[0],a[1]^b[1],a[2]^b[2],a[3]^b[3]]},byteswapM:function(a){var b,c2;for(b=0;b<a.length;++b)c2=a[b],a[b]=c2>>>24|c2>>>8&65280|(c2&65280)<<8|c2<<24;return a}};sjcl2.codec.utf8String={fromBits:function(a){var b="",c2=sjcl2.bitArray.bitLength(a),d3,e;for(d3=0;d3<c2/8;d3++)0===(d3&3)&&(e=a[d3/4]),b+=String.fromCharCode(e>>>8>>>8>>>8),e<<=8;return decodeURIComponent(escape(b))},toBits:function(a){a=unescape(encodeURIComponent(a));var b=[],c2,d3=0;for(c2=0;c2<a.length;c2++)d3=d3<<8|a.charCodeAt(c2),3===(c2&3)&&(b.push(d3),d3=0);c2&3&&b.push(sjcl2.bitArray.partial(8*(c2&3),d3));return b}};sjcl2.codec.hex={fromBits:function(a){var b="",c2;for(c2=0;c2<a.length;c2++)b+=((a[c2]|0)+0xf00000000000).toString(16).substr(4);return b.substr(0,sjcl2.bitArray.bitLength(a)/4)},toBits:function(a){var b,c2=[],d3;a=a.replace(/\s|0x/g,"");d3=a.length;a=a+"00000000";for(b=0;b<a.length;b+=8)c2.push(parseInt(a.substr(b,8),16)^0);return sjcl2.bitArray.clamp(c2,4*d3)}};sjcl2.codec.base32={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",X:"0123456789ABCDEFGHIJKLMNOPQRSTUV",BITS:32,BASE:5,REMAINING:27,fromBits:function(a,b,c2){var d3=sjcl2.codec.base32.BASE,e=sjcl2.codec.base32.REMAINING,f="",g2=0,h=sjcl2.codec.base32.B,k=0,l=sjcl2.bitArray.bitLength(a);c2&&(h=sjcl2.codec.base32.X);for(c2=0;f.length*d3<l;)f+=h.charAt((k^a[c2]>>>g2)>>>e),g2<d3?(k=a[c2]<<d3-g2,g2+=e,c2++):(k<<=d3,g2-=d3);for(;f.length&7&&!b;)f+="=";return f},toBits:function(a,b){a=a.replace(/\s|=/g,"").toUpperCase();var c2=sjcl2.codec.base32.BITS,d3=sjcl2.codec.base32.BASE,e=sjcl2.codec.base32.REMAINING,f=[],g2,h=0,k=sjcl2.codec.base32.B,l=0,n,m="base32";b&&(k=sjcl2.codec.base32.X,m="base32hex");for(g2=0;g2<a.length;g2++){n=k.indexOf(a.charAt(g2));if(0>n){if(!b)try{return sjcl2.codec.base32hex.toBits(a)}catch(p){}throw new sjcl2.exception.invalid("this isn't "+m+"!")}h>e?(h-=e,f.push(l^n>>>h),l=n<<c2-h):(h+=d3,l^=n<<c2-h)}h&56&&f.push(sjcl2.bitArray.partial(h&56,l,1));return f}};sjcl2.codec.base32hex={fromBits:function(a,b){return sjcl2.codec.base32.fromBits(a,b,1)},toBits:function(a){return sjcl2.codec.base32.toBits(a,1)}};sjcl2.codec.base64={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(a,b,c2){var d3="",e=0,f=sjcl2.codec.base64.B,g2=0,h=sjcl2.bitArray.bitLength(a);c2&&(f=f.substr(0,62)+"-_");for(c2=0;6*d3.length<h;)d3+=f.charAt((g2^a[c2]>>>e)>>>26),6>e?(g2=a[c2]<<6-e,e+=26,c2++):(g2<<=6,e-=6);for(;d3.length&3&&!b;)d3+="=";return d3},toBits:function(a,b){a=a.replace(/\s|=/g,"");var c2=[],d3,e=0,f=sjcl2.codec.base64.B,g2=0,h;b&&(f=f.substr(0,62)+"-_");for(d3=0;d3<a.length;d3++){h=f.indexOf(a.charAt(d3));if(0>h)throw new sjcl2.exception.invalid("this isn't base64!");26<e?(e-=26,c2.push(g2^h>>>e),g2=h<<32-e):(e+=6,g2^=h<<32-e)}e&56&&c2.push(sjcl2.bitArray.partial(e&56,g2,1));return c2}};sjcl2.codec.base64url={fromBits:function(a){return sjcl2.codec.base64.fromBits(a,1,1)},toBits:function(a){return sjcl2.codec.base64.toBits(a,1)}};sjcl2.hash.sha256=function(a){this.b[0]||this.O();a?(this.F=a.F.slice(0),this.A=a.A.slice(0),this.l=a.l):this.reset()};sjcl2.hash.sha256.hash=function(a){return new sjcl2.hash.sha256().update(a).finalize()};sjcl2.hash.sha256.prototype={blockSize:512,reset:function(){this.F=this.Y.slice(0);this.A=[];this.l=0;return this},update:function(a){"string"===typeof a&&(a=sjcl2.codec.utf8String.toBits(a));var b,c2=this.A=sjcl2.bitArray.concat(this.A,a);b=this.l;a=this.l=b+sjcl2.bitArray.bitLength(a);if(9007199254740991<a)throw new sjcl2.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!==typeof Uint32Array){var d3=new Uint32Array(c2),e=0;for(b=512+b-(512+b&511);b<=a;b+=512)u(this,d3.subarray(16*e,16*(e+1))),e+=1;c2.splice(0,16*e)}else for(b=512+b-(512+b&511);b<=a;b+=512)u(this,c2.splice(0,16));return this},finalize:function(){var a,b=this.A,c2=this.F,b=sjcl2.bitArray.concat(b,[sjcl2.bitArray.partial(1,1)]);for(a=b.length+2;a&15;a++)b.push(0);b.push(Math.floor(this.l/4294967296));for(b.push(this.l|0);b.length;)u(this,b.splice(0,16));this.reset();return c2},Y:[],b:[],O:function(){function a(a2){return 4294967296*(a2-Math.floor(a2))|0}for(var b=0,c2=2,d3,e;64>b;c2++){e=true;for(d3=2;d3*d3<=c2;d3++)if(0===c2%d3){e=false;break}e&&(8>b&&(this.Y[b]=a(Math.pow(c2,.5))),this.b[b]=a(Math.pow(c2,1/3)),b++)}}};function u(a,b){var c2,d3,e,f=a.F,g2=a.b,h=f[0],k=f[1],l=f[2],n=f[3],m=f[4],p=f[5],r=f[6],q2=f[7];for(c2=0;64>c2;c2++)16>c2?d3=b[c2]:(d3=b[c2+1&15],e=b[c2+14&15],d3=b[c2&15]=(d3>>>7^d3>>>18^d3>>>3^d3<<25^d3<<14)+(e>>>17^e>>>19^e>>>10^e<<15^e<<13)+b[c2&15]+b[c2+9&15]|0),d3=d3+q2+(m>>>6^m>>>11^m>>>25^m<<26^m<<21^m<<7)+(r^m&(p^r))+g2[c2],q2=r,r=p,p=m,m=n+d3|0,n=l,l=k,k=h,h=d3+(k&l^n&(k^l))+(k>>>2^k>>>13^k>>>22^k<<30^k<<19^k<<10)|0;f[0]=f[0]+h|0;f[1]=f[1]+k|0;f[2]=f[2]+l|0;f[3]=f[3]+n|0;f[4]=f[4]+m|0;f[5]=f[5]+p|0;f[6]=f[6]+r|0;f[7]=f[7]+q2|0}sjcl2.mode.ccm={name:"ccm",G:[],listenProgress:function(a){sjcl2.mode.ccm.G.push(a)},unListenProgress:function(a){a=sjcl2.mode.ccm.G.indexOf(a);-1<a&&sjcl2.mode.ccm.G.splice(a,1)},fa:function(a){var b=sjcl2.mode.ccm.G.slice(),c2;for(c2=0;c2<b.length;c2+=1)b[c2](a)},encrypt:function(a,b,c2,d3,e){var f,g2=b.slice(0),h=sjcl2.bitArray,k=h.bitLength(c2)/8,l=h.bitLength(g2)/8;e=e||64;d3=d3||[];if(7>k)throw new sjcl2.exception.invalid("ccm: iv must be at least 7 bytes");for(f=2;4>f&&l>>>8*f;f++);f<15-k&&(f=15-k);c2=h.clamp(c2,8*(15-f));b=sjcl2.mode.ccm.V(a,b,c2,d3,e,f);g2=sjcl2.mode.ccm.C(a,g2,c2,b,e,f);return h.concat(g2.data,g2.tag)},decrypt:function(a,b,c2,d3,e){e=e||64;d3=d3||[];var f=sjcl2.bitArray,g2=f.bitLength(c2)/8,h=f.bitLength(b),k=f.clamp(b,h-e),l=f.bitSlice(b,h-e),h=(h-e)/8;if(7>g2)throw new sjcl2.exception.invalid("ccm: iv must be at least 7 bytes");for(b=2;4>b&&h>>>8*b;b++);b<15-g2&&(b=15-g2);c2=f.clamp(c2,8*(15-b));k=sjcl2.mode.ccm.C(a,k,c2,l,e,b);a=sjcl2.mode.ccm.V(a,k.data,c2,d3,e,b);if(!f.equal(k.tag,a))throw new sjcl2.exception.corrupt("ccm: tag doesn't match");return k.data},na:function(a,b,c2,d3,e,f){var g2=[],h=sjcl2.bitArray,k=h.i;d3=[h.partial(8,(b.length?64:0)|d3-2<<2|f-1)];d3=h.concat(d3,c2);d3[3]|=e;d3=a.encrypt(d3);if(b.length)for(c2=h.bitLength(b)/8,65279>=c2?g2=[h.partial(16,c2)]:4294967295>=c2&&(g2=h.concat([h.partial(16,65534)],[c2])),g2=h.concat(g2,b),b=0;b<g2.length;b+=4)d3=a.encrypt(k(d3,g2.slice(b,b+4).concat([0,0,0])));return d3},V:function(a,b,c2,d3,e,f){var g2=sjcl2.bitArray,h=g2.i;e/=8;if(e%2||4>e||16<e)throw new sjcl2.exception.invalid("ccm: invalid tag length");if(4294967295<d3.length||4294967295<b.length)throw new sjcl2.exception.bug("ccm: can't deal with 4GiB or more data");c2=sjcl2.mode.ccm.na(a,d3,c2,e,g2.bitLength(b)/8,f);for(d3=0;d3<b.length;d3+=4)c2=a.encrypt(h(c2,b.slice(d3,d3+4).concat([0,0,0])));return g2.clamp(c2,8*e)},C:function(a,b,c2,d3,e,f){var g2,h=sjcl2.bitArray;g2=h.i;var k=b.length,l=h.bitLength(b),n=k/50,m=n;c2=h.concat([h.partial(8,f-1)],c2).concat([0,0,0]).slice(0,4);d3=h.bitSlice(g2(d3,a.encrypt(c2)),0,e);if(!k)return{tag:d3,data:[]};for(g2=0;g2<k;g2+=4)g2>n&&(sjcl2.mode.ccm.fa(g2/k),n+=m),c2[3]++,e=a.encrypt(c2),b[g2]^=e[0],b[g2+1]^=e[1],b[g2+2]^=e[2],b[g2+3]^=e[3];return{tag:d3,data:h.clamp(b,l)}}};sjcl2.mode.ocb2={name:"ocb2",encrypt:function(a,b,c2,d3,e,f){if(128!==sjcl2.bitArray.bitLength(c2))throw new sjcl2.exception.invalid("ocb iv must be 128 bits");var g2,h=sjcl2.mode.ocb2.S,k=sjcl2.bitArray,l=k.i,n=[0,0,0,0];c2=h(a.encrypt(c2));var m,p=[];d3=d3||[];e=e||64;for(g2=0;g2+4<b.length;g2+=4)m=b.slice(g2,g2+4),n=l(n,m),p=p.concat(l(c2,a.encrypt(l(c2,m)))),c2=h(c2);m=b.slice(g2);b=k.bitLength(m);g2=a.encrypt(l(c2,[0,0,0,b]));m=k.clamp(l(m.concat([0,0,0]),g2),b);n=l(n,l(m.concat([0,0,0]),g2));n=a.encrypt(l(n,l(c2,h(c2))));d3.length&&(n=l(n,f?d3:sjcl2.mode.ocb2.pmac(a,d3)));return p.concat(k.concat(m,k.clamp(n,e)))},decrypt:function(a,b,c2,d3,e,f){if(128!==sjcl2.bitArray.bitLength(c2))throw new sjcl2.exception.invalid("ocb iv must be 128 bits");e=e||64;var g2=sjcl2.mode.ocb2.S,h=sjcl2.bitArray,k=h.i,l=[0,0,0,0],n=g2(a.encrypt(c2)),m,p,r=sjcl2.bitArray.bitLength(b)-e,q2=[];d3=d3||[];for(c2=0;c2+4<r/32;c2+=4)m=k(n,a.decrypt(k(n,b.slice(c2,c2+4)))),l=k(l,m),q2=q2.concat(m),n=g2(n);p=r-32*c2;m=a.encrypt(k(n,[0,0,0,p]));m=k(m,h.clamp(b.slice(c2),p).concat([0,0,0]));l=k(l,m);l=a.encrypt(k(l,k(n,g2(n))));d3.length&&(l=k(l,f?d3:sjcl2.mode.ocb2.pmac(a,d3)));if(!h.equal(h.clamp(l,e),h.bitSlice(b,r)))throw new sjcl2.exception.corrupt("ocb: tag doesn't match");return q2.concat(h.clamp(m,p))},pmac:function(a,b){var c2,d3=sjcl2.mode.ocb2.S,e=sjcl2.bitArray,f=e.i,g2=[0,0,0,0],h=a.encrypt([0,0,0,0]),h=f(h,d3(d3(h)));for(c2=0;c2+4<b.length;c2+=4)h=d3(h),g2=f(g2,a.encrypt(f(h,b.slice(c2,c2+4))));c2=b.slice(c2);128>e.bitLength(c2)&&(h=f(h,d3(h)),c2=e.concat(c2,[-2147483648,0,0,0]));g2=f(g2,c2);return a.encrypt(f(d3(f(h,d3(h))),g2))},S:function(a){return[a[0]<<1^a[1]>>>31,a[1]<<1^a[2]>>>31,a[2]<<1^a[3]>>>31,a[3]<<1^135*(a[0]>>>31)]}};sjcl2.mode.gcm={name:"gcm",encrypt:function(a,b,c2,d3,e){var f=b.slice(0);b=sjcl2.bitArray;d3=d3||[];a=sjcl2.mode.gcm.C(true,a,f,d3,c2,e||128);return b.concat(a.data,a.tag)},decrypt:function(a,b,c2,d3,e){var f=b.slice(0),g2=sjcl2.bitArray,h=g2.bitLength(f);e=e||128;d3=d3||[];e<=h?(b=g2.bitSlice(f,h-e),f=g2.bitSlice(f,0,h-e)):(b=f,f=[]);a=sjcl2.mode.gcm.C(false,a,f,d3,c2,e);if(!g2.equal(a.tag,b))throw new sjcl2.exception.corrupt("gcm: tag doesn't match");return a.data},ka:function(a,b){var c2,d3,e,f,g2,h=sjcl2.bitArray.i;e=[0,0,0,0];f=b.slice(0);for(c2=0;128>c2;c2++){(d3=0!==(a[Math.floor(c2/32)]&1<<31-c2%32))&&(e=h(e,f));g2=0!==(f[3]&1);for(d3=3;0<d3;d3--)f[d3]=f[d3]>>>1|(f[d3-1]&1)<<31;f[0]>>>=1;g2&&(f[0]^=-520093696)}return e},j:function(a,b,c2){var d3,e=c2.length;b=b.slice(0);for(d3=0;d3<e;d3+=4)b[0]^=4294967295&c2[d3],b[1]^=4294967295&c2[d3+1],b[2]^=4294967295&c2[d3+2],b[3]^=4294967295&c2[d3+3],b=sjcl2.mode.gcm.ka(b,a);return b},C:function(a,b,c2,d3,e,f){var g2,h,k,l,n,m,p,r,q2=sjcl2.bitArray;m=c2.length;p=q2.bitLength(c2);r=q2.bitLength(d3);h=q2.bitLength(e);g2=b.encrypt([0,0,0,0]);96===h?(e=e.slice(0),e=q2.concat(e,[1])):(e=sjcl2.mode.gcm.j(g2,[0,0,0,0],e),e=sjcl2.mode.gcm.j(g2,e,[0,0,Math.floor(h/4294967296),h&4294967295]));h=sjcl2.mode.gcm.j(g2,[0,0,0,0],d3);n=e.slice(0);d3=h.slice(0);a||(d3=sjcl2.mode.gcm.j(g2,h,c2));for(l=0;l<m;l+=4)n[3]++,k=b.encrypt(n),c2[l]^=k[0],c2[l+1]^=k[1],c2[l+2]^=k[2],c2[l+3]^=k[3];c2=q2.clamp(c2,p);a&&(d3=sjcl2.mode.gcm.j(g2,h,c2));a=[Math.floor(r/4294967296),r&4294967295,Math.floor(p/4294967296),p&4294967295];d3=sjcl2.mode.gcm.j(g2,d3,a);k=b.encrypt(e);d3[0]^=k[0];d3[1]^=k[1];d3[2]^=k[2];d3[3]^=k[3];return{tag:q2.bitSlice(d3,0,f),data:c2}}};sjcl2.misc.hmac=function(a,b){this.W=b=b||sjcl2.hash.sha256;var c2=[[],[]],d3,e=b.prototype.blockSize/32;this.w=[new b,new b];a.length>e&&(a=b.hash(a));for(d3=0;d3<e;d3++)c2[0][d3]=a[d3]^909522486,c2[1][d3]=a[d3]^1549556828;this.w[0].update(c2[0]);this.w[1].update(c2[1]);this.R=new b(this.w[0])};sjcl2.misc.hmac.prototype.encrypt=sjcl2.misc.hmac.prototype.mac=function(a){if(this.aa)throw new sjcl2.exception.invalid("encrypt on already updated hmac called!");this.update(a);return this.digest(a)};sjcl2.misc.hmac.prototype.reset=function(){this.R=new this.W(this.w[0]);this.aa=false};sjcl2.misc.hmac.prototype.update=function(a){this.aa=true;this.R.update(a)};sjcl2.misc.hmac.prototype.digest=function(){var a=this.R.finalize(),a=new this.W(this.w[1]).update(a).finalize();this.reset();return a};sjcl2.misc.pbkdf2=function(a,b,c2,d3,e){c2=c2||1e4;if(0>d3||0>c2)throw new sjcl2.exception.invalid("invalid params to pbkdf2");"string"===typeof a&&(a=sjcl2.codec.utf8String.toBits(a));"string"===typeof b&&(b=sjcl2.codec.utf8String.toBits(b));e=e||sjcl2.misc.hmac;a=new e(a);var f,g2,h,k,l=[],n=sjcl2.bitArray;for(k=1;32*l.length<(d3||1);k++){e=f=a.encrypt(n.concat(b,[k]));for(g2=1;g2<c2;g2++)for(f=a.encrypt(f),h=0;h<f.length;h++)e[h]^=f[h];l=l.concat(e)}d3&&(l=n.clamp(l,d3));return l};sjcl2.prng=function(a){this.c=[new sjcl2.hash.sha256];this.m=[0];this.P=0;this.H={};this.N=0;this.U={};this.Z=this.f=this.o=this.ha=0;this.b=[0,0,0,0,0,0,0,0];this.h=[0,0,0,0];this.L=void 0;this.M=a;this.D=false;this.K={progress:{},seeded:{}};this.u=this.ga=0;this.I=1;this.J=2;this.ca=65536;this.T=[0,48,64,96,128,192,256,384,512,768,1024];this.da=3e4;this.ba=80};sjcl2.prng.prototype={randomWords:function(a,b){var c2=[],d3;d3=this.isReady(b);var e;if(d3===this.u)throw new sjcl2.exception.notReady("generator isn't seeded");if(d3&this.J){d3=!(d3&this.I);e=[];var f=0,g2;this.Z=e[0]=new Date().valueOf()+this.da;for(g2=0;16>g2;g2++)e.push(4294967296*Math.random()|0);for(g2=0;g2<this.c.length&&(e=e.concat(this.c[g2].finalize()),f+=this.m[g2],this.m[g2]=0,d3||!(this.P&1<<g2));g2++);this.P>=1<<this.c.length&&(this.c.push(new sjcl2.hash.sha256),this.m.push(0));this.f-=f;f>this.o&&(this.o=f);this.P++;this.b=sjcl2.hash.sha256.hash(this.b.concat(e));this.L=new sjcl2.cipher.aes(this.b);for(d3=0;4>d3&&(this.h[d3]=this.h[d3]+1|0,!this.h[d3]);d3++);}for(d3=0;d3<a;d3+=4)0===(d3+1)%this.ca&&y2(this),e=z2(this),c2.push(e[0],e[1],e[2],e[3]);y2(this);return c2.slice(0,a)},setDefaultParanoia:function(a,b){if(0===a&&"Setting paranoia=0 will ruin your security; use it only for testing"!==b)throw new sjcl2.exception.invalid("Setting paranoia=0 will ruin your security; use it only for testing");this.M=a},addEntropy:function(a,b,c2){c2=c2||"user";var d3,e,f=new Date().valueOf(),g2=this.H[c2],h=this.isReady(),k=0;d3=this.U[c2];void 0===d3&&(d3=this.U[c2]=this.ha++);void 0===g2&&(g2=this.H[c2]=0);this.H[c2]=(this.H[c2]+1)%this.c.length;switch(typeof a){case"number":void 0===b&&(b=1);this.c[g2].update([d3,this.N++,1,b,f,1,a|0]);break;case"object":c2=Object.prototype.toString.call(a);if("[object Uint32Array]"===c2){e=[];for(c2=0;c2<a.length;c2++)e.push(a[c2]);a=e}else for("[object Array]"!==c2&&(k=1),c2=0;c2<a.length&&!k;c2++)"number"!==typeof a[c2]&&(k=1);if(!k){if(void 0===b)for(c2=b=0;c2<a.length;c2++)for(e=a[c2];0<e;)b++,e=e>>>1;this.c[g2].update([d3,this.N++,2,b,f,a.length].concat(a))}break;case"string":void 0===b&&(b=a.length);this.c[g2].update([d3,this.N++,3,b,f,a.length]);this.c[g2].update(a);break;default:k=1}if(k)throw new sjcl2.exception.bug("random: addEntropy only supports number, array of numbers or string");this.m[g2]+=b;this.f+=b;h===this.u&&(this.isReady()!==this.u&&A2("seeded",Math.max(this.o,this.f)),A2("progress",this.getProgress()))},isReady:function(a){a=this.T[void 0!==a?a:this.M];return this.o&&this.o>=a?this.m[0]>this.ba&&new Date().valueOf()>this.Z?this.J|this.I:this.I:this.f>=a?this.J|this.u:this.u},getProgress:function(a){a=this.T[a?a:this.M];return this.o>=a?1:this.f>a?1:this.f/a},startCollectors:function(){if(!this.D){this.a={loadTimeCollector:B(this,this.ma),mouseCollector:B(this,this.oa),keyboardCollector:B(this,this.la),accelerometerCollector:B(this,this.ea),touchCollector:B(this,this.qa)};if(window.addEventListener)window.addEventListener("load",this.a.loadTimeCollector,false),window.addEventListener("mousemove",this.a.mouseCollector,false),window.addEventListener("keypress",this.a.keyboardCollector,false),window.addEventListener("devicemotion",this.a.accelerometerCollector,false),window.addEventListener("touchmove",this.a.touchCollector,false);else if(document.attachEvent)document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector);else throw new sjcl2.exception.bug("can't attach event");this.D=true}},stopCollectors:function(){this.D&&(window.removeEventListener?(window.removeEventListener("load",this.a.loadTimeCollector,false),window.removeEventListener("mousemove",this.a.mouseCollector,false),window.removeEventListener("keypress",this.a.keyboardCollector,false),window.removeEventListener("devicemotion",this.a.accelerometerCollector,false),window.removeEventListener("touchmove",this.a.touchCollector,false)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",this.a.mouseCollector),document.detachEvent("keypress",this.a.keyboardCollector)),this.D=false)},addEventListener:function(a,b){this.K[a][this.ga++]=b},removeEventListener:function(a,b){var c2,d3,e=this.K[a],f=[];for(d3 in e)e.hasOwnProperty(d3)&&e[d3]===b&&f.push(d3);for(c2=0;c2<f.length;c2++)d3=f[c2],delete e[d3]},la:function(){C(this,1)},oa:function(a){var b,c2;try{b=a.x||a.clientX||a.offsetX||0,c2=a.y||a.clientY||a.offsetY||0}catch(d3){c2=b=0}0!=b&&0!=c2&&this.addEntropy([b,c2],2,"mouse");C(this,0)},qa:function(a){a=a.touches[0]||a.changedTouches[0];this.addEntropy([a.pageX||a.clientX,a.pageY||a.clientY],1,"touch");C(this,0)},ma:function(){C(this,2)},ea:function(a){a=a.accelerationIncludingGravity.x||a.accelerationIncludingGravity.y||a.accelerationIncludingGravity.z;if(window.orientation){var b=window.orientation;"number"===typeof b&&this.addEntropy(b,1,"accelerometer")}a&&this.addEntropy(a,2,"accelerometer");C(this,0)}};function A2(a,b){var c2,d3=sjcl2.random.K[a],e=[];for(c2 in d3)d3.hasOwnProperty(c2)&&e.push(d3[c2]);for(c2=0;c2<e.length;c2++)e[c2](b)}function C(a,b){"undefined"!==typeof window&&window.performance&&"function"===typeof window.performance.now?a.addEntropy(window.performance.now(),b,"loadtime"):a.addEntropy(new Date().valueOf(),b,"loadtime")}function y2(a){a.b=z2(a).concat(z2(a));a.L=new sjcl2.cipher.aes(a.b)}function z2(a){for(var b=0;4>b&&(a.h[b]=a.h[b]+1|0,!a.h[b]);b++);return a.L.encrypt(a.h)}function B(a,b){return function(){b.apply(a,arguments)}}sjcl2.random=new sjcl2.prng(6);a:try{if(G="undefined"!==typeof module&&module.exports){try{H2=__require2("crypto")}catch(a){H2=null}G=E2=H2}if(G&&E2.randomBytes)D3=E2.randomBytes(128),D3=new Uint32Array(new Uint8Array(D3).buffer),sjcl2.random.addEntropy(D3,1024,"crypto['randomBytes']");else if("undefined"!==typeof window&&"undefined"!==typeof Uint32Array){F3=new Uint32Array(32);if(window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(F3);else if(window.msCrypto&&window.msCrypto.getRandomValues)window.msCrypto.getRandomValues(F3);else break a;sjcl2.random.addEntropy(F3,1024,"crypto['getRandomValues']")}}catch(a){"undefined"!==typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(a))}var D3;var E2;var F3;var G;var H2;sjcl2.json={defaults:{v:1,iter:1e4,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},ja:function(a,b,c2,d3){c2=c2||{};d3=d3||{};var e=sjcl2.json,f=e.g({iv:sjcl2.random.randomWords(4,0)},e.defaults),g2;e.g(f,c2);c2=f.adata;"string"===typeof f.salt&&(f.salt=sjcl2.codec.base64.toBits(f.salt));"string"===typeof f.iv&&(f.iv=sjcl2.codec.base64.toBits(f.iv));if(!sjcl2.mode[f.mode]||!sjcl2.cipher[f.cipher]||"string"===typeof a&&100>=f.iter||64!==f.ts&&96!==f.ts&&128!==f.ts||128!==f.ks&&192!==f.ks&&256!==f.ks||2>f.iv.length||4<f.iv.length)throw new sjcl2.exception.invalid("json encrypt: invalid parameters");"string"===typeof a?(g2=sjcl2.misc.cachedPbkdf2(a,f),a=g2.key.slice(0,f.ks/32),f.salt=g2.salt):sjcl2.ecc&&a instanceof sjcl2.ecc.elGamal.publicKey&&(g2=a.kem(),f.kemtag=g2.tag,a=g2.key.slice(0,f.ks/32));"string"===typeof b&&(b=sjcl2.codec.utf8String.toBits(b));"string"===typeof c2&&(f.adata=c2=sjcl2.codec.utf8String.toBits(c2));g2=new sjcl2.cipher[f.cipher](a);e.g(d3,f);d3.key=a;f.ct="ccm"===f.mode&&sjcl2.arrayBuffer&&sjcl2.arrayBuffer.ccm&&b instanceof ArrayBuffer?sjcl2.arrayBuffer.ccm.encrypt(g2,b,f.iv,c2,f.ts):sjcl2.mode[f.mode].encrypt(g2,b,f.iv,c2,f.ts);return f},encrypt:function(a,b,c2,d3){var e=sjcl2.json,f=e.ja.apply(e,arguments);return e.encode(f)},ia:function(a,b,c2,d3){c2=c2||{};d3=d3||{};var e=sjcl2.json;b=e.g(e.g(e.g({},e.defaults),b),c2,true);var f,g2;f=b.adata;"string"===typeof b.salt&&(b.salt=sjcl2.codec.base64.toBits(b.salt));"string"===typeof b.iv&&(b.iv=sjcl2.codec.base64.toBits(b.iv));if(!sjcl2.mode[b.mode]||!sjcl2.cipher[b.cipher]||"string"===typeof a&&100>=b.iter||64!==b.ts&&96!==b.ts&&128!==b.ts||128!==b.ks&&192!==b.ks&&256!==b.ks||!b.iv||2>b.iv.length||4<b.iv.length)throw new sjcl2.exception.invalid("json decrypt: invalid parameters");"string"===typeof a?(g2=sjcl2.misc.cachedPbkdf2(a,b),a=g2.key.slice(0,b.ks/32),b.salt=g2.salt):sjcl2.ecc&&a instanceof sjcl2.ecc.elGamal.secretKey&&(a=a.unkem(sjcl2.codec.base64.toBits(b.kemtag)).slice(0,b.ks/32));"string"===typeof f&&(f=sjcl2.codec.utf8String.toBits(f));g2=new sjcl2.cipher[b.cipher](a);f="ccm"===b.mode&&sjcl2.arrayBuffer&&sjcl2.arrayBuffer.ccm&&b.ct instanceof ArrayBuffer?sjcl2.arrayBuffer.ccm.decrypt(g2,b.ct,b.iv,b.tag,f,b.ts):sjcl2.mode[b.mode].decrypt(g2,b.ct,b.iv,f,b.ts);e.g(d3,b);d3.key=a;return 1===c2.raw?f:sjcl2.codec.utf8String.fromBits(f)},decrypt:function(a,b,c2,d3){var e=sjcl2.json;return e.ia(a,e.decode(b),c2,d3)},encode:function(a){var b,c2="{",d3="";for(b in a)if(a.hasOwnProperty(b)){if(!b.match(/^[a-z0-9]+$/i))throw new sjcl2.exception.invalid("json encode: invalid property name");c2+=d3+'"'+b+'":';d3=",";switch(typeof a[b]){case"number":case"boolean":c2+=a[b];break;case"string":c2+='"'+escape(a[b])+'"';break;case"object":c2+='"'+sjcl2.codec.base64.fromBits(a[b],0)+'"';break;default:throw new sjcl2.exception.bug("json encode: unsupported type")}}return c2+"}"},decode:function(a){a=a.replace(/\s/g,"");if(!a.match(/^\{.*\}$/))throw new sjcl2.exception.invalid("json decode: this isn't json!");a=a.replace(/^\{|\}$/g,"").split(/,/);var b={},c2,d3;for(c2=0;c2<a.length;c2++){if(!(d3=a[c2].match(/^\s*(?:(["']?)([a-z][a-z0-9]*)\1)\s*:\s*(?:(-?\d+)|"([a-z0-9+\/%*_.@=\-]*)"|(true|false))$/i)))throw new sjcl2.exception.invalid("json decode: this isn't json!");null!=d3[3]?b[d3[2]]=parseInt(d3[3],10):null!=d3[4]?b[d3[2]]=d3[2].match(/^(ct|adata|salt|iv)$/)?sjcl2.codec.base64.toBits(d3[4]):unescape(d3[4]):null!=d3[5]&&(b[d3[2]]="true"===d3[5])}return b},g:function(a,b,c2){void 0===a&&(a={});if(void 0===b)return a;for(var d3 in b)if(b.hasOwnProperty(d3)){if(c2&&void 0!==a[d3]&&a[d3]!==b[d3])throw new sjcl2.exception.invalid("required parameter overridden");a[d3]=b[d3]}return a},sa:function(a,b){var c2={},d3;for(d3 in a)a.hasOwnProperty(d3)&&a[d3]!==b[d3]&&(c2[d3]=a[d3]);return c2},ra:function(a,b){var c2={},d3;for(d3=0;d3<b.length;d3++)void 0!==a[b[d3]]&&(c2[b[d3]]=a[b[d3]]);return c2}};sjcl2.encrypt=sjcl2.json.encrypt;sjcl2.decrypt=sjcl2.json.decrypt;sjcl2.misc.pa={};sjcl2.misc.cachedPbkdf2=function(a,b){var c2=sjcl2.misc.pa,d3;b=b||{};d3=b.iter||1e3;c2=c2[a]=c2[a]||{};d3=c2[d3]=c2[d3]||{firstSalt:b.salt&&b.salt.length?b.salt.slice(0):sjcl2.random.randomWords(2,0)};c2=void 0===b.salt?d3.firstSalt:b.salt;d3[c2]=d3[c2]||sjcl2.misc.pbkdf2(a,c2,b.iter);return{key:d3[c2].slice(0),salt:c2.slice(0)}};"undefined"!==typeof module&&module.exports&&(module.exports=sjcl2);"function"===typeof define&&define([],function(){return sjcl2})}});var require_browser=__commonJS({"node_modules/web-worker/cjs/browser.js"(exports,module){module.exports=Worker}});function parseFunctionFromText(method=""){let getFunctionBody=methodString=>{return methodString.replace(/^\W*(function[^{]+\{([\s\S]*)\}|[^=]+=>[^{]*\{([\s\S]*)\}|[^=]+=>(.+))/i,"$2$3$4")};let getFunctionHead=methodString=>{let startindex=methodString.indexOf("=>")+1;if(startindex<=0){startindex=methodString.indexOf("){")}if(startindex<=0){startindex=methodString.indexOf(") {")}return methodString.slice(0,methodString.indexOf("{",startindex)+1)};let newFuncHead=getFunctionHead(method);let newFuncBody=getFunctionBody(method);let newFunc;if(newFuncHead.includes("function")){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody)}else{if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let varName=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(varName,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else{try{newFunc=(0,eval)(newFuncHead+newFuncBody+"}")}catch{}}}return newFunc}var EventHandler=class{constructor(){this.pushToState={};this.data={};this.triggers={};this.setState=updateObj=>{Object.assign(this.data,updateObj);for(const prop of Object.getOwnPropertyNames(updateObj)){if(this.triggers[prop])this.triggers[prop].forEach(obj=>obj.onchange(this.data[prop]))}return this.data};this.subscribeTrigger=(key,onchange)=>{if(key){if(!this.triggers[key]){this.triggers[key]=[]}let l=this.triggers[key].length;this.triggers[key].push({idx:l,onchange});return this.triggers[key].length-1}else return void 0};this.unsubscribeTrigger=(key,sub)=>{let triggers=this.triggers[key];if(triggers){if(!sub)delete this.triggers[key];else{let idx=void 0;let obj=triggers.find((o,i)=>{if(o.idx===sub){idx=i;return true}});if(obj)triggers.splice(idx,1);return true}}};this.subscribeTriggerOnce=(key,onchange)=>{let sub;let changed=value=>{onchange(value);this.unsubscribeTrigger(key,sub)};sub=this.subscribeTrigger(key,changed)}}};var state=new EventHandler;function addLocalState(props){if(!this._state)this._state={};for(let k in props){if(k==="_state"||k==="graph")continue;else{this._state[k]=props[k];if(k in this)this[k]=props[k];else Object.defineProperty(this,k,{get:()=>{this._state[k]},set:v=>{this._state[k]=v;if(this.state.triggers[this._unique])this.setState({[this._unique]:this._state})},enumerable:true,configurable:true})}}}var GraphNode=class{constructor(properties={},parent,graph){this.nodes=new Map;this._initial={};this._unique=`${Math.random()}`;this.state=state;this.isLooping=false;this.isAnimating=false;this.looper=void 0;this.animation=void 0;this.forward=true;this.backward=false;this.reactive=false;this.runSync=false;this.firstRun=true;this.DEBUGNODE=false;this.addLocalState=addLocalState;this.operator=(...args)=>{return args};this.runOp=(...args)=>{if(this.DEBUGNODE)console.time(this.tag);let result=this.operator(...args);if(result instanceof Promise){result.then(res=>{if(res!==void 0)this.setState({[this.tag]:res});if(this.DEBUGNODE){console.timeEnd(this.tag);if(result!==void 0)console.log(`${this.tag} result:`,result)};return res})}else{if(result!==void 0)this.setState({[this.tag]:result});if(this.DEBUGNODE){console.timeEnd(this.tag);if(result!==void 0)console.log(`${this.tag} result:`,result)};}return result};this.setOperator=operator=>{if(typeof operator!=="function")return operator;this.operator=operator.bind(this);return operator};this.runAsync=(...args)=>{return new Promise((res,rej)=>{res(this.run(...args))})};this.transformArgs=(args=[])=>args;this.isRunSync=()=>{return!(this.children&&this.forward||this.parent&&this.backward||this.repeat||this.delay||this.frame||this.recursive||this.branch)};this.run=(...args)=>{if(typeof this.transformArgs==="function")args=this.transformArgs(args,this);if(this.firstRun){this.firstRun=false;this.runSync=this.isRunSync();if(this.animate&&!this.isAnimating){this.runAnimation(this.animation,args)}if(this.loop&&typeof this.loop==="number"&&!this.isLooping){this.runLoop(this.looper,args)}if(this.loop||this.animate)return}if(this.runSync){let res=this.runOp(...args);return res}return new Promise(async resolve=>{if(this){let run=(node,tick=0,...input)=>{return new Promise(async r=>{tick++;let res=await node.runOp(...input);if(node.repeat){while(tick<node.repeat){if(node.delay){setTimeout(async()=>{r(await run(node,tick,...input))},node.delay);break}else if(node.frame&&window?.requestAnimationFrame){requestAnimationFrame(async()=>{r(await run(node,tick,...input))});break}else res=await node.runOp(...input);tick++}if(tick===node.repeat){r(res);return}}else if(node.recursive){while(tick<node.recursive){if(node.delay){setTimeout(async()=>{r(await run(node,tick,...res))},node.delay);break}else if(node.frame&&window?.requestAnimationFrame){requestAnimationFrame(async()=>{r(await run(node,tick,...res))});break}else res=await node.runOp(...res);tick++}if(tick===node.recursive){r(res);return}}else{r(res);return}})};let runnode=async()=>{let res=await run(this,void 0,...args);if(res!==void 0){if(this.backward&&this.parent instanceof GraphNode){if(Array.isArray(res))await this.runParent(this,...res);else await this.runParent(this,res)}if(this.children&&this.forward){if(Array.isArray(res))await this.runChildren(this,...res);else await this.runChildren(this,res)}if(this.branch){this.runBranch(this,res)}}return res};if(this.delay){setTimeout(async()=>{resolve(await runnode())},this.delay)}else if(this.frame&&window?.requestAnimationFrame){requestAnimationFrame(async()=>{resolve(await runnode())})}else{resolve(await runnode())}}else resolve(void 0)})};this.runParent=async(n,...args)=>{if(n.backward&&n.parent){if(typeof n.parent==="string"){if(n.graph&&n.graph?.get(n.parent)){n.parent=n.graph;if(n.parent)this.nodes.set(n.parent.tag,n.parent)}else n.parent=this.nodes.get(n.parent)}if(n.parent instanceof GraphNode)await n.parent.run(...args)}};this.runChildren=async(n,...args)=>{if(typeof n.children==="object"){for(const key in n.children){if(typeof n.children[key]==="string"){if(n.graph&&n.graph?.get(n.children[key])){n.children[key]=n.graph.get(n.children[key]);if(!n.nodes.get(n.children[key].tag))n.nodes.set(n.children[key].tag,n.children[key])}if(!n.children[key]&&n.nodes.get(n.children[key]))n.children[key]=n.nodes.get(n.children[key])}else if(typeof n.children[key]==="undefined"||n.children[key]===true){if(n.graph&&n.graph?.get(key)){n.children[key]=n.graph.get(key);if(!n.nodes.get(n.children[key].tag))n.nodes.set(n.children[key].tag,n.children[key])}if(!n.children[key]&&n.nodes.get(key))n.children[key]=n.nodes.get(key)}if(n.children[key]?.runOp)await n.children[key].run(...args)}}};this.runBranch=async(n,output)=>{if(n.branch){let keys=Object.keys(n.branch);await Promise.all(keys.map(async k=>{if(typeof n.branch[k].if==="object")n.branch[k].if=stringifyFast(n.branch[k].if);let pass=false;if(typeof n.branch[k].if==="function"){pass=n.branch[k].if(output)}else{if(typeof output==="object"){if(stringifyFast(output)===n.branch[k].if)pass=true}else if(output===n.branch[k].if)pass=true}if(pass){if(n.branch[k].then.run){if(Array.isArray(output))await n.branch[k].then.run(...output);else await n.branch[k].then.run(...output)}else if(typeof n.branch[k].then==="function"){if(Array.isArray(output))await n.branch[k].then(...output);else await n.branch[k].then(output)}else if(typeof n.branch[k].then==="string"){if(n.graph)n.branch[k].then=n.graph.nodes.get(n.branch[k].then);else n.branch[k].then=n.nodes.get(n.branch[k].then);if(n.branch[k].then.run){if(Array.isArray(output))await n.branch[k].then.run(...output);else await n.branch[k].then.run(...output)}}}return pass}))}};this.runAnimation=(animation=this.animation,args=[])=>{this.animation=animation;if(!animation)this.animation=this.operator;if(this.animate&&!this.isAnimating&&"requestAnimationFrame"in window){this.isAnimating=true;let anim=async()=>{if(this.isAnimating){if(this.DEBUGNODE)console.time(this.tag);let result=this.animation.call(this,...args);if(result instanceof Promise){result=await result}if(this.DEBUGNODE){console.timeEnd(this.tag);if(result!==void 0)console.log(`${this.tag} result:`,result)};if(result!==void 0){if(this.tag)this.setState({[this.tag]:result});if(this.backward&&this.parent?.run){if(Array.isArray(result))await this.runParent(this,...result);else await this.runParent(this,result)}if(this.children&&this.forward){if(Array.isArray(result))await this.runChildren(this,...result);else await this.runChildren(this,result)}if(this.branch){this.runBranch(this,result)}this.setState({[this.tag]:result})}requestAnimationFrame(anim)}};requestAnimationFrame(anim)}};this.runLoop=(loop=this.looper,args=[],timeout=this.loop)=>{this.looper=loop;if(!loop)this.looper=this.operator;if(typeof timeout==="number"&&!this.isLooping){this.isLooping=true;let looping=async()=>{if(this.isLooping){if(this.DEBUGNODE)console.time(this.tag);let result=this.looper.call(this,...args);if(result instanceof Promise){result=await result}if(this.DEBUGNODE){console.timeEnd(this.tag);if(result!==void 0)console.log(`${this.tag} result:`,result)};if(result!==void 0){if(this.tag)this.setState({[this.tag]:result});if(this.backward&&this.parent?.run){if(Array.isArray(result))await this.runParent(this,...result);else await this.runParent(this,result)}if(this.children&&this.forward){if(Array.isArray(result))await this.runChildren(this,...result);else await this.runChildren(this,result)}if(this.branch){this.runBranch(this,result)}this.setState({[this.tag]:result})}setTimeout(async()=>{await looping()},timeout)}};looping()}};this.setParent=parent2=>{this.parent=parent2;if(this.backward)this.runSync=false};this.setChildren=children=>{this.children=children;if(this.forward)this.runSync=false};this.add=(n={})=>{if(typeof n==="function")n={operator:n};if(n?.node instanceof GraphNode)n=n.node;if(!(n instanceof GraphNode))n=new GraphNode(n.node??n,this,this.graph);this.nodes.set(n.tag,n);if(this.graph){this.graph.nodes.set(n.tag,n);this.graph.nNodes=this.graph.nodes.size}return n};this.remove=n=>{if(typeof n==="string")n=this.nodes.get(n);if(n?.tag){this.nodes.delete(n.tag);if(this.children[n.tag])delete this.children[n.tag];if(this.graph){this.graph.nodes.delete(n.tag);this.graph.nNodes=this.graph.nodes.size}this.nodes.forEach(n2=>{if(n2.nodes.get(n2.tag)){n2.nodes.delete(n2.tag);if(n2.children[n2.tag])delete n2.children[n2.tag];if(n2.parent?.tag===n2.tag)delete n2.parent}});if(n.ondelete)n.ondelete(n)}if(typeof this._state==="object"){this.state.unsubscribeTrigger(this._unique)}};this.append=(n,parentNode=this)=>{if(typeof n==="string")n=this.nodes.get(n);if(n?.nodes){parentNode.addChildren(n);if(n.forward)n.runSync=false}};this.subscribe=(callback,tag=this.tag)=>{if(typeof callback==="string"){if(this.graph)callback=this.graph.get(callback);else callback=this.nodes.get(callback)}if(typeof callback==="function"){return this.state.subscribeTrigger(tag,callback)}else if(callback)return this.state.subscribeTrigger(tag,res=>{callback.run(res)})};this.unsubscribe=(sub,tag=this.tag)=>{return this.state.unsubscribeTrigger(tag,sub)};this.subscribeState=callback=>{if(!this.reactive){return void 0}else{if(typeof callback==="string"){if(this.graph)callback=this.graph.get(callback);else callback=this.nodes.get(callback)}if(typeof callback==="function"){return this.state.subscribeTrigger(this._unique,callback)}else if(callback)return this.state.subscribeTrigger(this._unique,_state=>{callback.run(_state)})}};this.addChildren=children=>{if(!this.children)this.children={};if(typeof children==="object"){Object.assign(this.children,children)}this.convertChildrenToNodes();if(this.forward)this.runSync=false};this.callParent=(...args)=>{if(typeof this.parent==="string"){if(this.graph&&this.graph?.get(this.parent)){this.parent=this.graph;if(this.parent)this.nodes.set(this.parent.tag,this.parent)}else this.parent=this.nodes.get(this.parent)}if(typeof this.parent?.operator==="function")return this.parent.runOp(...args)};this.callChildren=(...args)=>{let result;if(typeof this.children==="object"){for(const key in this.children){if(this.children[key]?.runOp)this.children[key].runOp(...args)}}return result};this.getProps=(n=this,getInitial=true)=>{let baseprops={tag:n.tag,operator:n.operator,graph:n.graph,children:n.children,parent:n.parent,forward:n.forward,backward:n.bacward,loop:n.loop,animate:n.animate,frame:n.frame,delay:n.delay,recursive:n.recursive,repeat:n.repeat,branch:n.branch,oncreate:n.oncreate,reactive:n.reactive,DEBUGNODE:n.DEBUGNODE};if(!getInitial){let uniqueprops={};for(const key in this._initial){uniqueprops[key]=this[key]}return Object.assign(baseprops,uniqueprops)}else return{tag:n.tag,operator:n.operator,graph:n.graph,children:n.children,parent:n.parent,forward:n.forward,backward:n.bacward,loop:n.loop,animate:n.animate,frame:n.frame,delay:n.delay,recursive:n.recursive,repeat:n.repeat,branch:n.branch,oncreate:n.oncreate,reactive:n.reactive,DEBUGNODE:n.DEBUGNODE,...this._initial}};this.setProps=(props={})=>{let tmp=Object.assign({},props);if(tmp.children){this.addChildren(props.children);delete tmp.children}if(tmp.operator){this.setOperator(props.operator);delete tmp.operator}Object.assign(tmp,props);this.runSync=this.isRunSync()};this.removeTree=n=>{if(n){if(typeof n==="string")n=this.nodes.get(n)}if(n?.nodes){let checked={};const recursivelyRemove=node=>{if(typeof node.children==="object"&&!checked[node.tag]){checked[node.tag]=true;for(const key in node.children){if(node.children[key].stopNode)node.children[key].stopNode();if(node.children[key].tag){if(this.nodes.get(node.children[key].tag))this.nodes.delete(node.children[key].tag);this.nodes.forEach(n2=>{if(n2.nodes.get(node.children[key].tag))n2.nodes.delete(node.children[key].tag);if(n2.children?.[key]instanceof GraphNode)delete n2.children[key]});if(node.children[key].ondelete&&!this.graph)node.children[key].ondelete(node.children[key]);recursivelyRemove(node.children[key])}}}};if(n.stopNode)n.stopNode();if(n.tag){this.nodes.delete(n.tag);if(this.children?.[n.tag])delete this.children[n.tag];if(this.parent?.tag===n.tag)delete this.parent;if(this[n.tag]instanceof GraphNode)delete this[n.tag];this.nodes.forEach(n2=>{if(n2?.tag){if(n2.nodes.get(n2.tag))n2.nodes.delete(n2.tag);if(n2.children?.[n2.tag]instanceof GraphNode)delete n2.children[n2.tag]}});recursivelyRemove(n);if(this.graph)this.graph.removeTree(n,checked);else if(n.ondelete)n.ondelete(n)}}};this.checkNodesHaveChildMapped=(n,child,checked={})=>{let tag=n.tag;if(!tag)tag=n.name;if(!checked[tag]){checked[tag]=true;if(n.children){if(child.tag in n.children){if(n.children[child.tag]instanceof GraphNode){if(!n.nodes.get(child.tag))n.nodes.set(child.tag,child);n.children[child.tag]=child;if(!n.firstRun)n.firstRun=true}}}if(n.parent instanceof GraphNode){if(n.nodes.get(child.tag))n.parent.nodes.set(child.tag,child);if(n.parent.children){this.checkNodesHaveChildMapped(n.parent,child,checked)}else if(n.nodes){n.nodes.forEach(n2=>{if(!checked[n2.tag]){this.checkNodesHaveChildMapped(n2,child,checked)}})}}if(n.graph){if(n.parent&&n.parent.name!==n.graph.name){n.graph.nodes.forEach(n2=>{if(!checked[n2.tag]){this.checkNodesHaveChildMapped(n2,child,checked)}})}}}};this.convertChildrenToNodes=(n=this)=>{if(n?.children){for(const key in n.children){if(!(n.children[key]instanceof GraphNode)){if(typeof n.children[key]==="object"){if(!n.children[key].tag)n.children[key].tag=key;if(!n.nodes.get(n.children[key].tag)){n.children[key]=new GraphNode(n.children[key],n,n.graph);this.checkNodesHaveChildMapped(n,n.children[key])}}else{if(typeof n.children[key]==="undefined"||n.children[key]==true){n.children[key]=n.graph.get(key);if(!n.children[key])n.children[key]=n.nodes.get(key)}else if(typeof n.children[key]==="string"){let k=n.children[key];n.children[key]=n.graph.get(k);if(!n.children[key])n.children[key]=n.nodes.get(key)}if(n.children[key]instanceof GraphNode){n.nodes.set(n.children[key].tag,n.children[key]);this.checkNodesHaveChildMapped(n,n.children[key]);if(!(n.children[key].tag in n))n[n.children[key].tag]=n.children[key]}}}}}return n.children};this.stopLooping=(n=this)=>{n.isLooping=false};this.stopAnimating=(n=this)=>{n.isAnimating=false};this.stopNode=(n=this)=>{n.stopAnimating(n);n.stopLooping(n)};this.subscribeNode=n=>{if(typeof n==="string")n=this.nodes.get(n);if(n.tag)this.nodes.set(n.tag,n);if(n)return this.state.subscribeTrigger(this.tag,res=>{if(Array.isArray(res))n.run(...res);else n.run(res)})};this.print=(n=this,printChildren=true,nodesPrinted=[])=>{let dummyNode=new GraphNode;if(typeof n==="string")n=this.nodes.get(n);if(n instanceof GraphNode){nodesPrinted.push(n.tag);let jsonToPrint={tag:n.tag,operator:n.operator.toString()};if(n.parent)jsonToPrint.parent=n.parent.tag;if(typeof n.children==="object"){for(const key in n.children){if(typeof n.children[key]==="string")return n.children[key];if(nodesPrinted.includes(n.children[key].tag))return n.children[key].tag;else if(!printChildren){return n.children[key].tag}else return n.children[key].print(n.children[key],printChildren,nodesPrinted)}}for(const prop in n){if(prop==="parent"||prop==="children")continue;if(typeof dummyNode[prop]==="undefined"){if(typeof n[prop]==="function"){jsonToPrint[prop]=n[prop].toString()}else if(typeof n[prop]==="object"){jsonToPrint[prop]=JSON.stringifyWithCircularRefs(n[prop])}else{jsonToPrint[prop]=n[prop]}}}return JSON.stringify(jsonToPrint)}};this.reconstruct=json=>{let parsed=reconstructObject(json);if(parsed)return this.add(parsed)};this.setState=data=>{this.state.setState(data)};this.DEBUGNODES=(debugging=true)=>{this.DEBUGNODE=debugging;this.nodes.forEach(n=>{if(debugging)n.DEBUGNODE=true;else n.DEBUGNODE=false})};if(typeof properties==="function"){properties={operator:properties}}if(typeof properties==="object"){if(properties instanceof GraphNode&&properties._initial)Object.assign(properties,properties._initial);if(properties instanceof Graph){let source=properties;properties={source,operator:input=>{if(typeof input==="object"){let result={};for(const key in input){if(typeof source[key]==="function"){if(Array.isArray(input[key]))result[key]=source[key](...input[key]);else result[key]=source[key](input[key])}else{source[key]=input[key];result[key]=source[key]}}return result}return source}};if(source.operator)properties.operator=source.operator;if(source.children)properties.children=source.children;if(source.forward)properties.forward=source.forward;if(source.backward)properties.backward=source.backward;if(source.repeat)properties.repeat=source.repeat;if(source.recursive)properties.recursive=source.recursive;if(source.loop)properties.loop=source.loop;if(source.animate)properties.animate=source.animate;if(source.looper)properties.looper=source.looper;if(source.animation)properties.animation=source.animation;if(source.delay)properties.delay=source.delay;if(source.oncreate)properties.oncreate=source.oncreate;if(source.node){if(source.node._initial)Object.assign(properties,source.node._initial)}if(source._initial)Object.assign(properties,source._initial);if(source.tag)properties.tag=source.tag;this.nodes=source.nodes;source.node=this;if(graph){source.nodes.forEach(n=>{if(!graph.nodes.get(n.tag)){graph.nodes.set(n.tag,n);graph.nNodes++}})}}if(typeof parent==="string"){if(graph)parent=graph.nodes.get(parent);else parent=void 0}if(properties.tag&&(graph||parent)){let hasnode;if(graph?.nodes){hasnode=graph.nodes.get(properties.tag)}if(!hasnode&&parent?.nodes){hasnode=parent.nodes.get(properties.tag)}if(hasnode){if(this.reactive){this.addLocalState(hasnode)}if(!this.source)this.source=hasnode;let props=hasnode.getProps();delete props.graph;delete props.parent;for(let k in props){const desc=Object.getOwnPropertyDescriptor(properties,k);if(desc&&desc.get&&!desc.set)properties=Object.assign({},properties);else properties[k]=props[k]}}}if(properties?.operator){properties.operator=this.setOperator(properties.operator)}if(!properties.tag&&graph){properties.tag=`node${graph.nNodes}`}else if(!properties.tag){properties.tag=`node${Math.floor(Math.random()*1e10)}`}let keys=Object.getOwnPropertyNames(this);for(const key in properties){if(!keys.includes(key))this._initial[key]=properties[key]}if(properties.children)this._initial.children=Object.assign({},properties.children);Object.assign(this,properties);if(!this.tag){if(graph){this.tag=`node${graph.nNodes}`}else{this.tag=`node${Math.floor(Math.random()*1e10)}`}}if(graph){this.graph=graph;if(graph.nodes.get(this.tag)){this.tag=`${this.tag}${graph.nNodes+1}`}graph.nodes.set(this.tag,this);graph.nNodes++;this.state=graph.state}if(this.reactive){addLocalState(properties);if(typeof this.reactive==="function"){this.state.subscribeTrigger(this._unique,this.reactive)}}if(typeof parent==="object"){this.parent=parent;if(parent instanceof GraphNode||parent instanceof Graph)parent.nodes.set(this.tag,this)}if(typeof properties.tree==="object"){for(const key in properties.tree){if(typeof properties.tree[key]==="object"){if((!properties.tree[key]).tag){properties.tree[key].tag=key}}let node=new GraphNode(properties.tree[key],this,graph);this.nodes.set(node.tag,node)}}if(this.children)this.convertChildrenToNodes(this);if(this.parent instanceof GraphNode||this.parent instanceof Graph)this.checkNodesHaveChildMapped(this.parent,this);if(typeof this.oncreate==="function")this.oncreate(this);if(!this.firstRun)this.firstRun=true;if(this.animation&&!this.animate)this.animate=true}else return properties}};var Graph=class{constructor(tree,tag,props){this.nNodes=0;this.nodes=new Map;this.state=new EventHandler;this._unique=`${Math.random()}`;this.tree={};this.addLocalState=addLocalState;this.add=(n={})=>{if(n?.node instanceof GraphNode)n=n.node;let props2=n;if(!(n instanceof GraphNode))n=new GraphNode(props2?.node??props2,this,this);else{this.nNodes=this.nodes.size;if(n.tag){this.tree[n.tag]=props2;this.nodes.set(n.tag,n)}}return n};this.setTree=(tree2=this.tree)=>{if(!tree2)return;for(const node in tree2){const n=this.nodes.get(node);if(!n){if(typeof tree2[node]==="function"){this.add({tag:node,operator:tree2[node]})}else if(typeof tree2[node]==="object"&&!Array.isArray(tree2[node])){if(!tree2[node].tag)tree2[node].tag=node;let newNode=this.add(tree2[node]);if(tree2[node].aliases){tree2[node].aliases.forEach(a=>{this.nodes.set(a,newNode)})}}else{this.add({tag:node,operator:(...args)=>{return tree2[node]}})}}else{if(typeof tree2[node]==="function"){n.setOperator(tree2[node])}else if(typeof tree2[node]==="object"){if(tree2[node]instanceof GraphNode){this.add(tree2[node])}else if(tree2[node]instanceof Graph){let source=tree2[node];let properties={};if(source.operator)properties.operator=source.operator;if(source.children)properties.children=source.children;if(source.forward)properties.forward=source.forward;if(source.backward)properties.backward=source.backward;if(source.repeat)properties.repeat=source.repeat;if(source.recursive)properties.recursive=source.recursive;if(source.loop)properties.loop=source.loop;if(source.animate)properties.animate=source.animate;if(source.looper)properties.looper=source.looper;if(source.animation)properties.animation=source.animation;if(source.delay)properties.delay=source.delay;if(source.tag)properties.tag=source.tag;if(source.oncreate)properties.oncreate=source.oncreate;if(source.node?._initial)Object.assign(properties,source.node._initial);properties.nodes=source.nodes;properties.source=source;n.setProps(properties)}else{n.setProps(tree2[node])}}}}this.nodes.forEach(node=>{if(typeof node.children==="object"){for(const key in node.children){if(typeof node.children[key]==="string"){if(this.nodes.get(node.children[key])){node.children[key]=this.nodes.get(node.children[key])}}else if(node.children[key]===true||typeof node.children[key]==="undefined"){if(this.nodes.get(key)){node.children[key]=this.nodes.get(key)}}if(node.children[key]instanceof GraphNode){node.checkNodesHaveChildMapped(node,node.children[key])}}}if(typeof node.parent==="string"){if(this.nodes.get(node.parent)){node.parent=this.nodes.get(node.parent);node.nodes.set(node.parent.tag,node.parent)}}})};this.get=tag2=>{return this.nodes.get(tag2)};this.set=n=>{return this.nodes.set(n.tag,n)};this.run=(n,...args)=>{if(typeof n==="string")n=this.nodes.get(n);if(n?.run)return n.run(...args);else return void 0};this.runAsync=(n,...args)=>{if(typeof n==="string")n=this.nodes.get(n);if(n?.run)return new Promise((res,rej)=>{res(n.run(...args))});else return new Promise((res,rej)=>{res(void 0)})};this.removeTree=(n,checked)=>{if(n){if(typeof n==="string")n=this.nodes.get(n)}if(n?.nodes){let checked2={};const recursivelyRemove=node=>{if(typeof node.children==="object"&&!checked2[node.tag]){checked2[node.tag]=true;for(const key in node.children){if(node.children[key]?.stopNode)node.children[key].stopNode();if(node.children[key]?.tag){if(this.nodes.get(node.children[key].tag))this.nodes.delete(node.children[key].tag);this.nodes.forEach(n2=>{if(n2.nodes.get(node.children[key].tag))n2.nodes.delete(node.children[key].tag);if(n2.children?.[key]instanceof GraphNode)delete n2.children[key]});if(node.children[key].ondelete)node.children[key].ondelete(node.children[key]);recursivelyRemove(node.children[key])}}}};if(n.stopNode)n.stopNode();if(n.tag){this.nodes.delete(n.tag);if(this.parent?.tag===n.tag)delete this.parent;if(this[n.tag]instanceof GraphNode)delete this[n.tag];this.nodes.forEach(n2=>{if(n2?.tag){if(n2.nodes.get(n2.tag))n2.nodes.delete(n2.tag);if(n2.children?.[n2.tag]instanceof GraphNode)delete n2.children[n2.tag]}});recursivelyRemove(n);if(n.ondelete)n.ondelete(n)}}};this.remove=n=>{if(typeof n==="string")n=this.nodes.get(n);if(n?.nodes){if(n.stopNode)n.stopNode();if(n?.tag){if(this.nodes.get(n.tag)){this.nodes.delete(n.tag);this.nodes.forEach(n2=>{if(n2.nodes.get(n2.tag))n2.nodes.delete(n2.tag)})}}if(n.ondelete)n.ondelete(n)}return n};this.append=(n,parentNode)=>{parentNode.addChildren(n)};this.callParent=async(n,...args)=>{if(n?.parent){return await n.callParent(...args)}};this.callChildren=async(n,...args)=>{if(n?.children){return await n.callChildren(...args)}};this.subscribe=(n,callback)=>{if(!callback)return;if(n?.subscribe&&typeof callback==="function"){return n.subscribe(callback)}else if(callback instanceof GraphNode||typeof callback==="string")return this.subscribeNode(n,callback);else if(typeof n=="string"){return this.state.subscribeTrigger(n,callback)}};this.unsubscribe=(tag2,sub)=>{return this.state.unsubscribeTrigger(tag2,sub)};this.subscribeState=callback=>{if(!this.reactive){return void 0}else{if(typeof callback==="string"){if(this.graph)callback=this.graph.get(callback);else callback=this.nodes.get(callback)}if(typeof callback==="function"){return this.state.subscribeTrigger(this._unique,callback)}else if(callback)return this.state.subscribeTrigger(this._unique,_state=>{callback.run(_state)})}};this.subscribeNode=(inputNode,outputNode)=>{let tag2;if(inputNode?.tag)tag2=inputNode.tag;else if(typeof inputNode==="string")tag2=inputNode;if(typeof outputNode==="string")outputNode=this.nodes.get(outputNode);if(inputNode&&outputNode){let sub=this.state.subscribeTrigger(tag2,res=>{if(Array.isArray(res))outputNode.run(...res);else outputNode.run(res)});return sub}};this.stopNode=n=>{if(typeof n==="string"){n=this.nodes.get(n)}if(n?.stopNode){n.stopNode()}};this.print=(n,printChildren=true)=>{if(n?.print)return n.print(n,printChildren);else{let printed=`{`;this.nodes.forEach(n2=>{printed+=`
"${n2.tag}:${n2.print(n2,printChildren)}"`});return printed}};this.reconstruct=json=>{let parsed=reconstructObject(json);if(parsed)return this.add(parsed)};this.create=(operator,parentNode,props2)=>{return createNode(operator,parentNode,props2,this)};this.setState=data=>{this.state.setState(data)};this.DEBUGNODES=(debugging=true)=>{this.nodes.forEach(n=>{if(debugging)n.DEBUGNODE=true;else n.DEBUGNODE=false})};this.tag=tag?tag:`graph${Math.floor(Math.random()*1e11)}`;if(props){console.log(props,props.constructor.name);if(props.reactive){this.addLocalState(props)}else Object.assign(this,props);this._initial=props}if(tree||Object.keys(this.tree).length>0)this.setTree(tree)}};function reconstructObject(json="{}"){try{let parsed=typeof json==="string"?JSON.parse(json):json;const parseObj=obj=>{for(const prop in obj){if(typeof obj[prop]==="string"){let funcParsed=parseFunctionFromText(obj[prop]);if(typeof funcParsed==="function"){obj[prop]=funcParsed}}else if(typeof obj[prop]==="object"){parseObj(obj[prop])}}return obj};return parseObj(parsed)}catch(err){console.error(err);return void 0}}var stringifyWithCircularRefs=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx--}}}}function checkCircular(key,value){if(value!=null){if(typeof value==="object"){if(key){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}}}return value}return function stringifyWithCircularRefs2(obj,space){try{parents.push(obj);return JSON.stringify(obj,checkCircular,space)}finally{clear()}}}();if(JSON.stringifyWithCircularRefs===void 0){JSON.stringifyWithCircularRefs=stringifyWithCircularRefs}var stringifyFast=function(){const refs=new Map;const parents=[];const path=["this"];function clear(){refs.clear();parents.length=0;path.length=1}function updateParents(key,value){var idx=parents.length-1;if(parents[idx]){var prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value||idx===0){path.push(key);parents.push(value.pushed)}else{while(idx-->=0){prev=parents[idx];if(typeof prev==="object"){if(prev[key]===value){idx+=2;parents.length=idx;path.length=idx;--idx;parents[idx]=value;path[idx]=key;break}}idx++}}}}}function checkValues(key,value){let val;if(value!=null){if(typeof value==="object"){let c2=value.constructor.name;if(key&&c2==="Object"){updateParents(key,value)}let other=refs.get(value);if(other){return"[Circular Reference]"+other}else{refs.set(value,path.join("."))}if(c2==="Array"){if(value.length>20){val=value.slice(value.length-20)}else val=value}else if(c2.includes("Set")){val=Array.from(value)}else if(c2!=="Object"&&c2!=="Number"&&c2!=="String"&&c2!=="Boolean"){val="instanceof_"+c2}else if(c2==="Object"){let obj={};for(const prop in value){if(value[prop]==null){obj[prop]=value[prop]}else if(Array.isArray(value[prop])){if(value[prop].length>20)obj[prop]=value[prop].slice(value[prop].length-20);else obj[prop]=value[prop]}else if(value[prop].constructor.name==="Object"){obj[prop]={};for(const p in value[prop]){if(Array.isArray(value[prop][p])){if(value[prop][p].length>20)obj[prop][p]=value[prop][p].slice(value[prop][p].length-20);else obj[prop][p]=value[prop][p]}else{if(value[prop][p]!=null){let con=value[prop][p].constructor.name;if(con.includes("Set")){obj[prop][p]=Array.from(value[prop][p])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop][p]="instanceof_"+con}else{obj[prop][p]=value[prop][p]}}else{obj[prop][p]=value[prop][p]}}}}else{let con=value[prop].constructor.name;if(con.includes("Set")){obj[prop]=Array.from(value[prop])}else if(con!=="Number"&&con!=="String"&&con!=="Boolean"){obj[prop]="instanceof_"+con}else{obj[prop]=value[prop]}}}val=obj}else{val=value}}else{val=value}}return val}return function stringifyFast2(obj,space){parents.push(obj);let res=JSON.stringify(obj,checkValues,space);clear();return res}}();if(JSON.stringifyFast===void 0){JSON.stringifyFast=stringifyFast}function createNode(operator,parentNode,props,graph){if(typeof props==="object"){props.operator=operator;return new GraphNode(props,parentNode,graph)}return new GraphNode({operator},parentNode,graph)}var Service=class extends Graph{constructor(options={}){super(void 0,options.name?options.name:`service${Math.floor(Math.random()*1e14)}`,options.props);this.routes={};this.loadDefaultRoutes=false;this.keepState=true;this.firstLoad=true;this.customRoutes={};this.customChildren={};this.init=options2=>{if(options2)options2=Object.assign({},options2);else options2={};if(options2.customRoutes)Object.assign(options2.customRoutes,this.customRoutes);else options2.customRoutes=this.customRoutes;if(options2.customChildren)Object.assign(options2.customChildren,this.customChildren);else options2.customChildren=this.customChildren;if(Array.isArray(options2.routes)){options2.routes.forEach(r=>{this.load(r,options2.includeClassName,options2.routeFormat,options2.customRoutes,options2.customChildren,options2.sharedState)})}else if(options2.routes||(Object.keys(this.routes).length>0||this.loadDefaultRoutes)&&this.firstLoad)this.load(options2.routes,options2.includeClassName,options2.routeFormat,options2.customRoutes,options2.customChildren,options2.sharedState)};this.load=(routes,includeClassName=true,routeFormat=".",customRoutes=this.customRoutes,customChildren=this.customChildren,sharedState=true)=>{if(!routes&&!this.loadDefaultRoutes&&(Object.keys(this.routes).length>0||this.firstLoad))return;if(this.firstLoad)this.firstLoad=false;if(customRoutes)customRoutes=Object.assign(this.customRoutes,customRoutes);else customRoutes=this.customRoutes;let service;let allRoutes={};if(routes){if(!(routes instanceof Graph)&&routes?.name&&!routes.setTree){if(routes.module){let mod=routes;routes={};Object.getOwnPropertyNames(routes.module).forEach(prop=>{if(includeClassName)routes[mod.name+routeFormat+prop]=routes.module[prop];else routes[prop]=routes.module[prop]})}else if(typeof routes==="function"){service=new routes({loadDefaultRoutes:this.loadDefaultRoutes});service.load();if(sharedState)service.state=this.state;routes=service.routes;if(service.customRoutes&&!this.customRoutes)this.customRoutes=service.customRoutes;else if(service.customRoutes&&this.customRoutes)Object.assign(this.customRoutes,service.customRoutes);if(service.customChildren&&!this.customChildren)this.customChildren=service.customChildren;else if(service.customChildren&&this.customChildren)Object.assign(this.customChildren,service.customChildren)}}else if(routes instanceof Graph||routes.source instanceof Graph||routes.setTree){service=routes;routes={};if(sharedState)service.state=this.state;if(includeClassName){let name=service.name;if(!name){name=service.tag;service.name=name}if(!name){name=`graph${Math.floor(Math.random()*1e15)}`;service.name=name;service.tag=name}}if(service.customRoutes&&!this.customRoutes)this.customRoutes=service.customRoutes;else if(service.customRoutes&&this.customRoutes)Object.assign(this.customRoutes,service.customRoutes);if(service.customChildren&&!this.customChildren)this.customChildren=service.customChildren;else if(service.customChildren&&this.customChildren)Object.assign(this.customChildren,service.customChildren);service.nodes.forEach(node=>{routes[node.tag]=node;let checked={};let checkChildGraphNodes=(nd,par)=>{if(!checked[nd.tag]||par&&includeClassName&&!checked[par?.tag+routeFormat+nd.tag]){if(!par)checked[nd.tag]=true;else checked[par.tag+routeFormat+nd.tag]=true;if(nd instanceof Graph||nd.source instanceof Graph||nd.setTree){if(sharedState)nd.state=this.state;if(includeClassName){let nm=nd.name;if(!nm){nm=nd.tag;nd.name=nm}if(!nm){nm=`graph${Math.floor(Math.random()*1e15)}`;nd.name=nm;nd.tag=nm}}nd.nodes.forEach(n=>{if(includeClassName&&!routes[nd.tag+routeFormat+n.tag])routes[nd.tag+routeFormat+n.tag]=n;else if(!routes[n.tag])routes[n.tag]=n;checkChildGraphNodes(n,nd)})}}};checkChildGraphNodes(node)})}else if(typeof routes==="object"){let name=routes.constructor.name;if(name==="Object"){name=Object.prototype.toString.call(routes);if(name)name=name.split(" ")[1];if(name)name=name.split("]")[0]}if(name&&name!=="Object"){let module=routes;routes={};Object.getOwnPropertyNames(module).forEach(route=>{if(includeClassName)routes[name+routeFormat+route]=module[route];else routes[route]=module[route]})}}if((service instanceof Graph||service?.setTree)&&service.name&&includeClassName){routes=Object.assign({},routes);for(const prop in routes){let route=routes[prop];delete routes[prop];routes[service.name+routeFormat+prop]=route}}}if(this.loadDefaultRoutes){let rts2=Object.assign({},this.defaultRoutes);if(routes){Object.assign(rts2,this.routes);routes=Object.assign(rts2,routes)}else routes=Object.assign(rts2,this.routes);this.loadDefaultRoutes=false}if(!routes)routes=this.routes;let incr=0;for(const tag in routes){incr++;let childrenIter=(route,routeKey)=>{if(typeof route==="object"){if(!route.tag)route.tag=routeKey;if(typeof route?.children==="object"){nested:for(const key in route.children){incr++;if(typeof route.children[key]==="object"){let rt=route.children[key];if(rt.tag&&allRoutes[rt.tag])continue;if(customChildren){for(const k2 in customChildren){rt=customChildren[k2](rt,key,route,routes,allRoutes);if(!rt)continue nested}}if(rt.id&&!rt.tag){rt.tag=rt.id}let k;if(rt.tag){if(allRoutes[rt.tag]){let randkey=`${rt.tag}${incr}`;allRoutes[randkey]=rt;rt.tag=randkey;childrenIter(allRoutes[randkey],key);k=randkey}else{allRoutes[rt.tag]=rt;childrenIter(allRoutes[rt.tag],key);k=rt.tag}}else{if(allRoutes[key]){let randkey=`${key}${incr}`;allRoutes[randkey]=rt;rt.tag=randkey;childrenIter(allRoutes[randkey],key);k=randkey}else{allRoutes[key]=rt;childrenIter(allRoutes[key],key);k=key}}if(service?.name&&includeClassName){allRoutes[service.name+routeFormat+k]=rt;delete allRoutes[k]}else allRoutes[k]=rt}}}}};allRoutes[tag]=routes[tag];childrenIter(routes[tag],tag)}top:for(const route in allRoutes){if(typeof allRoutes[route]==="object"){let r=allRoutes[route];if(typeof r==="object"){if(customRoutes){for(const key in customRoutes){r=customRoutes[key](r,route,allRoutes);if(!r)continue top}}if(r.get){if(typeof r.get=="object"){}}if(r.post){}if(r.delete){}if(r.put){}if(r.head){}if(r.patch){}if(r.options){}if(r.connect){}if(r.trace){}if(r.post&&!r.operator){allRoutes[route].operator=r.post}else if(!r.operator&&typeof r.get=="function"){allRoutes[route].operator=r.get}}}}for(const route in routes){if(typeof routes[route]==="object"){if(this.routes[route]){if(typeof this.routes[route]==="object")Object.assign(this.routes[route],routes[route]);else this.routes[route]=routes[route]}else this.routes[route]=routes[route]}else if(this.routes[route]){if(typeof this.routes[route]==="object")Object.assign(this.routes[route],routes[route]);else this.routes[route]=routes[route]}else this.routes[route]=routes[route]}if(service){for(const key in this.routes){if(this.routes[key]instanceof GraphNode||this.routes[key].constructor.name.includes("GraphNode")){this.nodes.set(key,this.routes[key]);this.nNodes=this.nodes.size}}}else this.setTree(this.routes);for(const prop in routes){if(routes[prop]?.aliases){let aliases=routes[prop].aliases;aliases.forEach(a=>{if(service?.name&&includeClassName)this.routes[service.name+routeFormat+a]=routes[prop];else this.routes[a]=routes[prop]})}}return this.routes};this.unload=(routes=this.routes)=>{if(!routes)return;let service;if(!(routes instanceof Service)&&typeof routes==="function"){service=new Service;routes=service.routes}else if(routes instanceof Service){routes=routes.routes}for(const r in routes){delete this.routes[r];if(this.nodes.get(r))this.remove(r)}return this.routes};this.handleMethod=(route,method,args)=>{let m=method.toLowerCase();let src=this.nodes.get(route);if(!src){src=this.routes[route];if(!src)src=this.tree[route]}if(src?.[m]){if(!(src[m]instanceof Function)){if(args)src[m]=args;return src[m]}else return src[m](args)}else return this.handleServiceMessage({route,args,method})};this.transmit=(...args)=>{if(typeof args[0]==="object"){if(args[0].method){return this.handleMethod(args[0].route,args[0].method,args[0].args)}else if(args[0].route){return this.handleServiceMessage(args[0])}else if(args[0].node){return this.handleGraphNodeCall(args[0].node,args[0].args)}else if(this.keepState){if(args[0].route)this.setState({[args[0].route]:args[0].args});if(args[0].node)this.setState({[args[0].node]:args[0].args})}return args}else return args};this.receive=(...args)=>{if(args[0]){if(typeof args[0]==="string"){let substr=args[0].substring(0,8);if(substr.includes("{")||substr.includes("[")){if(substr.includes("\\"))args[0]=args[0].replace(/\\/g,"");if(args[0][0]==='"'){args[0]=args[0].substring(1,args[0].length-1)};args[0]=JSON.parse(args[0])}}}if(typeof args[0]==="object"){if(args[0].method){return this.handleMethod(args[0].route,args[0].method,args[0].args)}else if(args[0].route){return this.handleServiceMessage(args[0])}else if(args[0].node){return this.handleGraphNodeCall(args[0].node,args[0].args)}else if(this.keepState){if(args[0].route)this.setState({[args[0].route]:args[0].args});if(args[0].node)this.setState({[args[0].node]:args[0].args})}return args}else return args};this.pipe=(source,destination,endpoint,method,callback)=>{if(source instanceof GraphNode){if(callback)return source.subscribe(res=>{let mod=callback(res);if(mod!==void 0)this.transmit({route:destination,args:mod,method});else this.transmit({route:destination,args:res,method},endpoint)});else return this.subscribe(source,res=>{this.transmit({route:destination,args:res,method},endpoint)})}else if(typeof source==="string")return this.subscribe(source,res=>{this.transmit({route:destination,args:res,method},endpoint)})};this.pipeOnce=(source,destination,endpoint,method,callback)=>{if(source instanceof GraphNode){if(callback)return source.state.subscribeTriggerOnce(source.tag,res=>{let mod=callback(res);if(mod!==void 0)this.transmit({route:destination,args:mod,method});else this.transmit({route:destination,args:res,method},endpoint)});else return this.state.subscribeTriggerOnce(source.tag,res=>{this.transmit({route:destination,args:res,method},endpoint)})}else if(typeof source==="string")return this.state.subscribeTriggerOnce(source,res=>{this.transmit({route:destination,args:res,method},endpoint)})};this.terminate=(...args)=>{this.nodes.forEach(n=>{n.stopNode()})};this.recursivelyAssign=(target,obj)=>{for(const key in obj){if(typeof obj[key]==="object"&&!Array.isArray(obj[key])){if(typeof target[key]==="object"&&!Array.isArray(target[key]))this.recursivelyAssign(target[key],obj[key]);else target[key]=this.recursivelyAssign({},obj[key])}else target[key]=obj[key]}return target};this.defaultRoutes={"/":{get:()=>{return this.print()},aliases:[""]},ping:()=>{console.log("ping");return"pong"},echo:(...args)=>{this.transmit(...args);return args},assign:source=>{if(typeof source==="object"){Object.assign(this,source);return true}return false},recursivelyAssign:source=>{if(typeof source==="object"){this.recursivelyAssign(this,source);return true}return false},log:{post:(...args)=>{console.log("Log: ",...args)},aliases:["info"]},error:message=>{let er=new Error(message);console.error(message);return er},state:key=>{if(key){return this.state.data[key]}else return this.state.data},printState:key=>{if(key){return stringifyWithCircularRefs(this.state.data[key])}else return stringifyWithCircularRefs(this.state.data)},spliceTypedArray:this.spliceTypedArray,transmit:this.transmit,receive:this.receive,load:this.load,unload:this.unload,pipe:this.pipe,terminate:this.terminate,run:this.run,subscribe:this.subscribe,subscribeNode:this.subscribeNode,unsubscribe:this.unsubscribe,stopNode:this.stopNode,get:this.get,add:this.add,remove:this.remove,setTree:this.setTree,setState:this.setState,print:this.print,reconstruct:this.reconstruct,handleMethod:this.handleMethod,handleServiceMessage:this.handleServiceMessage,handleGraphNodeCall:this.handleGraphNodeCall};if(options.name)this.name=options.name;else options.name=this.tag;if("loadDefaultRoutes"in options){this.loadDefaultRoutes=options.loadDefaultRoutes;this.routes=Object.assign(this.defaultRoutes,this.routes)}if(options||Object.keys(this.routes).length>0)this.init(options)}handleServiceMessage(message){let call;if(typeof message==="object"){if(message.route)call=message.route;else if(message.node)call=message.node}if(call){if(Array.isArray(message.args))return this.run(call,...message.args);else return this.run(call,message.args)}else return message}handleGraphNodeCall(route,args){if(!route)return args;if(args?.args){this.handleServiceMessage(args)}else if(Array.isArray(args))return this.run(route,...args);else return this.run(route,args)}isTypedArray(x2){return ArrayBuffer.isView(x2)&&Object.prototype.toString.call(x2)!=="[object DataView]"}spliceTypedArray(arr,start,end){let s=arr.subarray(0,start);let e;if(end){e=arr.subarray(end+1)}let n;if(s.length>0||e?.length>0)n=new arr.constructor(s.length+e.length);if(s.length>0)n.set(s);if(e&&e.length>0)n.set(e,s.length);return n}};var unsafeRoutes={setRoute:function(fn,fnName){if(typeof fn==="string")fn=parseFunctionFromText(fn);if(typeof fn==="function"){if(!fnName)fnName=fn.name;if(this.graph.get(fnName)){this.graph.get(fnName).setOperator(fn.bind(this.graph.get(fnName)))}else{let node=this.graph.add({tag:fnName,operator:fn});if(this.graph instanceof Service)this.graph.load({[fnName]:node})}return true}return false},setNode:function(fn,fnName){if(typeof fn==="string")fn=parseFunctionFromText(fn);if(typeof fn==="function"){if(!fnName)fnName=fn.name;if(this.graph.get(fnName)){this.graph.get(fnName).setOperator(fn)}else this.graph.add({tag:fnName,operator:fn});return true}return false},setMethod:function(route,fn,fnName){if(typeof fn==="string")fn=parseFunctionFromText(fn);if(typeof fn==="function"){if(!fnName)fnName=fn.name;if(this.graph.get(route)){this.graph.get(route)[fnName]=fn}else this.graph.add({tag:fnName,[fnName]:fn});return true}return false},assignRoute:function(route,source){if(this.graph.get(route)&&typeof source==="object"){Object.assign(this.graph.get(route),source)}},transferClass:(classObj,className)=>{if(typeof classObj==="object"){let str2=classObj.toString();let message={route:"receiveClass",args:[str2,className]};return message}return false},receiveClass:function(stringified,className){if(typeof stringified==="string"){if(stringified.indexOf("class")===0){let cls=(0,eval)("("+stringified+")");let name=className;if(!name)name=cls.name;this.graph[name]=cls;return true}}return false},setGlobal:(key,value)=>{globalThis[key]=value;return true},assignGlobalObject:(target,source)=>{if(!globalThis[target])return false;if(typeof source==="object")Object.assign(globalThis[target],source);return true},setValue:function(key,value){this.graph[key]=value;return true},assignObject:function(target,source){if(!this.graph[target])return false;if(typeof source==="object")Object.assign(this.graph[target],source);return true},setGlobalFunction:(fn,fnName)=>{if(typeof fn==="string")fn=parseFunctionFromText(fn);if(typeof fn==="function"){if(!fnName)fnName=fn.name;globalThis[fnName]=fn;return true}return false},assignFunctionToGlobalObject:function(globalObjectName,fn,fnName){if(!globalThis[globalObjectName])return false;if(typeof fn==="string")fn=parseFunctionFromText(fn);if(typeof fn==="function"){if(!fnName)fnName=fn.name;this.graph[globalObjectName][fnName]=fn;return true}return false},setFunction:function(fn,fnName){if(typeof fn==="string")fn=parseFunctionFromText(fn);if(typeof fn==="function"){if(!fnName)fnName=fn.name;this.graph[fnName]=fn;return true}return false},assignFunctionToObject:function(objectName,fn,fnName){if(!this.graph[objectName])return false;if(typeof fn==="string")fn=parseFunctionFromText(fn);if(typeof fn==="function"){if(!fnName)fnName=fn.name;this.graph[objectName][fnName]=fn;return true}return false}};var import_sjcl=__toESM(require_sjcl());var _HTTPfrontend=class extends Service{constructor(options,path,fetched){super(options);this.name="http";this.fetchProxied=false;this.listening={};this.GET=(url="http://localhost:8080/ping",type="",mimeType)=>{if(type==="json")mimeType="application/json";return new Promise((resolve,reject)=>{let xhr=_HTTPfrontend.request({method:"GET",url,responseType:type,mimeType,onload:ev=>{let data;if(xhr.responseType===""||xhr.responseType==="text")data=xhr.responseText;else data=xhr.response;if(url instanceof URL)url=url.toString();this.setState({[url]:data});resolve(data)},onabort:er=>{reject(er)}})}).catch(console.error)};this.POST=(message,url="http://localhost:8080/echo",type="",mimeType)=>{if(typeof message==="object"&&(type==="json"||type==="text"||!type)){message=JSON.stringify(message)}if(type==="json")mimeType="application/json";return new Promise((resolve,reject)=>{let xhr=_HTTPfrontend.request({method:"POST",url,data:message,responseType:type,mimeType,onload:ev=>{let data;if(xhr.responseType===""||xhr.responseType==="text")data=xhr.responseText;else data=xhr.response;if(url instanceof URL)url=url.toString();this.setState({[url]:data});resolve(data)},onabort:er=>{reject(er)}})}).catch(console.error)};this.transmit=(message,url)=>{let obj=message;if(typeof obj==="object"){message=JSON.stringify(obj)}if(obj?.method?.toLowerCase()=="get"||message?.toLowerCase()==="get")return this.GET(url);return this.post(message,url)};this.transponder=(url,message,type="",mimeType)=>{if(typeof message==="object")message=JSON.stringify(message);let method="GET";if(message){method="POST"}if(type==="json")mimeType="application/json";else return new Promise((resolve,reject)=>{let xhr=_HTTPfrontend.request({method,url,data:message,responseType:type,onload:ev=>{let body=xhr.response;if(typeof body==="string"){let substr=body.substring(0,8);if(substr.includes("{")||substr.includes("[")){if(substr.includes("\\"))body=body.replace(/\\/g,"");if(body[0]==='"'){body=body.substring(1,body.length-1)};body=JSON.parse(body)}}if(typeof body?.method==="string"){return resolve(this.handleMethod(body.route,body.method,body.args))}else if(typeof body?.route==="string"){return resolve(this.handleServiceMessage(body))}else if(typeof body?.node==="string"||body.node instanceof GraphNode){return resolve(this.handleGraphNodeCall(body.node,body.args))}else return resolve(body)},onabort:er=>{reject(er)}})}).catch(console.error)};this.listen=(path2="0",fetched2=async(clone,args,response)=>{const result=await clone.text();const returned=this.receive(result);this.setState({[response.url]:returned})})=>{this.listening[path2]={};let listenerId=`${path2}${Math.floor(Math.random()*1e15)}`;this.listening[path2][listenerId]=fetched2;if(!this.fetchProxied){globalThis.fetch=new Proxy(globalThis.fetch,{apply(fetch,that,args){const result=fetch.apply(that,args);result.then(response=>{if(!response.ok)return;if(this.listening["0"]){for(const key in this.listeners){const clone=response.clone();this.listening["0"][key](clone,args,response)}}else{for(const key in this.listening){if(response.url.includes(key)){for(const key2 in this.listening[path2]){const clone=response.clone();this.listening[path2][key2](clone,args,response)}break}}}}).catch(er=>{console.error(er)});return result}});this.fetchProxied=true}return listenerId};this.stopListening=(path2,listener)=>{if(!path2&&path2!==0){for(const key in this.listening)delete this.listening[key]}else{if(!listener)delete this.listening[path2];else delete this.listeners[listener]}};this.routes={request:this.request,GET:this.GET,POST:this.POST,transponder:this.transponder,listen:this.listen,stopListening:this.stopListening};this.load(this.routes);this.listen(path,fetched)}};var HTTPfrontend=_HTTPfrontend;HTTPfrontend.request=options=>{const xhr=new XMLHttpRequest;if(options.responseType)xhr.responseType=options.responseType;else options.responseType="json";if(options.mimeType){xhr.overrideMimeType(options.mimeType)}if(options.onload)xhr.addEventListener("load",options.onload,false);if(options.onprogress)xhr.addEventListener("progress",options.onprogress,false);if(options.onabort)xhr.addEventListener("abort",options.onabort,false);if(options.onloadend)xhr.addEventListener("loadend",options.onloadend,false);if(options.onerror)xhr.addEventListener("error",options.onerror,false);xhr.open(options.method,options.url,true,options.user,options.pass);if(!options.onerror)xhr.onerror=function(){xhr.abort()};xhr.send(options.data);return xhr};var import_web_worker=__toESM(require_browser());var WorkerService=class extends Service{constructor(options){super(options);this.name="worker";this.workers={};this.threadRot=0;this.connections={workers:this.workers};this.customRoutes={"worker":(route,routeKey,routes)=>{let rt=route;if(rt?.worker||rt?.workerId||rt?.workerUrl){let worker=this.loadWorkerRoute(rt,routeKey);if(worker){if(!rt.parentRoute&&rt.parent?.callback)rt.parentRoute=rt.parent.callback;if(rt.parent&&!rt.portId){if(typeof rt.parent==="string"){if(rt.tag!==rt.parent&&worker._id!==rt.parent)rt.portId=this.establishMessageChannel(worker,rt.parent)}else if(rt.tag!==rt.parent.tag&&worker._id!==rt.parent.tag){rt.portId=this.establishMessageChannel(worker,rt.parent.worker)}};if(rt.parentRoute){if(!rt.stopped){if(typeof rt.parent==="string"&&rt.parent===worker._id){worker.run("subscribe",[rt.parentRoute,rt.callback])}else if(rt.tag===rt.parent?.tag||worker._id===rt.parent?.tag){worker.run("subscribe",[rt.parentRoute,rt.callback])}else worker.run("subscribeToWorker",[rt.parentRoute,rt.portId,rt.callback,rt.blocking]).then(sub=>{worker.workerSubs[rt.parentRoute+rt.portId].sub=sub})}if(!(typeof rt.parent==="string"&&rt.parent===worker._id)&&!(rt.tag===rt.parent?.tag||worker._id===rt.parent?.tag))worker.workerSubs[rt.parentRoute+rt.portId]={sub:null,route:rt.parentRoute,portId:rt.portId,callback:rt.callback,blocking:rt.blocking}}else if(rt.parent){if(typeof rt.parent==="string"){if(!rt.stopped){if(rt.parent===worker._id){worker.run("subscribe",[rt.parent,rt.callback])}else worker.run("subscribeToWorker",[rt.parent,rt.portId,rt.callback,rt.blocking]).then(sub=>{worker.workerSubs[rt.parentRoute+rt.portId].sub=sub})}if(!(typeof rt.parent==="string"&&rt.parent===worker._id))worker.workerSubs[rt.parentRoute+rt.portId]={sub:null,route:rt.parentRoute,portId:rt.portId,callback:rt.callback,blocking:rt.blocking}}else if(rt.parent?.tag){if(!rt.stopped){if(rt.tag===rt.parent?.tag||worker._id===rt.parent?.tag){worker.run("subscribe",[rt.parent.tag,rt.callback])}else worker.run("subscribeToWorker",[rt.parent.tag,rt.portId,rt.callback,rt.blocking]).then(sub=>{worker.workerSubs[rt.parentRoute+rt.portId].sub=sub})}if(!(rt.tag===rt.parent?.tag||worker._id===rt.parent?.tag))worker.workerSubs[rt.parentRoute+rt.portId]={sub:null,route:rt.parentRoute,portId:rt.portId,callback:rt.callback,blocking:rt.blocking}}}}}else if(rt.parent&&rt.parentRoute){if(typeof rt.parent==="string"&&routes[rt.parent]?.worker){routes[rt.parent].worker.subscribe(rt.parentRoute,rt.tag,rt.blocking)}else if(rt.parent?.worker){rt.parent.worker.subscribe(rt.parentRoute,rt.tag,rt.blocking)}}return rt}};this.customChildren={"worker":(child,childRouteKey,parent,routes,checked)=>{if(!child.parentRoute&&parent?.callback)child.parentRoute=parent.callback;if(!child.parent&&parent.tag)child.parent=parent.tag;return child}};this.postMessage=(message,target,transfer)=>{if(this.workers[target]){this.workers[target].send(message,transfer)}else{globalThis.postMessage(message,target,transfer)}};this.addWorker=options2=>{let worker;if(!options2._id)options2._id=`worker${Math.floor(Math.random()*1e15)}`;if(options2.url)worker=new import_web_worker.default(options2.url);else if(options2.port){worker=options2.port}else if(this.workers[options2._id]){if(this.workers[options2._id].port)worker=this.workers[options2._id].port;else worker=this.workers[options2._id].worker}if(!worker)return;let send=(message,transfer)=>{return this.transmit(message,worker,transfer)};let post=(route,args,transfer,method)=>{let message={route,args};if(method)message.method=method;return this.transmit(message,worker,transfer)};let run=(route,args,transfer,method)=>{return new Promise((res,rej)=>{let callbackId=Math.random();let req={route:"runRequest",args:[{route,args},options2._id,callbackId]};if(method)req.args[0].method=method;let onmessage=ev=>{if(typeof ev.data==="object"){if(ev.data.callbackId===callbackId){worker.removeEventListener("message",onmessage);res(ev.data.args)}}};worker.addEventListener("message",onmessage);this.transmit(req,worker,transfer)})};let request=(message,transfer,method)=>{return new Promise((res,rej)=>{let callbackId=Math.random();let req={route:"runRequest",args:[message,options2._id,callbackId]};if(method)req.method=method;let onmessage=ev=>{if(typeof ev.data==="object"){if(ev.data.callbackId===callbackId){worker.removeEventListener("message",onmessage);res(ev.data.args)}}};worker.addEventListener("message",onmessage);this.transmit(req,worker,transfer)})};let workerSubs={};let subscribe=(route,callback,blocking)=>{return this.subscribeToWorker(route,options2._id,callback,blocking)};let unsubscribe=(route,sub)=>{return run("unsubscribe",[route,sub])};let start=async(route,portId,callback,blocking)=>{if(route)await run("subscribeToWorker",[route,portId,callback,blocking]).then(sub=>{if(sub)workerSubs[route+portId]={sub,route,portId,callback,blocking}});else for(const key in workerSubs){if(typeof workerSubs[key].sub!=="number")await run("subscribeToWorker",[workerSubs[key].route,workerSubs[key].portId,workerSubs[key].callback,workerSubs[key].blocking]).then(sub=>{workerSubs[key].sub=sub})}return true};let stop=async(route,portId)=>{if(route&&portId&&workerSubs[route+portId]){await run("unsubscribe",[route,workerSubs[route+portId].sub]);workerSubs[route+portId].sub=false}else{for(const key in workerSubs){if(typeof workerSubs[key].sub==="number"){await run("unpipeWorkers",[workerSubs[key].route,workerSubs[key].portId,workerSubs[key].sub])}workerSubs[key].sub=false}}return true};let terminate=()=>{for(const key in workerSubs){if(typeof workerSubs[key].sub==="number"){run("unpipeWorkers",[workerSubs[key].route,workerSubs[key].portId,workerSubs[key].sub])}workerSubs[key].sub=false}return this.terminate(options2._id)};if(!options2.onmessage)options2.onmessage=ev=>{this.receive(ev.data);this.setState({[options2._id]:ev.data})};if(!options2.onerror){options2.onerror=ev=>{console.error(ev.data)}}worker.onmessage=options2.onmessage;worker.onerror=options2.onerror;this.workers[options2._id]={worker,send,post,run,request,subscribe,unsubscribe,terminate,start,stop,postMessage:worker.postMessage,workerSubs,graph:this,...options2};return this.workers[options2._id]};this.toObjectURL=scriptTemplate=>{let blob=new Blob([scriptTemplate],{type:"text/javascript"});return URL.createObjectURL(blob)};this.transmit=(message,worker,transfer)=>{if(!transfer){transfer=this.getTransferable(message)}if(worker instanceof import_web_worker.default||worker instanceof MessagePort){worker.postMessage(message,transfer)}else if(typeof worker==="string"){if(this.workers[worker]){if(this.workers[worker].port)this.workers[worker].port.postMessage(message,transfer);else if(this.workers[worker].worker)this.workers[worker].worker.postMessage(message,transfer)}}else{let keys=Object.keys(this.workers);this.workers[keys[this.threadRot]].worker.postMessage(message,transfer);this.threadRot++;if(this.threadRot===keys.length)this.threadRot=0}return message};this.terminate=worker=>{let onclose;if(typeof worker==="string"){let obj=this.workers[worker];if(obj)delete this.workers[worker];worker=obj.worker;if(obj.onclose)onclose=obj.onclose}if(worker instanceof import_web_worker.default){worker.terminate();if(onclose)onclose(worker);return true}if(worker instanceof MessagePort){worker.close();if(onclose)onclose(worker);return true}return false};this.establishMessageChannel=(worker,worker2)=>{let workerId;if(typeof worker==="string"){workerId=worker;if(this.workers[worker]){if(this.workers[worker].port)worker=this.workers[worker].port;else worker2=this.workers[worker].worker}}else if(worker?.worker){worker=worker.worker}if(typeof worker2==="string"){if(this.workers[worker2]){if(this.workers[worker2].port)worker2=this.workers[worker2].port;else worker2=this.workers[worker2].worker}}else if(worker2?.worker){worker2=worker2.worker}if(worker instanceof import_web_worker.default||worker instanceof MessagePort){let channel=new MessageChannel;let portId=`port${Math.floor(Math.random()*1e15)}`;worker.postMessage({route:"addWorker",args:{port:channel.port1,_id:portId}},[channel.port1]);if(worker2 instanceof import_web_worker.default||worker2 instanceof MessagePort){worker2.postMessage({route:"addWorker",args:{port:channel.port2,_id:portId}},[channel.port2])}else if(workerId&&this.workers[workerId]){channel.port2.onmessage=this.workers[workerId].onmessage;this.workers[workerId].port=channel.port2}return portId}return false};this.request=(message,workerId,transfer,method)=>{let worker=this.workers[workerId].worker;return new Promise((res,rej)=>{let callbackId=Math.random();let req={route:"runRequest",args:[message,callbackId]};if(method)req.method=method;let onmessage=ev=>{if(typeof ev.data==="object"){if(ev.data.callbackId===callbackId){worker.removeEventListener("message",onmessage);res(ev.data.args)}}};worker.addEventListener("message",onmessage);this.transmit(req,worker,transfer)})};this.runRequest=(message,worker,callbackId)=>{let res=this.receive(message);if(typeof worker==="string"&&this.workers[worker]){if(this.workers[worker].port)worker=this.workers[worker].port;else worker=this.workers[worker].worker}if(res instanceof Promise){res.then(r=>{if(worker instanceof import_web_worker.default||worker instanceof MessagePort)worker.postMessage({args:r,callbackId});else if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope)globalThis.postMessage({args:r,callbackId})})}else{if(worker instanceof import_web_worker.default||worker instanceof MessagePort)worker.postMessage({args:res,callbackId});else if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope)globalThis.postMessage({args:res,callbackId})}return res};this.subscribeWorker=(route,worker,blocking)=>{let callback;if(blocking){let blocked=false;callback=res=>{if(!blocked){blocked=true;if(res instanceof Promise){res.then(r=>{if(worker?.run)worker.run("triggerSubscription",[route,worker._id,r]).then(ret=>{blocked=false})})}else{if(worker?.run)worker.run("triggerSubscription",[route,worker._id,res]).then(ret=>{blocked=false})}}}}else{callback=res=>{if(res instanceof Promise){res.then(r=>{if(worker?.postMessage)worker.postMessage({args:r,callbackId:route});else if(globalThis.postMessage)globalThis.postMessage({args:r,callbackId:route})})}else{if(worker?.postMessage)worker.postMessage({args:res,callbackId:route});else if(globalThis.postMessage)globalThis.postMessage({args:res,callbackId:route})}}}if(!blocking&&worker?.port){worker=worker.port}else if(!blocking&&worker?.worker){worker=worker.worker}else if(typeof worker==="string"&&this.workers[worker]){if(blocking)worker=this.workers[worker];else if(this.workers[worker].port)worker=this.workers[worker].port;else worker=this.workers[worker].worker}return this.subscribe(route,callback)};this.subscribeToWorker=(route,workerId,callback,blocking)=>{if(typeof workerId==="string"&&this.workers[workerId]){this.subscribe(workerId,res=>{if(res?.callbackId===route){if(!callback)this.setState({[workerId]:res.args});else if(typeof callback==="string"){this.run(callback,res.args)}else callback(res.args)}});return this.workers[workerId].run("subscribeWorker",[route,workerId,blocking])}};this.triggerSubscription=async(route,workerId,result)=>{if(this.state.triggers[workerId])for(let i=0;i<this.state.triggers[workerId].length;i++){await this.state.triggers[workerId][i].onchange({args:result,callbackId:route})}return true};this.pipeWorkers=(sourceWorker,listenerWorker,sourceRoute,listenerRoute,portId,blocking)=>{if(typeof sourceWorker==="string")sourceWorker=this.workers[sourceWorker];if(typeof listenerWorker==="string")listenerWorker=this.workers[listenerWorker];if(!portId){portId=this.establishMessageChannel(sourceWorker.worker,listenerWorker.worker)}return listenerWorker.run("subscribeToWorker",[sourceRoute,portId,listenerRoute,blocking])};this.unpipeWorkers=(sourceRoute,sourceWorker,sub)=>{if(typeof sourceWorker==="string")sourceWorker=this.workers[sourceWorker];if(sourceWorker)return sourceWorker.run("unsubscribe",[sourceRoute,sub])};this.routes={addWorker:{operator:this.addWorker,aliases:["open"]},toObjectURL:this.toObjectURL,request:this.request,runRequest:this.runRequest,establishMessageChannel:this.establishMessageChannel,subscribeWorker:this.subscribeWorker,subscribeToWorker:this.subscribeToWorker,triggerSubscription:this.triggerSubscription,subscribe:this.subscribe,pipeWorkers:this.pipeWorkers,unpipeWorkers:this.unpipeWorkers,unsubscribe:(route,sub)=>{this.unsubscribe(route,sub)},terminate:this.terminate};this.load(this.routes);if(typeof WorkerGlobalScope!=="undefined"&&globalThis instanceof WorkerGlobalScope){this.addDefaultMessageListener()}}loadWorkerRoute(rt,routeKey){if(rt.workerUrl)rt.url=rt.workerUrl;if(rt.workerId)rt.tag=rt.workerId;if(!rt.tag)rt.tag=routeKey;rt._id=rt.tag;let worker;if(this.workers[rt._id])worker=this.workers[rt._id];else if(rt.worker)worker=rt.worker;if(!worker){worker=this.addWorker(rt);let ondelete=rt2=>{rt2.worker?.terminate()};let oldondelete;if(rt.ondelete)oldondelete=rt.ondelete;rt.ondelete=n=>{if(oldondelete)oldondelete(n);ondelete(n)}}rt.worker=worker;if(rt.transferFunctions){for(const prop in rt.transferFunctions){this.transferFunction(worker,rt.transferFunctions[prop],prop)}}if(rt.transferClasses){for(const prop in rt.transferClasses){this.transferClass(worker,rt.transferClasses[prop],prop)}}if(worker){if(!rt.operator){rt.operator=(...args)=>{if(rt.callback){if(!this.nodes.get(rt.tag)?.children)worker.post(rt.callback,args);else return worker.run(rt.callback,args)}else{if(!this.nodes.get(rt.tag)?.children)worker.send(args);else return worker.request(args)}}}if(rt.init){worker.run(rt.init,rt.initArgs,rt.initTransfer)}return worker}}addDefaultMessageListener(){globalThis.onmessage=ev=>{let result=this.receive(ev.data);if(this.keepState)this.setState({[this.name]:result})}}getTransferable(message){let transfer;if(typeof message==="object"){if(message.args){if(message.args.constructor?.name==="Object"){for(const key in message.args){if(ArrayBuffer.isView(message.args[key])){if(!transfer)transfer=[message.args[key].buffer];else transfer.push(message.args[key].buffer)}else if(message.args[key]?.constructor?.name==="ArrayBuffer"){if(!transfer)transfer=[message.args[key]];else transfer.push(message.args[key])}}}else if(Array.isArray(message.args)&&message.args.length<11){message.args.forEach(arg=>{if(ArrayBuffer.isView(arg)){transfer=[arg.buffer]}else if(arg.constructor?.name==="ArrayBuffer")transfer=[arg]})}else if(ArrayBuffer.isView(message.args)){transfer=[message.args.buffer]}else if(message.args.constructor?.name==="ArrayBuffer"){transfer=[message]}}else if(message.constructor?.name==="Object"){for(const key in message){if(ArrayBuffer.isView(message[key])){if(!transfer)transfer=[message[key].buffer];else transfer.push(message[key].buffer)}else if(message[key]?.constructor?.name==="ArrayBuffer"){if(!transfer)transfer=[message[key]];else transfer.push(message[key])}}}else if(Array.isArray(message)&&message.length<11){message.forEach(arg=>{if(ArrayBuffer.isView(arg)){transfer=[arg.buffer]}else if(arg.constructor?.name==="ArrayBuffer")transfer=[arg]})}else if(ArrayBuffer.isView(message)){transfer=[message.buffer]}else if(message.constructor?.name==="ArrayBuffer"){transfer=[message]}}return transfer}transferFunction(worker,fn,fnName){if(!fnName)fnName=fn.name;return worker.request({route:"setRoute",args:[fn.toString(),fnName]})}transferClass(worker,cls,className){if(!className)className=cls.name;return worker.request({route:"receiveClass",args:[cls.toString(),className]})}};var mouseEventHandler=makeSendPropertiesHandler(["ctrlKey","metaKey","shiftKey","button","pointerType","clientX","clientY","pageX","pageY"]);var wheelEventHandlerImpl=makeSendPropertiesHandler(["deltaX","deltaY"]);var keydownEventHandler=makeSendPropertiesHandler(["ctrlKey","metaKey","shiftKey","keyCode"]);function wheelEventHandler(event,sendFn){event.preventDefault();wheelEventHandlerImpl(event,sendFn)}function preventDefaultHandler(event){event.preventDefault()}function copyProperties(src,properties,dst){for(const name of properties){dst[name]=src[name]}}function makeSendPropertiesHandler(properties){return function sendProperties(event,sendFn){const data={type:event.type};copyProperties(event,properties,data);sendFn(data)}}function touchEventHandler(event,sendFn){const touches=[];const data={type:event.type,touches};for(let i=0;i<event.touches.length;++i){const touch=event.touches[i];touches.push({pageX:touch.pageX,pageY:touch.pageY})}sendFn(data)}var orbitKeys={"37":true,"38":true,"39":true,"40":true};function filteredKeydownEventHandler(event,sendFn){const{keyCode}=event;if(orbitKeys[keyCode]){event.preventDefault();keydownEventHandler(event,sendFn)}}var eventHandlers={contextmenu:preventDefaultHandler,mousedown:mouseEventHandler,mousemove:mouseEventHandler,mouseup:mouseEventHandler,pointerdown:mouseEventHandler,pointermove:mouseEventHandler,pointerup:mouseEventHandler,touchstart:touchEventHandler,touchmove:touchEventHandler,touchend:touchEventHandler,wheel:wheelEventHandler,keydown:filteredKeydownEventHandler};function initProxyElement(element,worker,id){if(!id)id="proxy"+Math.floor(Math.random()*1e15);const sendEvent=data=>{worker.postMessage({route:"handleProxyEvent",args:[data,id]})};let entries=Object.entries(eventHandlers);for(const[eventName,handler]of entries){element.addEventListener(eventName,function(event){handler(event,sendEvent)})}const sendSize=()=>{const rect=element.getBoundingClientRect();sendEvent({type:"resize",left:rect.left,top:rect.top,width:element.clientWidth,height:element.clientHeight})};sendSize();globalThis.addEventListener("resize",sendSize);return id}var EventDispatcher=class{addEventListener(type,listener){if(this._listeners===void 0)this._listeners={};const listeners=this._listeners;if(listeners[type]===void 0){listeners[type]=[]}if(listeners[type].indexOf(listener)===-1){listeners[type].push(listener)}}hasEventListener(type,listener){if(this._listeners===void 0)return false;const listeners=this._listeners;return listeners[type]!==void 0&&listeners[type].indexOf(listener)!==-1}removeEventListener(type,listener){if(this._listeners===void 0)return;const listeners=this._listeners;const listenerArray=listeners[type];if(listenerArray!==void 0){const index=listenerArray.indexOf(listener);if(index!==-1){listenerArray.splice(index,1)}}}dispatchEvent(event,target){if(this._listeners===void 0)return;const listeners=this._listeners;const listenerArray=listeners[event.type];if(listenerArray!==void 0){if(!target)event.target=this;else event.target=target;const array=listenerArray.slice(0);for(let i=0,l=array.length;i<l;i++){array[i].call(this,event)}event.target=null}}};function noop(){}var ElementProxyReceiver=class extends EventDispatcher{constructor(){super();this._listeners={};this.style={};this.setPointerCapture=()=>{};this.releasePointerCapture=()=>{};this.getBoundingClientRect=()=>{return{left:this.left,top:this.top,width:this.width,height:this.height,right:this.left+this.width,bottom:this.top+this.height}};this.handleEvent=data=>{if(data.type==="resize"){this.left=data.left;this.top=data.top;this.width=data.width;this.height=data.height;if(typeof this.proxied==="object"){this.proxied.width=this.width;this.proxied.height=this.height;this.proxied.clientWidth=this.width;this.proxied.clientHeight=this.height}}data.preventDefault=noop;data.stopPropagation=noop;this.dispatchEvent(data,this.proxied)};this.style={}}get clientWidth(){return this.width}get clientHeight(){return this.height}focus(){}};var ProxyManager=class{constructor(){this.targets={};this.makeProxy=(id,addTo=void 0)=>{if(!id)id=`proxyReceiver${Math.floor(Math.random()*1e15)}`;let proxy;if(this.targets[id])proxy=this.targets[id];else{proxy=new ElementProxyReceiver;this.targets[id]=proxy}if(typeof addTo==="object"){addTo.proxy=proxy;proxy.proxied=addTo;addTo.style=proxy.style;if(proxy.width){addTo.width=proxy.width;addTo.clientWidth=proxy.width}if(proxy.height){addTo.height=proxy.height;addTo.clientHeight=proxy.height}addTo.setPointerCapture=proxy.setPointerCapture.bind(proxy);addTo.releasePointerCapture=proxy.releasePointerCapture.bind(proxy);addTo.getBoundingClientRect=proxy.getBoundingClientRect.bind(proxy);addTo.addEventListener=proxy.addEventListener.bind(proxy);addTo.removeEventListener=proxy.removeEventListener.bind(proxy);addTo.handleEvent=proxy.handleEvent.bind(proxy);addTo.dispatchEvent=proxy.dispatchEvent.bind(proxy);addTo.focus=proxy.focus.bind(proxy)}};this.getProxy=id=>{return this.targets[id]};this.handleEvent=(data,id)=>{if(!this.targets[id])this.makeProxy(id);if(this.targets[id]){this.targets[id].handleEvent(data);return true}return void 0};if(!globalThis.document)globalThis.document={}}};var proxyElementWorkerRoutes={initProxyElement,makeProxy:function(id,elm){if(!this.graph.ProxyManager)this.graph.ProxyManager=new ProxyManager;this.graph.ProxyManager.makeProxy(id,elm);return id},handleProxyEvent:function(data,id){if(!this.graph.ProxyManager)this.graph.ProxyManager=new ProxyManager;if(this.graph.ProxyManager.handleEvent(data,id))return data}};var workerCanvasRoutes={...proxyElementWorkerRoutes,transferCanvas:function(worker,options,route){if(!options)return void 0;if(!options._id)options._id=`canvas${Math.floor(Math.random()*1e15)}`;let offscreen=options.canvas.transferControlToOffscreen();let message={route:route?route:"receiveCanvas",args:{...options,canvas:offscreen}};this.graph.run("initProxyElement",options.canvas,worker,options._id);if(options.draw){if(typeof options.draw==="function")message.args.draw=options.draw.toString();else message.args.draw=options.draw}if(options.update){if(typeof options.update==="function")message.args.update=options.update.toString();else message.args.update=options.update}if(options.init){if(typeof options.init==="function")message.args.init=options.init.toString();else message.args.init=options.init}if(options.clear){if(typeof options.clear==="function")message.args.clear=options.clear.toString();else message.args.clear=options.clear}let transfer=[offscreen];if(options.transfer){transfer.push(...options.transfer);delete options.transfer}worker.postMessage(message,transfer);const workercontrols={_id:options._id,width:options.width,height:options.height,worker,draw:props=>{worker.postMessage({route:"drawFrame",args:[options._id,props]})},update:props=>{worker.postMessage({route:"updateCanvas",args:[options._id,props]})},clear:()=>{worker.postMessage({route:"clearCanvas",args:options._id})},init:()=>{worker.postMessage({route:"initCanvas",args:options._id})},stop:()=>{worker.postMessage({route:"stopAnim",args:options._id})},start:()=>{worker.postMessage({route:"startAnim",args:options._id})},set:newDrawProps=>{worker.postMessage({route:"setDraw",args:[newDrawProps,options._id]})}};return workercontrols},receiveCanvas:function(options){if(!this.graph.CANVASES)this.graph.CANVASES={};let canvasOptions=options;options._id?canvasOptions._id=options._id:canvasOptions._id=`canvas${Math.floor(Math.random()*1e15)}`;typeof options.context==="string"?canvasOptions.context=options.canvas.getContext(options.context):canvasOptions.context=options.context;"animating"in options?canvasOptions.animating=options.animating:canvasOptions.animating=true;if(this.graph.CANVASES[canvasOptions._id]){this.graph.run("setDraw",canvasOptions)}else{canvasOptions.graph=this.graph;this.graph.CANVASES[canvasOptions._id]=canvasOptions;this.graph.run("makeProxy",canvasOptions._id,canvasOptions.canvas);if(options.width)canvasOptions.canvas.width=options.width;if(options.height)canvasOptions.canvas.height=options.height;if(typeof canvasOptions.draw==="string"){canvasOptions.draw=parseFunctionFromText(canvasOptions.draw)}if(typeof canvasOptions.update==="string"){canvasOptions.update=parseFunctionFromText(canvasOptions.update)}if(typeof canvasOptions.init==="string"){canvasOptions.init=parseFunctionFromText(canvasOptions.init)}if(typeof canvasOptions.clear==="string"){canvasOptions.clear=parseFunctionFromText(canvasOptions.clear)}if(typeof canvasOptions.init==="function")canvasOptions.init(canvasOptions,canvasOptions.canvas,canvasOptions.context);if(typeof canvasOptions.draw==="function"&&canvasOptions.animating){let draw=(s,canvas,context)=>{if(s.animating){s.draw(s,canvas,context);requestAnimationFrame(()=>{draw(s,canvas,context)})}};draw(canvasOptions,canvasOptions.canvas,canvasOptions.context)}}return canvasOptions._id},setDraw:function(settings,_id){let canvasopts;if(_id)canvasopts=this.graph.CANVASES?.[settings._id];else if(settings._id)canvasopts=this.graph.CANVASES?.[settings._id];else canvasopts=this.graph.CANVASES?.[Object.keys(this.graph.CANVASES)[0]];if(canvasopts){if(settings.canvas){canvasopts.canvas=settings.canvas;this.graph.run("makeProxy",canvasopts._id,canvasopts.canvas)}if(typeof settings.context==="string")canvasopts.context=canvasopts.canvas.getContext(settings.context);else if(settings.context)canvasopts.context=settings.context;if(settings.width)canvasopts.canvas.width=settings.width;if(settings.height)canvasopts.canvas.height=settings.height;if(typeof settings.draw==="string")settings.draw=parseFunctionFromText(settings.draw);if(typeof settings.draw==="function"){canvasopts.draw=settings.draw}if(typeof settings.update==="string")settings.update=parseFunctionFromText(settings.update);if(typeof settings.update==="function"){canvasopts.update=settings.update}if(typeof settings.init==="string")settings.init=parseFunctionFromText(settings.init);if(typeof settings.init==="function"){canvasopts.init=settings.init}if(typeof settings.clear==="string")settings.clear=parseFunctionFromText(settings.clear);if(typeof settings.clear==="function"){canvasopts.clear=settings.clear}return settings._id}return void 0},drawFrame:function(props,_id){let canvasopts;if(!_id)canvasopts=this.graph.CANVASES?.[Object.keys(this.graph.CANVASES)[0]];else canvasopts=this.graph.CANVASES?.[_id];if(canvasopts){if(props)Object.assign(canvasopts,props);if(canvasopts.draw){canvasopts.draw(canvasopts,canvasopts.canvas,canvasopts.context);return _id}}return void 0},clearCanvas:function(_id){let canvasopts;if(!_id)canvasopts=this.graph.CANVASES?.[Object.keys(this.graph.CANVASES)[0]];else canvasopts=this.graph.CANVASES?.[_id];if(canvasopts?.clear){canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0},initCanvas:function(_id){let canvasopts;if(!_id)canvasopts=this.graph.CANVASES?.[Object.keys(this.graph.CANVASES)[0]];else canvasopts=this.graph.CANVASES?.[_id];if(canvasopts?.init){canvasopts.init(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0},updateCanvas:function(input,_id){let canvasopts;if(!_id)canvasopts=this.graph.CANVASES?.[Object.keys(this.graph.CANVASES)[0]];else canvasopts=this.graph.CANVASES?.[_id];if(canvasopts?.update){canvasopts.update(canvasopts,canvasopts.canvas,canvasopts.context,input);return _id}return void 0},setProps:function(props,_id){let canvasopts;if(!_id)canvasopts=this.graph.CANVASES?.[Object.keys(this.graph.CANVASES)[0]];else canvasopts=this.graph.CANVASES?.[_id];if(canvasopts){Object.assign(canvasopts,props);if(props.width)canvasopts.canvas.width=props.width;if(props.height)canvasopts.canvas.height=props.height;return _id}return void 0},startAnim:function(_id,draw){let canvasopts;if(!_id)canvasopts=this.graph.CANVASES?.[Object.keys(this.graph.CANVASES)[0]];else canvasopts=this.graph.CANVASES?.[_id];canvasopts.animating=true;if(canvasopts&&draw){if(typeof draw==="string")draw=parseFunctionFromText(draw);if(typeof draw==="function"){canvasopts.draw=draw}return _id}if(typeof canvasopts?.draw==="function"){let draw2=(s,canvas,context)=>{if(s.animating){s.draw(s,canvas,context);requestAnimationFrame(()=>{draw2(s,canvas,context)})}};if(typeof canvasopts.clear==="function")canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context);if(typeof canvasopts.init==="function")canvasopts.init(canvasopts,canvasopts.canvas,canvasopts.context);draw2(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0},stopAnim:function(_id){let canvasopts;if(!_id)canvasopts=this.graph.CANVASES?.[Object.keys(this.graph.CANVASES)[0]];else canvasopts=this.graph.CANVASES?.[_id];if(canvasopts){canvasopts.animating=false;if(typeof canvasopts.clear==="function")canvasopts.clear(canvasopts,canvasopts.canvas,canvasopts.context);return _id}return void 0}};var algorithms={};var loadAlgorithms=settings=>{return Object.assign(algorithms,settings)};function createSubprocess(options,inputs){let ctx={_id:options._id?options._id:`algorithm${Math.floor(Math.random()*1e15)}`,ondata:options.ondata,run:data=>{return ctx.ondata(ctx,data)}};if(options.structs)recursivelyAssign(ctx,JSON.parse(JSON.stringify(options.structs)));if(inputs)recursivelyAssign(ctx,JSON.parse(JSON.stringify(inputs)));if(options.oncreate){ctx.oncreate=options.oncreate}if(ctx.oncreate){ctx.oncreate(ctx)}return ctx}var recursivelyAssign=(target,obj)=>{for(const key in obj){if(typeof obj[key]==="object"&&!Array.isArray(obj[key])){if(typeof target[key]==="object"&&!Array.isArray(target[key]))recursivelyAssign(target[key],obj[key]);else target[key]=recursivelyAssign({},obj[key])}else target[key]=obj[key]}return target};var subprocessRoutes={...unsafeRoutes,loadAlgorithms,"initSubprocesses":async function initSubprocesses(subprocesses,service){if(!service)service=this.graph;if(!service)return void 0;for(const p in subprocesses){let s=subprocesses[p];if(!s.worker&&s.url)s.worker=service.addWorker({url:s.url});if(!s.worker)continue;let w3=s.worker;let wpId;wpId=service.establishMessageChannel(w3.worker,s.source?.worker);if(!s.source)s.source=service;if(typeof s.subprocess==="object"){const p2=s.subprocess;if(!p2.name)continue;if(typeof p2.oncreate==="function"){p2.oncreate=p2.oncreate.toString()}if(typeof p2.ondata==="function"){p2.ondata=p2.ondata.toString()}s.worker.post("addSubprocessTemplate",[p2.name,p2.structs,p2.oncreate,p2.ondata,p2.props]);s.subprocess=p2.name}if(s.init){let r=await w3.run(s.init,s.initArgs);s.otherArgs=r}if(s.otherArgs){w3.run("setValue",["otherArgsProxy",Array.isArray(s.otherArgs)?s.otherArgs:[s.otherArgs]])}if(s.pipeTo){w3.run("setValue",["routeProxy",s.route]);w3.run("setValue",["pipeRoute",s.pipeTo.route]);if(s.url&&!s.pipeTo.worker){let w22=service.addWorker({url:s.url});s.pipeTo.portId=service.establishMessageChannel(w3.worker,w22.worker);s.pipeTo.worker=w22}if(s.pipeTo.init){s.pipeTo.otherArgs=await s.pipeTo.worker.run(s.pipeTo.init,s.pipeTo.initArgs)}w3.run("setValue",["pipePort",s.pipeTo.portId]);if(s.pipeTo.otherArgs)w3.run("setValue",["otherPipeArgs",s.pipeTo.otherArgs]);service.transferFunction(w3,function pipeResults(data){let inp=data;if(this.graph.otherArgsProxy)inp=[data,...this.graph.otherArgsProxy];let r=this.graph.run(this.graph.routeProxy,inp);if(!s.blocking)return new Promise(res=>{if(r instanceof Promise){r.then(rr=>{if(rr!==void 0){let args=rr;if(this.graph.otherPipeArgs)args=[rr,...this.graph.otherPipeArgs];if(this.workers[this.graph.pipePort]){s.blocking=true;this.workers[this.graph.pipePort].run(this.graph.pipeRoute,args).then(result=>{s.blocking=false;res(result)})}}})}else if(r!==void 0){let args=r;if(this.graph.otherPipeArgs)args=[r,...this.graph.otherPipeArgs];if(this.workers[this.graph.pipePort]){s.blocking=true;this.workers[this.graph.pipePort].run(this.graph.pipeRoute,args).then(result=>{s.blocking=false;res(result)})}}});return void 0},s.route+"_pipeResults");s.route=s.route+"_pipeResults"}else{w3.run("setValue",["routeProxy",s.route]);service.transferFunction(w3,function routeProxy(data){let r;if(this.graph.otherArgsProxy)r=this.graph.nodes.get(this.graph.routeProxy).operator(data,...this.graph.otherArgsProxy);else r=this.graph.nodes.get(this.graph.routeProxy).operator(data);if(this.graph.state.triggers[this.graph.routeProxy]){if(r instanceof Promise){r.then(rr=>{this.setState({[this.graph.routeProxy]:rr})})}else this.setState({[this.graph.routeProxy]:r})}return r},s.route+"_routeProxy");s.route=s.route+"_routeProxy";if(!s.stopped)w3.run("subscribeToWorker",[s.subscribeRoute,wpId,s.route]).then(sub=>{s.sub=sub})}s.stop=async()=>{if(s.source&&typeof s.sub==="number"){s.source.unsubscribe(s.subscribeRoute,s.sub);return true}return void 0};s.start=async()=>{if(typeof s.sub!=="number")return w3.run("subscribeToWorker",[s.subscribeRoute,wpId,s.route,s.blocking]).then(sub=>{s.sub=sub})};s.setArgs=async args=>{if(Array.isArray(args))await w3.run("setValue",["otherArgsProxy",args]);else if(typeof args==="object"){for(const key in args){await w3.run("setValue",[key,args[key]])}}return true};s.terminate=()=>{w3.terminate();if(s.source?.worker&&typeof s.sub==="number"){s.source.post("unsubscribe",s.sub)}if(s.pipeTo?.worker){s.pipeTo.worker.terminate()}};if(s.callback)w3.subscribe(s.route,res=>{if(typeof s.callback==="string")this.graph.run(s.callback,res);else s.callback(res)})}return subprocesses},"addSubprocessTemplate":function subprocesstempalte(name,structs,oncreate,ondata,props){if(typeof oncreate==="string")oncreate=parseFunctionFromText(oncreate);if(typeof ondata==="string")ondata=parseFunctionFromText(ondata);if(typeof ondata==="function"){algorithms[name]={ondata,oncreate:typeof oncreate==="function"?oncreate:null,structs};if(typeof props==="object")Object.assign(algorithms[name],props);return true}},"updateSubprocess":function updatesubprocess(structs,_id){if(!this.graph.ALGORITHMS)this.graph.ALGORITHMS={};if(!_id)_id=Object.keys(this.graph.ALGORITHMS)[0];if(!_id)return;Object.assign(this.graph.ALGORITHMS[_id],structs)},"createSubprocess":function creatsubprocess(options,inputs){if(!this.graph.ALGORITHMS)this.graph.ALGORITHMS={};if(typeof options==="string"){options=algorithms[options]}if(typeof options==="object"){if(typeof options.ondata==="string")options.ondata=parseFunctionFromText(options.ondata);let ctx;if(typeof options?.ondata==="function")ctx=createSubprocess(options,inputs);if(ctx)this.graph.ALGORITHMS[ctx._id]=ctx;if(ctx)return ctx._id}return false},"runSubprocess":function runsubprocess(data,_id){if(!this.graph.ALGORITHMS)this.graph.ALGORITHMS={};if(!_id)_id=Object.keys(this.graph.ALGORITHMS)[0];if(!_id)return;let res=this.graph.ALGORITHMS[_id].run(data);if(res!==void 0){if(Array.isArray(res)){let pass=[];res.forEach(r=>{if(r!==void 0){pass.push(r);this.graph.setState({[_id]:r})}});if(pass.length>0){return pass}}else{this.graph.setState({[_id]:res});return res}}}};var _ArrayManip=class{constructor(){this.recursivelyAssign=(target,obj)=>{for(const key in obj){if(typeof obj[key]==="object"){if(typeof target[key]==="object")this.recursivelyAssign(target[key],obj[key]);else target[key]=this.recursivelyAssign({},obj[key])}else target[key]=obj[key]}return target}}static autoscale(array,lineIdx=0,nLines=1,centerZero=false,ymin,ymax,clamp){if(array?.length===0)return array;let max=ymax?ymax:Math.max(...array);let min=ymin?ymin:Math.min(...array);let _lines=1/nLines;let scalar=1;if(centerZero){let absmax=Math.max(Math.abs(min),Math.abs(max));if(absmax!==0)scalar=_lines/absmax;return array.map(y2=>{if(clamp){if(y2<min)y2=min;if(y2>max)y2=max}return y2*scalar+(_lines*(lineIdx+1)*2-1-_lines)})}else{if(max===min){if(max!==0){scalar=_lines/max}else if(min!==0){scalar=_lines/Math.abs(min)}}else scalar=_lines/(max-min);return array.map(y2=>{if(clamp){if(y2<min)y2=min;if(y2>max)y2=max}return 2*((y2-min)*scalar-1/(2*nLines))+(_lines*(lineIdx+1)*2-1-_lines)})}}static genTimestamps(ct2,sps11){let now=Date.now();let toInterp=[now-ct2*1e3/sps11,now];return _ArrayManip.upsample(toInterp,ct2)}static absmax(array){return Math.max(Math.abs(Math.min(...array)),Math.max(...array))}static downsample(array,fitCount,scalar=1){if(array.length>fitCount){let output=new Array(fitCount);let incr=array.length/fitCount;let lastIdx=array.length-1;let last=0;let counter=0;for(let i=incr;i<array.length;i+=incr){let rounded=Math.round(i);if(rounded>lastIdx)rounded=lastIdx;for(let j2=last;j2<rounded;j2++){output[counter]+=array[j2]}output[counter]/=(rounded-last)*scalar;counter++;last=rounded}return output}else return array}static upsample(array,fitCount,scalar=1){var linearInterpolate=function(before2,after2,atPoint2){return(before2+(after2-before2)*atPoint2)*scalar};var newData=new Array(fitCount);var springFactor=(array.length-1)/(fitCount-1);newData[0]=array[0];for(var i=1;i<fitCount-1;i++){var tmp=i*springFactor;var before=Math.floor(tmp);var after=Math.ceil(tmp);var atPoint=tmp-before;newData[i]=linearInterpolate(array[before],array[after],atPoint)}newData[fitCount-1]=array[array.length-1];return newData}static interpolate(array,fitCount,scalar=1){if(array.length>fitCount){return _ArrayManip.downsample(array,fitCount,scalar)}else if(array.length<fitCount){return _ArrayManip.upsample(array,fitCount,scalar)}return array}static HSLToRGB(h,s,l,scalar=255){s/=100;l/=100;let c2=(1-Math.abs(2*l-1))*s,x2=c2*(1-Math.abs(h/60%2-1)),m=l-c2/2,r=0,g2=0,b=0;if(0<=h&&h<60){r=c2;g2=x2;b=0}else if(60<=h&&h<120){r=x2;g2=c2;b=0}else if(120<=h&&h<180){r=0;g2=c2;b=x2}else if(180<=h&&h<240){r=0;g2=x2;b=c2}else if(240<=h&&h<300){r=x2;g2=0;b=c2}else if(300<=h&&h<360){r=c2;g2=0;b=x2}r=(r+m)*scalar;g2=(g2+m)*scalar;b=(b+m)*scalar;return[r,g2,b]}static circularBuffer(arr,newEntries){if(newEntries.length<arr.length){let slice=arr.slice(newEntries.length);let len=arr.length;arr.splice(0,len,...slice,...newEntries)}else if(newEntries.length>arr.length){let len=arr.length;arr.splice(0,len,newEntries.slice(len-newEntries.length))}else{arr.splice(0,arr.length,...newEntries)}return arr}static reformatData(data,key){if(Array.isArray(data)){if(Array.isArray(data[0])){let d3={};data.forEach((arr,i)=>{d3[i]=arr});data=d3;if(isNaN(data[0][0]))return void 0}else if(key){data={[key]:data};if(isNaN(data[key][0]))return void 0}else{data={0:data};if(isNaN(data[0][0]))return void 0}}else if(typeof data==="object"){for(const key2 in data){if(typeof data[key2]==="number")data[key2]=[data[key2]];else if(data[key2]?.values){if(typeof data[key2].values==="number")data[key2].values=[data[key2].values]}if(isNaN(data[key2][0]))return void 0}}else if(typeof data==="string"){let split;if(data.includes("\r\n")){let lines=data.split("\r\n");data={};lines.forEach((l,j2)=>{if(l.includes("	")){split=l.split("	")}else if(l.includes(",")){split=l.split(",")}else if(l.includes("|")){split=l.split("|")}split.forEach((val,i)=>{if(val.includes(":")){let[key2,v]=val.split(":");let fl2=parseFloat(v);if(fl2)data[key2]=[fl2];else return void 0}else{let fl2=parseFloat(val);if(fl2)data[i]=[fl2];else return void 0}})})}else if(data.includes("	")){split=data.split("	")}else if(data.includes(",")){split=data.split(",")}else if(data.includes("|")){split=data.split("|")}data={};if(split){split.forEach((val,i)=>{if(val.includes(":")){let[key2,v]=val.split(":");let fl2=parseFloat(v);if(fl2)data[key2]=[fl2];else return void 0}else{let fl2=parseFloat(val);if(fl2)data[i]=[fl2];else return void 0}})}}else if(typeof data==="number"){if(key)data={[key]:[data]};else data={0:[data]}}return data}static padTime(data,lastValue,time,targetFit){let slopeIncr=(data[0]-lastValue)/time/targetFit;let padded=[...new Array(targetFit-data.length).map((_3,i)=>lastValue+slopeIncr*(i+1)),...data];return padded}static interpolateForTime(data,time,targetSPS){return _ArrayManip.interpolate(data,Math.ceil(targetSPS*time))}isTypedArray(x2){return ArrayBuffer.isView(x2)&&Object.prototype.toString.call(x2)!=="[object DataView]"}spliceTypedArray(arr,start,end){let s=arr.subarray(0,start);let e;if(end){e=arr.subarray(end+1)}let n;if(s.length>0||e?.length>0)n=new arr.constructor(s.length+e.length);if(s.length>0)n.set(s);if(e&&e.length>0)n.set(e,s.length);return n}};var ArrayManip=_ArrayManip;ArrayManip.bufferValues=(objects,property,keys,buffer)=>{if(!Array.isArray(keys)&&typeof keys==="object")keys=Object.keys(keys);if(!buffer){let object_keys=Object.keys(objects);if(keys)buffer=new Float32Array(object_keys.length*keys.length);else{if(typeof objects[object_keys[0]][property]==="object"){keys=Object.keys(objects[object_keys[0]][property]);buffer=new Float32Array(object_keys.length*keys.length)}else buffer=new Float32Array(object_keys.length)}}let i=0;for(const key in objects){if(objects[key][property]){if(keys){for(let j2=0;j2<keys.length;j2++){buffer[i]=objects[key][property][keys[j2]];i++}}else{buffer[i]=objects[key][property];i++}}}return buffer};var rechk=/^([<>])?(([1-9]\d*)?([xcbB?hHiIfdsp]))*$/;var refmt=/([1-9]\d*)?([xcbB?hHiIfdsp])/g;var str=(v,o,c2)=>String.fromCharCode(...new Uint8Array(v.buffer,v.byteOffset+o,c2));var rts=(v,o,c2,s)=>new Uint8Array(v.buffer,v.byteOffset+o,c2).set(s.split("").map(str2=>str2.charCodeAt(0)));var pst=(v,o,c2)=>str(v,o+1,Math.min(v.getUint8(o),c2-1));var tsp=(v,o,c2,s)=>{v.setUint8(o,s.length);rts(v,o+1,c2-1,s)};var lut=le2=>({x:c2=>[1,c2,0],c:c2=>[c2,1,o=>({u:v=>str(v,o,1),p:(v,c3)=>rts(v,o,1,c3)})],"?":c2=>[c2,1,o=>({u:v=>Boolean(v.getUint8(o)),p:(v,B)=>v.setUint8(o,B)})],b:c2=>[c2,1,o=>({u:v=>v.getInt8(o),p:(v,b)=>v.setInt8(o,b)})],B:c2=>[c2,1,o=>({u:v=>v.getUint8(o),p:(v,B)=>v.setUint8(o,B)})],h:c2=>[c2,2,o=>({u:v=>v.getInt16(o,le2),p:(v,h)=>v.setInt16(o,h,le2)})],H:c2=>[c2,2,o=>({u:v=>v.getUint16(o,le2),p:(v,H2)=>v.setUint16(o,H2,le2)})],i:c2=>[c2,4,o=>({u:v=>v.getInt32(o,le2),p:(v,i)=>v.setInt32(o,i,le2)})],I:c2=>[c2,4,o=>({u:v=>v.getUint32(o,le2),p:(v,I)=>v.setUint32(o,I,le2)})],f:c2=>[c2,4,o=>({u:v=>v.getFloat32(o,le2),p:(v,f)=>v.setFloat32(o,f,le2)})],d:c2=>[c2,8,o=>({u:v=>v.getFloat64(o,le2),p:(v,d3)=>v.setFloat64(o,d3,le2)})],s:c2=>[1,c2,o=>({u:v=>str(v,o,c2),p:(v,s)=>rts(v,o,c2,s.slice(0,c2))})],p:c2=>[1,c2,o=>({u:v=>pst(v,o,c2),p:(v,s)=>tsp(v,o,c2,s.slice(0,c2-1))})]});var errbuf=new RangeError("Structure larger than remaining buffer");var errval=new RangeError("Not enough values for structure");var _ByteParser=class extends ArrayManip{static toDataView(value){if(!(value instanceof DataView)){if(typeof value==="string"&&parseInt(value))value=parseInt(value);if(typeof value==="string"){let enc=new TextEncoder;let hascodes={};for(const code in _ByteParser.codes){while(value.indexOf(code)>-1){let idx=value.indexOf(code);value=value.replace(code,"");hascodes[idx]=code}}let encoded=Array.from(enc.encode(value));for(const key in hascodes){encoded.splice(parseInt(key),0,_ByteParser.codes[hascodes[key]])}value=new DataView(new Uint8Array(encoded).buffer)}else if(typeof value==="number"){let tmp=value;if(value<256){value=new DataView(new ArrayBuffer(1));value.setUint8(0,tmp)}else if(value<65536){value=new DataView(new ArrayBuffer(2));value.setInt16(0,tmp)}else{value=new DataView(new ArrayBuffer(4));value.setUint32(0,tmp)}}else if(value instanceof ArrayBuffer||typeof SharedArrayBuffer!=="undefined"&&value instanceof SharedArrayBuffer){value=new DataView(value)}else if(Array.isArray(value)){value=new DataView(Uint8Array.from(value).buffer)}else if(typeof value==="object"){value=new TextEncoder().encode(JSON.stringify(value))}}return value}static searchBuffer(buffer,searchString,limit){var needle=searchString;var haystack=buffer;var search=_ByteParser.boyerMoore(needle);var skip=search.byteLength;var indices=[];for(var i=search(haystack);i!==-1;i=search(haystack,i+skip)){indices.push(i);if(limit){if(indices.length>=limit)break}}return indices}static bytesToInt16(x0,x1){let int16=(255&x0)<<8|255&x1;if((int16&32768)>0){int16|=4294901760}else{int16&=65535}return int16}static bytesToUInt16(x0,x1){return x0*256+x1}static Uint16ToBytes(y2){return[y2&255,y2>>8&255]}static bytesToInt24(x0,x1,x2){let int24=(255&x0)<<16|(255&x1)<<8|255&x2;if((int24&8388608)>0){int24|=4278190080}else{int24&=16777215}return int24}static bytesToUInt24(x0,x1,x2){return x0*65536+x1*256+x2}static Uint24ToBytes(y2){return[y2&255,y2>>8&255,y2>>16&255]}static bytesToInt32(x0,x1,x2,x3){let int32=(255&x0)<<24|(255&x1)<<16|(255&x2)<<8|255&x3;if((int32&2147483648)>0){int32|=0}else{int32&=4294967295}return int32}static bytesToUInt32(x0,x1,x2,x3){return x0*16777216+x1*65536+x2*256+x3}static Uint32ToBytes(y2){return[y2&255,y2>>8&255,y2>>16&255,y2>>24&255]}static get2sCompliment(val,nbits3){if(val>4294967296)return null;return val<<32-nbits3>>32-nbits3}static getSignedInt(...args){let pos=0;function getInt(size){var value=0;var first=true;while(size--){if(first){let byte=args[pos++];value+=byte&127;if(byte&128){value-=128}first=false}else{value*=256;value+=args[pos++]}}return value}return getInt(args.length)}static asUint8Array(input){if(input instanceof Uint8Array){return input}else if(typeof input==="string"){var arr=new Uint8Array(input.length);for(var i=0;i<input.length;i++){var c2=input.charCodeAt(i);if(c2>127){throw new TypeError("Only ASCII patterns are supported")}arr[i]=c2}return arr}else{return new Uint8Array(input)}}static boyerMoore(patternBuffer){var pattern=_ByteParser.asUint8Array(patternBuffer);var M2=pattern.length;if(M2===0){throw new TypeError("patternBuffer must be at least 1 byte long")}var R2=256;var rightmost_positions=new Int32Array(R2);for(var c2=0;c2<R2;c2++){rightmost_positions[c2]=-1}for(var j2=0;j2<M2;j2++){rightmost_positions[pattern[j2]]=j2}var boyerMooreSearch=(txtBuffer,start,end)=>{var txt=_ByteParser.asUint8Array(txtBuffer);if(start===void 0)start=0;if(end===void 0)end=txt.length;var pat=pattern;var right=rightmost_positions;var lastIndex=end-pat.length;var lastPatIndex=pat.length-1;var skip;for(var i=start;i<=lastIndex;i+=skip){skip=0;for(var j3=lastPatIndex;j3>=0;j3--){var c3=txt[i+j3];if(pat[j3]!==c3){skip=Math.max(1,j3-right[c3]);break}}if(skip===0){return i}}return-1};boyerMooreSearch.byteLength=pattern.byteLength;return boyerMooreSearch}static struct(format){let fns=[],size=0,m=rechk.exec(format);if(!m){throw new RangeError("Invalid format string")}const t=lut("<"===m[1]),lu=(n,c2)=>t[c2](n?parseInt(n,10):1);while(m=refmt.exec(format)){((r,s,f)=>{for(let i=0;i<r;++i,size+=s){if(f){fns.push(f(size))}}})(...lu(...m.slice(1)))}const unpack_from=(arrb,offs)=>{if(arrb.byteLength<(offs|0)+size){throw errbuf}let v=new DataView(arrb,offs|0);return fns.map(f=>f.u(v))};const pack_into=(arrb,offs,...values)=>{if(values.length<fns.length){throw errval}if(arrb.byteLength<offs+size){throw errbuf}const v=new DataView(arrb,offs);new Uint8Array(arrb,offs,size).fill(0);fns.forEach((f,i)=>f.p(v,values[i]))};const pack=(...values)=>{let b=new ArrayBuffer(size);pack_into(b,0,...values);return b};const unpack=arrb=>unpack_from(arrb,0);function*iter_unpack(arrb){for(let offs=0;offs+size<=arrb.byteLength;offs+=size){yield unpack_from(arrb,offs)}}return Object.freeze({unpack,pack,unpack_from,pack_into,iter_unpack,format,size})}};var ByteParser=_ByteParser;ByteParser.codes={"\\n":10,"\\r":13,"\\t":9,"\\s":32,"\\b":8,"\\f":12,"\\":92};var WebSerial=class extends ByteParser{constructor(){super(...arguments);this.streams={};this.createStream=options=>{let stream={_id:options._id?options._id:`stream${Math.floor(Math.random()*1e15)}`,info:options.port.getInfo(),running:false,...options};if(options.port?.readable){if(options.transforms){stream.reader=WebSerial.setStreamTransforms(options.port.readable,options.transforms).getReader()}else{stream.reader=options.port.readable.getReader()}}this.streams[stream._id]=stream;return stream}}getPorts(){return navigator.serial.getPorts()}requestPort(usbVendorId,usbProductId){let options={};if(usbVendorId){options.usbVendorId=usbVendorId}if(usbProductId){options.usbProductId=usbProductId}if(options.usbVendorId)return navigator.serial.requestPort({filters:[options]});else return navigator.serial.requestPort()}openPort(port,options){if(options)options=Object.assign({},options);if(options?.ondisconnect){port.ondisconnect=options.ondisconnect;delete options.ondisconnect}return port.open(options).then(()=>{if(options?.onconnect)options.onconnect(port)})}async readWithTimeout(port,timeout){const reader=port.readable.getReader();const timer=setTimeout(()=>{reader.releaseLock()},timeout);const result=await reader.read();clearTimeout(timer);reader.releaseLock();return result}async writePort(port,message){const writer=port.writable.getWriter();await writer.write(WebSerial.toDataView(message));writer.releaseLock();return true}getSignals(port){return port.getSignals()}setSignals(port,signals){return port.setSignals(signals)}readStream(stream){if(stream.reader&&!stream.running){let reader=stream.reader;if(stream.buffering){if(typeof stream.buffering!=="object")stream.buffering={};if(!stream.buffering.buffer){stream.buffering.buffer=[]}if(!stream.buffering.searchBytes)stream.buffering.searchBytes=new Uint8Array([13,10])}let readLoop=()=>{if(stream.port.readable&&stream.running){reader.read().then(result=>{if(result.done)reader.releaseLock();else{if(stream.buffering){stream.buffering.buffer.push(...result.value);const needle=stream.buffering.searchBytes;const haystack=stream.buffering.buffer;const search=WebSerial.boyerMoore(needle);const skip=search.byteLength;let nextIndex=-1;for(var i=search(haystack);i!==-1;i=search(haystack,i+skip)){if(!stream.buffering.locked&&!("lockIdx"in stream.buffering))stream.buffering.lockIdx=i;else{nextIndex=i;if(nextIndex>=0){if(!stream.buffering.locked){stream.ondata(new Uint8Array(stream.buffering.buffer.splice(stream.buffering.lockIdx+stream.buffering.searchBytes.length,nextIndex+stream.buffering.searchBytes.length)));stream.buffering.buffer.splice(0,stream.buffering.searchBytes.length);stream.buffering.locked=true}else if(nextIndex>0){stream.ondata(new Uint8Array(stream.buffering.buffer.splice(stream.buffering.searchBytes.length,nextIndex)))}}}}}else stream.ondata(result.value);setTimeout(()=>{readLoop()},stream.frequency)}}).catch(er=>{console.error(stream._id," Read error:",er);if(er.message.includes("overrun")||er.message.includes("framing")){delete stream.reader;this.reconnect(stream)}})}else if(!stream.running&&stream.port.readable){try{reader.releaseLock()}catch(er){console.error(er)}}};stream.running=true;readLoop();return stream}return void 0}writeStream(stream,message){if(typeof stream==="string")stream=this.streams[stream];if(stream.port.writable){let writer=stream.port.writable.getWriter();writer.write(WebSerial.toDataView(message));writer.releaseLock();return true}return void 0}closeStream(stream,onclose){if(typeof stream==="string")stream=this.streams[stream];stream.running=false;return new Promise((res,rej)=>{setTimeout(async()=>{if(stream.port.readable&&stream.reader){try{stream.reader.releaseLock()}catch(er){console.error(er)}if(stream.transforms)try{await stream.reader.cancel()}catch(err){console.error(err)}}try{await stream.port.close().then(()=>{if(onclose)onclose(this.streams[stream._id])});delete this.streams[stream._id];res(true)}catch(er){rej(er)}},300)})}reconnect(stream,options){if(typeof stream==="string")stream=this.streams[stream];return new Promise((res,rej)=>{if(typeof stream!=="object"){rej(void 0);return}let info=stream.port.getInfo();this.closeStream(stream._id).then(closed=>{setTimeout(()=>{this.getPorts().then(ports=>{for(let i=0;i<ports.length;i++){if(ports[i].getInfo().usbVendorId===info.usbVendorId&&ports[i].getInfo().usbProductId===info.usbProductId){if(!options)options=stream;else options._id=stream._id;delete options.port;this.openPort(ports[i],options.settings).then(()=>{const stream2=this.createStream({...options,port:ports[i]});this.readStream(stream2);res(stream2)}).catch(rej)}}}).catch(rej)},100)})})}static setStreamTransforms(stream,transforms){let transform=[];Object.keys(transforms).forEach(t=>{let opt=transforms[t];if(opt instanceof TransformStream){transform.push(opt)}else{if(!opt.start)opt.start=function start(){};if(!opt.flush)opt.flush=function flush(){};let transformer=new TransformStream({start:opt.start,transform:opt.transform,flush:opt.flush},opt.writableStrategy,opt.readableStrategy);transform.push(transformer)}});let str2=stream;transform.forEach(transform2=>{str2=str2.pipeThrough(transform2)});return str2}};function ads131m08codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={0:new Array(9),1:new Array(9),2:new Array(9),3:new Array(9),4:new Array(9),5:new Array(9),6:new Array(9),7:new Array(9),timestamp:Date.now()};for(let i=0;i<9;i++){let j2=i*25;output[0][i]=ByteParser.bytesToInt24(arr[j2],arr[j2+1],arr[j2+2]);output[1][i]=ByteParser.bytesToInt24(arr[j2+3],arr[j2+4],arr[j2+5]);output[2][i]=ByteParser.bytesToInt24(arr[j2+6],arr[j2+7],arr[j2+8]);output[3][i]=ByteParser.bytesToInt24(arr[j2+9],arr[j2+10],arr[j2+11]);output[4][i]=ByteParser.bytesToInt24(arr[j2+12],arr[j2+13],arr[j2+14]);output[5][i]=ByteParser.bytesToInt24(arr[j2+15],arr[j2+16],arr[j2+17]);output[6][i]=ByteParser.bytesToInt24(arr[j2+18],arr[j2+19],arr[j2+20]);output[7][i]=ByteParser.bytesToInt24(arr[j2+21],arr[j2+22],arr[j2+23])}return output}var decoder=new TextDecoder;function ads131m08_arduinocodec(data){const parsed=decoder.decode(data);let split;if(parsed.includes("|"))split=parsed.split("|");else if(split.includes(","))split=parsed.split(",");else split=parsed.split("	");return{"0":parseInt(split[0]),"1":parseInt(split[1]),"2":parseInt(split[2]),"3":parseInt(split[3]),"4":parseInt(split[4]),"5":parseInt(split[5]),"6":parseInt(split[6]),"7":parseInt(split[7]),timestamp:Date.now()}}var sps=250;var defaultChartSetting={nSec:10,sps,units:"mV"};var ads131m08ChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting)),"1":JSON.parse(JSON.stringify(defaultChartSetting)),"2":JSON.parse(JSON.stringify(defaultChartSetting)),"3":JSON.parse(JSON.stringify(defaultChartSetting)),"4":JSON.parse(JSON.stringify(defaultChartSetting)),"5":JSON.parse(JSON.stringify(defaultChartSetting)),"6":JSON.parse(JSON.stringify(defaultChartSetting)),"7":JSON.parse(JSON.stringify(defaultChartSetting))}};var gain=32;var nbits=24;var vref=1.2;var defaultsetting={sps,useDCBlock:false,useBandpass:false,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:.96*1e3*vref/(gain*(Math.pow(2,nbits)-1))};var ads131m08FilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting)),"1":JSON.parse(JSON.stringify(defaultsetting)),"2":JSON.parse(JSON.stringify(defaultsetting)),"3":JSON.parse(JSON.stringify(defaultsetting)),"4":JSON.parse(JSON.stringify(defaultsetting)),"5":JSON.parse(JSON.stringify(defaultsetting)),"6":JSON.parse(JSON.stringify(defaultsetting)),"7":JSON.parse(JSON.stringify(defaultsetting))};function cytoncodec(data){let arr;if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i=0;i<8;i++){let idx=1+3*i;output[i]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=25;output.ax=ByteParser.bytesToInt16(arr[accIdx],arr[accIdx+1]);output.ay=ByteParser.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output.az=ByteParser.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output.gx=ByteParser.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output.gy=ByteParser.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output.gz=ByteParser.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}var sps2=250;var cytonSerialSettings={baudRate:115200,codec:cytoncodec,sps:sps2};var defaultChartSetting2={nSec:10,sps:sps2,units:"mV"};var cytonChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting2)),"1":JSON.parse(JSON.stringify(defaultChartSetting2)),"2":JSON.parse(JSON.stringify(defaultChartSetting2)),"3":JSON.parse(JSON.stringify(defaultChartSetting2)),"4":JSON.parse(JSON.stringify(defaultChartSetting2)),"5":JSON.parse(JSON.stringify(defaultChartSetting2)),"6":JSON.parse(JSON.stringify(defaultChartSetting2)),"7":JSON.parse(JSON.stringify(defaultChartSetting2)),"ax":JSON.parse(JSON.stringify(defaultChartSetting2)),"ay":JSON.parse(JSON.stringify(defaultChartSetting2)),"az":JSON.parse(JSON.stringify(defaultChartSetting2)),"gx":JSON.parse(JSON.stringify(defaultChartSetting2)),"gy":JSON.parse(JSON.stringify(defaultChartSetting2)),"gz":JSON.parse(JSON.stringify(defaultChartSetting2))},generateNewLines:true};var defaultsetting2={sps:sps2,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:1e3*4.5/(24*(Math.pow(2,23)-1))};var cytonFilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting2)),"1":JSON.parse(JSON.stringify(defaultsetting2)),"2":JSON.parse(JSON.stringify(defaultsetting2)),"3":JSON.parse(JSON.stringify(defaultsetting2)),"4":JSON.parse(JSON.stringify(defaultsetting2)),"5":JSON.parse(JSON.stringify(defaultsetting2)),"6":JSON.parse(JSON.stringify(defaultsetting2)),"7":JSON.parse(JSON.stringify(defaultsetting2)),"8":JSON.parse(JSON.stringify(defaultsetting2)),"9":JSON.parse(JSON.stringify(defaultsetting2)),"10":JSON.parse(JSON.stringify(defaultsetting2)),"11":JSON.parse(JSON.stringify(defaultsetting2)),"12":JSON.parse(JSON.stringify(defaultsetting2)),"13":JSON.parse(JSON.stringify(defaultsetting2)),"14":JSON.parse(JSON.stringify(defaultsetting2)),"15":JSON.parse(JSON.stringify(defaultsetting2))};function freeeeg128codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i=0;i<128;i++){let idx=i*3+1;output[i]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=385;output["ax"]=ByteParser.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}var sps3=250;var freeeeg128SerialSettings={baudRate:921600,bufferSize:2e3,frequency:1.9,codec:freeeeg128codec,sps:sps3};var freeeeg128ChartSettings={lines:{"ax":{nSec:10,sps:sps3},"ay":{nSec:10,sps:sps3},"az":{nSec:10,sps:sps3},"gx":{nSec:10,sps:sps3},"gy":{nSec:10,sps:sps3},"gz":{nSec:10,sps:sps3}}};var freeeeg128FilterSettings={};for(let i=0;i<128;i++){freeeeg128ChartSettings.lines[i]={sps:sps3,nSec:10,units:"mV"};freeeeg128FilterSettings[i]={sps:250,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,scalar:1e3*2.5/(32*(Math.pow(2,24)-1))}}function freeeeg32codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={};for(let i=0;i<32;i++){let idx=i*3+1;output[i]=ByteParser.bytesToInt24(arr[idx],arr[idx+1],arr[idx+2])}let accIdx=97;output["ax"]=ByteParser.bytesToInt16(arr[accIdx],arr[accIdx+1]);output["ay"]=ByteParser.bytesToInt16(arr[accIdx+2],arr[accIdx+3]);output["az"]=ByteParser.bytesToInt16(arr[accIdx+4],arr[accIdx+5]);output["gx"]=ByteParser.bytesToInt16(arr[accIdx+6],arr[accIdx+7]);output["gy"]=ByteParser.bytesToInt16(arr[accIdx+8],arr[accIdx+9]);output["gz"]=ByteParser.bytesToInt16(arr[accIdx+10],arr[accIdx+11]);output.timestamp=Date.now();return output}var sps4=512;var freeeeg32SerialSettings={baudRate:921600,bufferSize:2e3,frequency:1.9,codec:freeeeg32codec,sps:sps4};var freeeeg32_optical_SerialSettings={baudRate:1e6,bufferSize:2e3,frequency:1.9,codec:freeeeg32codec,sps:sps4};var defaultChartSetting3={nSec:10,sps:sps4};var freeeeg32ChartSettings={lines:{"ax":JSON.parse(JSON.stringify(defaultChartSetting3)),"ay":JSON.parse(JSON.stringify(defaultChartSetting3)),"az":JSON.parse(JSON.stringify(defaultChartSetting3)),"gx":JSON.parse(JSON.stringify(defaultChartSetting3)),"gy":JSON.parse(JSON.stringify(defaultChartSetting3)),"gz":JSON.parse(JSON.stringify(defaultChartSetting3))}};var freeeeg32FilterSettings={};for(let i=0;i<32;i++){freeeeg32ChartSettings.lines[i]={sps:sps4,nSec:10,units:"mV"};freeeeg32FilterSettings[i]={sps:sps4,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:1e3*2.5/(8*(Math.pow(2,24)-1))}}var textdecoder=new TextDecoder;function hegduinocodec(value){let output={timestamp:0,red:0,infrared:0,heg:0,ambient:0,temperature:0};let txt=textdecoder.decode(value);let line=txt.split("|");if(line.length===3){output.timestamp=Date.now();output.red=parseInt(line[0]);output.infrared=parseInt(line[1]);output.heg=parseFloat(line[2])}else if(line.length>=2){output.timestamp=Date.now();output.red=parseInt(line[1]);output.infrared=parseInt(line[2]);output.heg=parseFloat(line[3]);if(line[4])output.ambient=parseFloat(line[4]);if(line[5])output.temperature=parseFloat(line[5]);return output}else return txt}var sps5=40;var hegduinoSerialSettings={baudRate:115200,write:"t\n",codec:hegduinocodec,sps:sps5};var hegduinoV1SerialSettings=Object.assign({},hegduinoSerialSettings);hegduinoV1SerialSettings.sps=19;var hegduinoBLESettings={sps:sps5,services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:"t"},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:true,notifyCallback:void 0,codec:hegduinocodec,sps:sps5}},["6E400004-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{["6E400005-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true},["6E400006-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{write:void 0,notify:true,notifyCallback:void 0},["6E400007-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true}}},androidWebBLE:"o"};var hegduinoV1BLESettings=Object.assign({},hegduinoSerialSettings);hegduinoV1BLESettings.sps=19;function max3010xcodec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;const output={"red":new Array(32),"ir":new Array(32),"max_dietemp":ByteParser.get2sCompliment(arr[193],8)+.0625*arr[194],"timestamp":Date.now()};let i=0;while(i<32){let idx=i*6;if(i%2===0){output["ir"][i]=(arr[idx+1]<<16|arr[idx+2]<<8|arr[idx+3])&524287;output["ir"][i+1]=(arr[idx+4]<<16|arr[idx+5]<<8|arr[idx+6])&524287}else{output["red"][i-1]=(arr[idx+1]<<16|arr[idx+2]<<8|arr[idx+3])&524287;output["red"][i]=(arr[idx+4]<<16|arr[idx+5]<<8|arr[idx+6])&524287}i++}return output}function mpu6050codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={"ax":new Array(20),"ay":new Array(20),"az":new Array(20),"gx":new Array(20),"gy":new Array(20),"gz":new Array(20),"mpu_dietemp":(ByteParser.bytesToInt16(arr[241],arr[242])+521)/340+35,timestamp:Date.now()};for(let i=0;i<20;i++){let idx=i*12;output.ax[i]=ByteParser.bytesToInt16(arr[idx+1],arr[idx+2]);output.ay[i]=ByteParser.bytesToInt16(arr[idx+3],arr[idx+4]);output.az[i]=ByteParser.bytesToInt16(arr[idx+5],arr[idx+6]);output.gx[i]=ByteParser.bytesToInt16(arr[idx+7],arr[idx+8]);output.gy[i]=ByteParser.bytesToInt16(arr[idx+9],arr[idx+10]);output.gz[i]=ByteParser.bytesToInt16(arr[idx+11],arr[idx+12])}return output}function cognixionONE_EEG_codec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={0:new Array,1:new Array,2:new Array,3:new Array,4:new Array,5:new Array,6:new Array,7:new Array,timestamp:Date.now()};for(let i=0;i<7;i++){let j2=i*26+1;if(!arr[j2+23])break;output[0][i]=ByteParser.bytesToUInt24(arr[j2],arr[j2+1],arr[j2+2]);output[1][i]=ByteParser.bytesToUInt24(arr[j2+3],arr[j2+4],arr[j2+5]);output[2][i]=ByteParser.bytesToUInt24(arr[j2+6],arr[j2+7],arr[j2+8]);output[3][i]=ByteParser.bytesToUInt24(arr[j2+9],arr[j2+10],arr[j2+11]);output[4][i]=ByteParser.bytesToUInt24(arr[j2+12],arr[j2+13],arr[j2+14]);output[5][i]=ByteParser.bytesToUInt24(arr[j2+15],arr[j2+16],arr[j2+17]);output[6][i]=ByteParser.bytesToUInt24(arr[j2+18],arr[j2+19],arr[j2+20]);output[7][i]=ByteParser.bytesToUInt24(arr[j2+21],arr[j2+22],arr[j2+23])}return output}var sps6=250;var cognixionONEBLESettings={services:{["82046698-6313-4BB1-9645-6BA28BF86DF5".toLowerCase()]:{["8204669A-6313-4BB1-9645-6BA28BF86DF5".toLowerCase()]:{notify:true,notifyCallback:void 0,codec:cognixionONE_EEG_codec,sps:sps6}},["82E12914-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{["82E12915-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{write:void 0},["82E12916-9AFA-4648-BD1B-8E2B3DC6DAAF".toLowerCase()]:{read:true}}},sps:sps6};var defaultChartSetting4={nSec:10,sps:sps6,units:"mV"};var cognixionONEChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting4)),"1":JSON.parse(JSON.stringify(defaultChartSetting4)),"2":JSON.parse(JSON.stringify(defaultChartSetting4)),"3":JSON.parse(JSON.stringify(defaultChartSetting4)),"4":JSON.parse(JSON.stringify(defaultChartSetting4)),"5":JSON.parse(JSON.stringify(defaultChartSetting4)),"6":JSON.parse(JSON.stringify(defaultChartSetting4)),"7":JSON.parse(JSON.stringify(defaultChartSetting4))}};var PeanutCodes={2:{type:"POOR_SIGNAL",format:"<B",byteLength:1},144:{type:"heg",format:"<i",byteLength:4},145:{type:"filteredHEG",format:"<i",byteLength:4},147:{type:"rawdata4",format:"<iiii",byteLength:4*4},148:{type:"rawdata6",format:"<iiiiii",byteLength:4*6},160:{type:"sampleNumber",format:"<i",byteLength:4},176:{type:"debug0",format:"<i",byteLength:4},177:{type:"debug1",format:"<i",byteLength:4},178:{type:"debug2",format:"<i",byteLength:4},179:{type:"debug3",format:"<i",byteLength:4},180:{type:"debug4",format:"<iiiiii",byteLength:4*6},181:{type:"debug4",format:"<iiiiii",byteLength:4*6},182:{type:"rawdata27",format:"<B"+"i".repeat(26),byteLength:1+4*26}};function peanutcodec(data){let result={};let i=0;while(i<data.length){if(PeanutCodes[data[i]]&&i+1+PeanutCodes[data[i]].byteLength<=data.length){let slice=data.slice(i+1,i+1+PeanutCodes[data[i]].byteLength).buffer;let unpacked=ByteParser.struct(PeanutCodes[data[i]].format).unpack(slice);let code=PeanutCodes[data[i]].type;if(code==="unfilteredHEG"||code==="heg")unpacked=unpacked[0]/256;else if(code==="POOR_SIGNAL"||code==="sampleNumber"||code==="debug0"||code==="debug1"||code==="debug2"||code==="debug3")unpacked=unpacked[0];if(!result[PeanutCodes[data[i]].type]){if(Array.isArray(unpacked))result[PeanutCodes[data[i]].type]=unpacked;else result[PeanutCodes[data[i]].type]=[unpacked]}else{if(Array.isArray(unpacked))result[PeanutCodes[data[i]].type].push(...unpacked);else result[PeanutCodes[data[i]].type].push(unpacked)}i+=PeanutCodes[data[i]].byteLength+1}else i++}result.timestamp=Date.now();return result}var peanutSerialSettings={baudRate:38400,bufferSize:400,write:"protocol 3\n",buffering:{searchBytes:new Uint8Array([170,170])},codec:peanutcodec,sps:10.101};var sealevel_hpa=1013.25;var bme280codec=data=>{let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;let output={temp:[],pressure:[],humidity:[],altitude:[]};for(let j2=0;j2<3;j2++){let i=j2*24;let tint=ByteParser.bytesToUInt32(arr[0+i],arr[1+i],arr[2+i],arr[3+i]);let tfrac=ByteParser.bytesToUInt32(arr[4+i],arr[5+i],arr[6+i],arr[7+i]);output.temp.push(tint+tfrac/Math.pow(10,Math.ceil(Math.log10(tfrac))));let pint=ByteParser.bytesToUInt32(arr[8+i],arr[9+i],arr[10+i],arr[11+i]);let pfrac=ByteParser.bytesToUInt32(arr[12+i],arr[13+i],arr[14+i],arr[15+i]);output.pressure.push(pint+pfrac/Math.pow(10,Math.ceil(Math.log10(pfrac))));let hint=ByteParser.bytesToUInt32(arr[16+i],arr[17+i],arr[18+i],arr[19+i]);let hfrac=ByteParser.bytesToUInt32(arr[20+i],arr[21+i],arr[22+i],arr[23+i]);output.humidity.push(hint+hfrac/Math.pow(10,Math.ceil(Math.log10(hfrac))));output.altitude.push(altitude(output.pressure[j2],output.temp[j2]))}return output};var exponent=1/5.257;var denom=1/.0065;function altitude(pressure,temperature){return(Math.pow(sealevel_hpa/pressure,exponent)-1)*(temperature+273.15)*denom}function nrf5x_usbcodec(data){let arr;if(data.getInt8)arr=new Uint8Array(data.buffer);else if(!data.buffer)arr=new Uint8Array(data);else arr=data;const output={};if(arr[0]===2){Object.assign(output,ads131m08codec(arr.subarray(2)))}else if(arr[0]===3){let result=ads131m08codec(arr.subarray(2));Object.keys(result).forEach((key,i)=>{output[i+8]=result[key]})}else if(arr[0]===4){Object.assign(output,mpu6050codec(arr.subarray(2)))}else if(arr[0]===5){Object.assign(output,max3010xcodec(arr.subarray(2)))}else if(arr[0]===6){Object.assign(output,bme280codec(arr.subarray(2)))}else{Object.assign(output,ads131m08codec(arr))}return output}var nrf5xSerialSettings={baudRate:115200,buffering:{searchBytes:new Uint8Array([240,240])},codec:nrf5x_usbcodec,sps:250};var nrf5xBLESettings={sps:250,services:{"0000cafe-b0ba-8bad-f00d-deadbeef0000":{"0001cafe-b0ba-8bad-f00d-deadbeef0000":{write:void 0},"0002cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec,sps:250},"0003cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:max3010xcodec,sps:100},"0004cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:mpu6050codec,sps:100},"0005cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:ads131m08codec,sps:250},"0006cafe-b0ba-8bad-f00d-deadbeef0000":{notify:true,notifyCallback:void 0,codec:bme280codec,sps:3.33}}}};var defaultChartSetting5={nSec:10,sps:250,units:"mV"};var nrf5x_usbChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting5)),"1":JSON.parse(JSON.stringify(defaultChartSetting5)),"2":JSON.parse(JSON.stringify(defaultChartSetting5)),"3":JSON.parse(JSON.stringify(defaultChartSetting5)),"4":JSON.parse(JSON.stringify(defaultChartSetting5)),"5":JSON.parse(JSON.stringify(defaultChartSetting5)),"6":JSON.parse(JSON.stringify(defaultChartSetting5)),"7":JSON.parse(JSON.stringify(defaultChartSetting5))},generateNewLines:true,cleanGeneration:false};var gain2=32;var nbits2=24;var vref2=1.2;var defaultsetting3={sps:250,useDCBlock:false,useBandpass:false,bandpassLower:3,bandpassUpper:45,useScaling:true,scalar:.96*1e3*vref2/(gain2*(Math.pow(2,nbits2)-1))};var nrf5x_usbFilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting3)),"1":JSON.parse(JSON.stringify(defaultsetting3)),"2":JSON.parse(JSON.stringify(defaultsetting3)),"3":JSON.parse(JSON.stringify(defaultsetting3)),"4":JSON.parse(JSON.stringify(defaultsetting3)),"5":JSON.parse(JSON.stringify(defaultsetting3)),"6":JSON.parse(JSON.stringify(defaultsetting3)),"7":JSON.parse(JSON.stringify(defaultsetting3)),"8":JSON.parse(JSON.stringify(defaultsetting3)),"9":JSON.parse(JSON.stringify(defaultsetting3)),"10":JSON.parse(JSON.stringify(defaultsetting3)),"11":JSON.parse(JSON.stringify(defaultsetting3)),"12":JSON.parse(JSON.stringify(defaultsetting3)),"13":JSON.parse(JSON.stringify(defaultsetting3)),"14":JSON.parse(JSON.stringify(defaultsetting3)),"15":JSON.parse(JSON.stringify(defaultsetting3))};var textdecoder2=new TextDecoder;function statechangercodec(value){let output={timestamp:0,left_red:0,left_infrared:0,left_heg:0,center_red:0,center_infrared:0,center_heg:0,right_red:0,right_infrared:0,right_heg:0};let txt=textdecoder2.decode(value);let line=txt.split("|");if(line.length>=5){output.timestamp=Date.now();output.left_red=parseInt(line[1]);output.left_infrared=parseInt(line[2]);output.left_heg=parseFloat(line[3]);output.center_red=parseInt(line[4]);output.center_infrared=parseInt(line[5]);output.center_heg=parseFloat(line[6]);output.right_red=parseInt(line[7]);output.right_infrared=parseInt(line[8]);output.right_heg=parseFloat(line[9]);return output}else return txt}var statechangerSerialSettings={baudRate:115200,codec:statechangercodec};var statechangerBLESettings={services:{["6E400001-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{"6e400002-b5a3-f393-e0a9-e50e24dcca9e":{write:"t"},"6e400003-b5a3-f393-e0a9-e50e24dcca9e":{notify:true,notifyCallback:void 0,codec:statechangercodec}},["6E400004-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{["6E400005-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true},["6E400006-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{write:void 0,notify:true,notifyCallback:void 0},["6E400007-B5A3-F393-E0A9-E50E24DCCA9E".toLowerCase()]:{read:true}}},androidWebBLE:"o"};function blueberrycodec(value){let output={red:value.getInt32(2),ir:value.getInt32(6),ir2:value.getInt32(10),timestamp:Date.now()};output.heg=output.red/(.5*(output.ir+output.ir2));return output}var sps7=40;var blueberryBLESettings={namePrefix:"blueberry",services:{"0f0e0d0c-0b0a-0908-0706-050403020100":{"1f1e1d1c-1b1a-1918-1716-151413121110":{write:void 0},"3f3e3d3c-3b3a-3938-3736-353433323130":{notify:true,notifyCallback:void 0,codec:blueberrycodec,sps:sps7}}},sps:sps7};function blueberryshortcodec(value){let output={sred:value.getInt32(2),sir:value.getInt32(6),sir2:value.getInt32(10),timestamp:Date.now()};output.sheg=output.sred/(.5*(output.sir+output.sir2));return output}function blueberrylongcodec(value){let output={red:value.getInt32(2),ir:value.getInt32(6),ir2:value.getInt32(10),timestamp:Date.now()};output.heg=output.sred/(.5*(output.ir+output.ir2));return output}var sps8=40;var blueberry2BLESettings={namePrefix:"blueberry",services:{"0f0e0d0c-0b0a-0908-0706-050403020100":{"1f1e1d1c-1b1a-1918-1716-151413121110":{write:void 0},"4f4e4d4c-4b6a-6968-6766-656463426160":{notify:true,notifyCallback:void 0,codec:blueberrylongcodec,sps:sps8},"4f4e4d4c-4b5a-5958-5756-555453425150":{notify:true,notifyCallback:void 0,codec:blueberryshortcodec,sps:sps8}}},sps:sps8};var Po=Object.create;var Ee=Object.defineProperty;var Do=Object.getOwnPropertyDescriptor;var Ao=Object.getOwnPropertyNames;var Eo=Object.getPrototypeOf;var ve=Object.prototype.hasOwnProperty;var vo=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var To=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of Ao(t))!ve.call(e,a)&&a!==n&&Ee(e,a,{get:()=>t[a],enumerable:!(r=Do(t,a))||r.enumerable});return e};var Ro=(e,t,n)=>(n=e!=null?Po(Eo(e)):{},To(t||!e||!e.__esModule?Ee(n,"default",{value:e,enumerable:true}):n,e));var jt=vo((ll,he2)=>{var At,Et2,vt,Tt,Rt,Nt,_t,Ft,Mt,Ce2,Te2,Gt,Ut,Lt,L,Ht,zt,Vt,Qt,Wt,qt,Yt,$t,Zt,pe2;(function(e){var t=typeof global=="object"?global:typeof self=="object"?self:typeof this=="object"?this:{};typeof define=="function"&&define.amd?define("tslib",["exports"],function(r){e(n(t,n(r)))}):typeof he2=="object"&&typeof he2.exports=="object"?e(n(t,n(he2.exports))):e(n(t));function n(r,a){return r!==t&&(typeof Object.create=="function"?Object.defineProperty(r,"__esModule",{value:true}):r.__esModule=true),function(i,c2){return r[i]=a?a(i,c2):c2}}})(function(e){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(r[i]=a[i])};At=function(r,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");t(r,a);function i(){this.constructor=r}r.prototype=a===null?Object.create(a):(i.prototype=a.prototype,new i)},Et2=Object.assign||function(r){for(var a,i=1,c2=arguments.length;i<c2;i++){a=arguments[i];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(r[s]=a[s])}return r},vt=function(r,a){var i={};for(var c2 in r)Object.prototype.hasOwnProperty.call(r,c2)&&a.indexOf(c2)<0&&(i[c2]=r[c2]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,c2=Object.getOwnPropertySymbols(r);s<c2.length;s++)a.indexOf(c2[s])<0&&Object.prototype.propertyIsEnumerable.call(r,c2[s])&&(i[c2[s]]=r[c2[s]]);return i},Tt=function(r,a,i,c2){var s=arguments.length,l=s<3?a:c2===null?c2=Object.getOwnPropertyDescriptor(a,i):c2,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(r,a,i,c2);else for(var f=r.length-1;f>=0;f--)(u=r[f])&&(l=(s<3?u(l):s>3?u(a,i,l):u(a,i))||l);return s>3&&l&&Object.defineProperty(a,i,l),l},Rt=function(r,a){return function(i,c2){a(i,c2,r)}},Nt=function(r,a){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,a)},_t=function(r,a,i,c2){function s(l){return l instanceof i?l:new i(function(u){u(l)})}return new(i||(i=Promise))(function(l,u){function f(p){try{m(c2.next(p))}catch(B){u(B)}}function b(p){try{m(c2.throw(p))}catch(B){u(B)}}function m(p){p.done?l(p.value):s(p.value).then(f,b)}m((c2=c2.apply(r,a||[])).next())})},Ft=function(r,a){var i={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},c2,s,l,u;return u={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function f(m){return function(p){return b([m,p])}}function b(m){if(c2)throw new TypeError("Generator is already executing.");for(;i;)try{if(c2=1,s&&(l=m[0]&2?s.return:m[0]?s.throw||((l=s.return)&&l.call(s),0):s.next)&&!(l=l.call(s,m[1])).done)return l;switch(s=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return i.label++,{value:m[1],done:false};case 5:i.label++,s=m[1],m=[0];continue;case 7:m=i.ops.pop(),i.trys.pop();continue;default:if(l=i.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){i=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){i.label=m[1];break}if(m[0]===6&&i.label<l[1]){i.label=l[1],l=m;break}if(l&&i.label<l[2]){i.label=l[2],i.ops.push(m);break}l[2]&&i.ops.pop(),i.trys.pop();continue}m=a.call(r,i)}catch(p){m=[6,p],s=0}finally{c2=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:true}}},Mt=function(r,a){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(a,i)&&pe2(a,r,i)},pe2=Object.create?function(r,a,i,c2){c2===void 0&&(c2=i);var s=Object.getOwnPropertyDescriptor(a,i);(!s||("get"in s?!a.__esModule:s.writable||s.configurable))&&(s={enumerable:true,get:function(){return a[i]}}),Object.defineProperty(r,c2,s)}:function(r,a,i,c2){c2===void 0&&(c2=i),r[c2]=a[i]},Ce2=function(r){var a=typeof Symbol=="function"&&Symbol.iterator,i=a&&r[a],c2=0;if(i)return i.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&c2>=r.length&&(r=void 0),{value:r&&r[c2++],done:!r}}};throw new TypeError(a?"Object is not iterable.":"Symbol.iterator is not defined.")},Te2=function(r,a){var i=typeof Symbol=="function"&&r[Symbol.iterator];if(!i)return r;var c2=i.call(r),s,l=[],u;try{for(;(a===void 0||a-- >0)&&!(s=c2.next()).done;)l.push(s.value)}catch(f){u={error:f}}finally{try{s&&!s.done&&(i=c2.return)&&i.call(c2)}finally{if(u)throw u.error}}return l},Gt=function(){for(var r=[],a=0;a<arguments.length;a++)r=r.concat(Te2(arguments[a]));return r},Ut=function(){for(var r=0,a=0,i=arguments.length;a<i;a++)r+=arguments[a].length;for(var c2=Array(r),s=0,a=0;a<i;a++)for(var l=arguments[a],u=0,f=l.length;u<f;u++,s++)c2[s]=l[u];return c2},Lt=function(r,a,i){if(i||arguments.length===2)for(var c2=0,s=a.length,l;c2<s;c2++)(l||!(c2 in a))&&(l||(l=Array.prototype.slice.call(a,0,c2)),l[c2]=a[c2]);return r.concat(l||Array.prototype.slice.call(a))},L=function(r){return this instanceof L?(this.v=r,this):new L(r)},Ht=function(r,a,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var c2=i.apply(r,a||[]),s,l=[];return s={},u("next"),u("throw"),u("return"),s[Symbol.asyncIterator]=function(){return this},s;function u(C){c2[C]&&(s[C]=function(x2){return new Promise(function(h,T){l.push([C,x2,h,T])>1||f(C,x2)})})}function f(C,x2){try{b(c2[C](x2))}catch(h){B(l[0][3],h)}}function b(C){C.value instanceof L?Promise.resolve(C.value.v).then(m,p):B(l[0][2],C)}function m(C){f("next",C)}function p(C){f("throw",C)}function B(C,x2){C(x2),l.shift(),l.length&&f(l[0][0],l[0][1])}},zt=function(r){var a,i;return a={},c2("next"),c2("throw",function(s){throw s}),c2("return"),a[Symbol.iterator]=function(){return this},a;function c2(s,l){a[s]=r[s]?function(u){return(i=!i)?{value:L(r[s](u)),done:s==="return"}:l?l(u):u}:l}},Vt=function(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=r[Symbol.asyncIterator],i;return a?a.call(r):(r=typeof Ce2=="function"?Ce2(r):r[Symbol.iterator](),i={},c2("next"),c2("throw"),c2("return"),i[Symbol.asyncIterator]=function(){return this},i);function c2(l){i[l]=r[l]&&function(u){return new Promise(function(f,b){u=r[l](u),s(f,b,u.done,u.value)})}}function s(l,u,f,b){Promise.resolve(b).then(function(m){l({value:m,done:f})},u)}},Qt=function(r,a){return Object.defineProperty?Object.defineProperty(r,"raw",{value:a}):r.raw=a,r};var n=Object.create?function(r,a){Object.defineProperty(r,"default",{enumerable:true,value:a})}:function(r,a){r.default=a};Wt=function(r){if(r&&r.__esModule)return r;var a={};if(r!=null)for(var i in r)i!=="default"&&Object.prototype.hasOwnProperty.call(r,i)&&pe2(a,r,i);return n(a,r),a},qt=function(r){return r&&r.__esModule?r:{default:r}},Yt=function(r,a,i,c2){if(i==="a"&&!c2)throw new TypeError("Private accessor was defined without a getter");if(typeof a=="function"?r!==a||!c2:!a.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return i==="m"?c2:i==="a"?c2.call(r):c2?c2.value:a.get(r)},$t=function(r,a,i,c2,s){if(c2==="m")throw new TypeError("Private method is not writable");if(c2==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof a=="function"?r!==a||!s:!a.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return c2==="a"?s.call(r,i):s?s.value=i:a.set(r,i),i},Zt=function(r,a){if(a===null||typeof a!="object"&&typeof a!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof r=="function"?a===r:r.has(a)},e("__extends",At),e("__assign",Et2),e("__rest",vt),e("__decorate",Tt),e("__param",Rt),e("__metadata",Nt),e("__awaiter",_t),e("__generator",Ft),e("__exportStar",Mt),e("__createBinding",pe2),e("__values",Ce2),e("__read",Te2),e("__spread",Gt),e("__spreadArrays",Ut),e("__spreadArray",Lt),e("__await",L),e("__asyncGenerator",Ht),e("__asyncDelegator",zt),e("__asyncValues",Vt),e("__makeTemplateObject",Qt),e("__importStar",Wt),e("__importDefault",qt),e("__classPrivateFieldGet",Yt),e("__classPrivateFieldSet",$t),e("__classPrivateFieldIn",Zt)})});var Xt=Ro(jt(),1);var{__extends:w,__assign:ul,__rest:ml,__decorate:fl,__param:dl,__metadata:Cl,__awaiter:Kt,__generator:be,__exportStar:pl,__createBinding:hl,__values:_,__read:D,__spread:bl,__spreadArrays:Sl,__spreadArray:R,__await:Se,__asyncGenerator:Jt,__asyncDelegator:yl,__asyncValues:en,__makeTemplateObject:Il,__importStar:Bl,__importDefault:Ol,__classPrivateFieldGet:gl,__classPrivateFieldSet:xl,__classPrivateFieldIn:Pl}=Xt.default;function d(e){return typeof e=="function"}function H(e){var t=function(r){Error.call(r),r.stack=new Error().stack},n=e(t);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var ye=H(function(e){return function(n){e(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,a){return a+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function K(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var z=function(){function e(t){this.initialTeardown=t,this.closed=false,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var t,n,r,a,i;if(!this.closed){this.closed=true;var c2=this._parentage;if(c2)if(this._parentage=null,Array.isArray(c2))try{for(var s=_(c2),l=s.next();!l.done;l=s.next()){var u=l.value;u.remove(this)}}catch(C){t={error:C}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}else c2.remove(this);var f=this.initialTeardown;if(d(f))try{f()}catch(C){i=C instanceof ye?C.errors:[C]}var b=this._finalizers;if(b){this._finalizers=null;try{for(var m=_(b),p=m.next();!p.done;p=m.next()){var B=p.value;try{tn(B)}catch(C){i=i??[],C instanceof ye?i=R(R([],D(i)),D(C.errors)):i.push(C)}}}catch(C){r={error:C}}finally{try{p&&!p.done&&(a=m.return)&&a.call(m)}finally{if(r)throw r.error}}}if(i)throw new ye(i)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)tn(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(t)}},e.prototype._hasParent=function(t){var n=this._parentage;return n===t||Array.isArray(n)&&n.includes(t)},e.prototype._addParent=function(t){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t},e.prototype._removeParent=function(t){var n=this._parentage;n===t?this._parentage=null:Array.isArray(n)&&K(n,t)},e.prototype.remove=function(t){var n=this._finalizers;n&&K(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=true,t}(),e}();var Re=z.EMPTY;function Ie(e){return e instanceof z||e&&"closed"in e&&d(e.remove)&&d(e.add)&&d(e.unsubscribe)}function tn(e){d(e)?e():e.unsubscribe()}var P={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:false,useDeprecatedNextContext:false};var V={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var a=V.delegate;return a?.setTimeout?a.setTimeout.apply(a,R([e,t],D(n))):setTimeout.apply(void 0,R([e,t],D(n)))},clearTimeout:function(e){var t=V.delegate;return(t?.clearTimeout||clearTimeout)(e)},delegate:void 0};function Be(e){V.setTimeout(function(){var t=P.onUnhandledError;if(t)t(e);else throw e})}function J(){}var nn=function(){return Ne("C",void 0,void 0)}();function rn(e){return Ne("E",void 0,e)}function an(e){return Ne("N",e,void 0)}function Ne(e,t,n){return{kind:e,value:t,error:n}}var F=null;function Q(e){if(P.useDeprecatedSynchronousErrorHandling){var t=!F;if(t&&(F={errorThrown:false,error:null}),e(),t){var n=F,r=n.errorThrown,a=n.error;if(F=null,r)throw a}}else e()}function on(e){P.useDeprecatedSynchronousErrorHandling&&F&&(F.errorThrown=true,F.error=e)}var ee=function(e){w(t,e);function t(n){var r=e.call(this)||this;return r.isStopped=false,n?(r.destination=n,Ie(n)&&n.add(r)):r.destination=Mo,r}return t.create=function(n,r,a){return new ge(n,r,a)},t.prototype.next=function(n){this.isStopped?Fe(an(n),this):this._next(n)},t.prototype.error=function(n){this.isStopped?Fe(rn(n),this):(this.isStopped=true,this._error(n))},t.prototype.complete=function(){this.isStopped?Fe(nn,this):(this.isStopped=true,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=true,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(n){this.destination.next(n)},t.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(z);var No=Function.prototype.bind;function _e(e,t){return No.call(e,t)}var _o=function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var n=this.partialObserver;if(n.next)try{n.next(t)}catch(r){Oe(r)}},e.prototype.error=function(t){var n=this.partialObserver;if(n.error)try{n.error(t)}catch(r){Oe(r)}else Oe(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(n){Oe(n)}},e}();var ge=function(e){w(t,e);function t(n,r,a){var i=e.call(this)||this,c2;if(d(n)||!n)c2={next:n??void 0,error:r??void 0,complete:a??void 0};else{var s;i&&P.useDeprecatedNextContext?(s=Object.create(n),s.unsubscribe=function(){return i.unsubscribe()},c2={next:n.next&&_e(n.next,s),error:n.error&&_e(n.error,s),complete:n.complete&&_e(n.complete,s)}):c2=n}return i.destination=new _o(c2),i}return t}(ee);function Oe(e){P.useDeprecatedSynchronousErrorHandling?on(e):Be(e)}function Fo(e){throw e}function Fe(e,t){var n=P.onStoppedNotification;n&&V.setTimeout(function(){return n(e,t)})}var Mo={closed:true,next:J,error:Fo,complete:J};var W=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function q(e){return e}function cn(e){return e.length===0?q:e.length===1?e[0]:function(n){return e.reduce(function(r,a){return a(r)},n)}}var O=function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(t,n,r){var a=this,i=Uo(t)?t:new ge(t,n,r);return Q(function(){var c2=a,s=c2.operator,l=c2.source;i.add(s?s.call(i,l):l?a._subscribe(i):a._trySubscribe(i))}),i},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(n){t.error(n)}},e.prototype.forEach=function(t,n){var r=this;return n=sn(n),new n(function(a,i){var c2=new ge({next:function(s){try{t(s)}catch(l){i(l),c2.unsubscribe()}},error:i,complete:a});r.subscribe(c2)})},e.prototype._subscribe=function(t){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(t)},e.prototype[W]=function(){return this},e.prototype.pipe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return cn(t)(this)},e.prototype.toPromise=function(t){var n=this;return t=sn(t),new t(function(r,a){var i;n.subscribe(function(c2){return i=c2},function(c2){return a(c2)},function(){return r(i)})})},e.create=function(t){return new e(t)},e}();function sn(e){var t;return(t=e??P.Promise)!==null&&t!==void 0?t:Promise}function Go(e){return e&&d(e.next)&&d(e.error)&&d(e.complete)}function Uo(e){return e&&e instanceof ee||Go(e)&&Ie(e)}var Ho=function(e){w(t,e);function t(n,r,a,i,c2,s){var l=e.call(this,n)||this;return l.onFinalize=c2,l.shouldUnsubscribe=s,l._next=r?function(u){try{r(u)}catch(f){n.error(f)}}:e.prototype._next,l._error=i?function(u){try{i(u)}catch(f){n.error(f)}finally{this.unsubscribe()}}:e.prototype._error,l._complete=a?function(){try{a()}catch(u){n.error(u)}finally{this.unsubscribe()}}:e.prototype._complete,l}return t.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},t}(ee);var ln=H(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}});var M=function(e){w(t,e);function t(){var n=e.call(this)||this;return n.closed=false,n.currentObservers=null,n.observers=[],n.isStopped=false,n.hasError=false,n.thrownError=null,n}return t.prototype.lift=function(n){var r=new un(this,this);return r.operator=n,r},t.prototype._throwIfClosed=function(){if(this.closed)throw new ln},t.prototype.next=function(n){var r=this;Q(function(){var a,i;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var c2=_(r.currentObservers),s=c2.next();!s.done;s=c2.next()){var l=s.value;l.next(n)}}catch(u){a={error:u}}finally{try{s&&!s.done&&(i=c2.return)&&i.call(c2)}finally{if(a)throw a.error}}}})},t.prototype.error=function(n){var r=this;Q(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=true,r.thrownError=n;for(var a=r.observers;a.length;)a.shift().error(n)}})},t.prototype.complete=function(){var n=this;Q(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=true;for(var r=n.observers;r.length;)r.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=true,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:false,configurable:true}),t.prototype._trySubscribe=function(n){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,n)},t.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},t.prototype._innerSubscribe=function(n){var r=this,a=this,i=a.hasError,c2=a.isStopped,s=a.observers;return i||c2?Re:(this.currentObservers=null,s.push(n),new z(function(){r.currentObservers=null,K(s,n)}))},t.prototype._checkFinalizedStatuses=function(n){var r=this,a=r.hasError,i=r.thrownError,c2=r.isStopped;a?n.error(i):c2&&n.complete()},t.prototype.asObservable=function(){var n=new O;return n.source=this,n},t.create=function(n,r){return new un(n,r)},t}(O);var un=function(e){w(t,e);function t(n,r){var a=e.call(this)||this;return a.destination=n,a.source=r,a}return t.prototype.next=function(n){var r,a;(a=(r=this.destination)===null||r===void 0?void 0:r.next)===null||a===void 0||a.call(r,n)},t.prototype.error=function(n){var r,a;(a=(r=this.destination)===null||r===void 0?void 0:r.error)===null||a===void 0||a.call(r,n)},t.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},t.prototype._subscribe=function(n){var r,a;return(a=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&a!==void 0?a:Re},t}(M);var Me=function(e){w(t,e);function t(n){var r=e.call(this)||this;return r._value=n,r}return Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:false,configurable:true}),t.prototype._subscribe=function(n){var r=e.prototype._subscribe.call(this,n);return!r.closed&&n.next(this._value),r},t.prototype.getValue=function(){var n=this,r=n.hasError,a=n.thrownError,i=n._value;if(r)throw a;return this._throwIfClosed(),i},t.prototype.next=function(n){e.prototype.next.call(this,this._value=n)},t}(M);var mn=new O(function(e){return e.complete()});function zo(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var hn=zo();var Pe=H(function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}});var Zo=Array.isArray;var Va=51;var Qa=1.2;var Yc=Qa/(8388607*Va*1.5);var Ct=`
LIS3DH Registers
0x07.0
0x08.0
0x09.0
0x0A.0
0x0B.0
0x0C.0
0x0D.0
0x0E.0
0x0F.33

0x1F.0
0x20.8
0x21.0
0x22.0
0x23.18
0x24.0
0x25.0
0x26.0
0x27.0
0x28.0
0x29.0
0x2A.0
0x2B.0
0x2C.0
0x2D.0
0x2E.0
0x2F.20
0x30.0
0x31.0
0x32.0
0x33.0

0x38.0
0x39.0
0x3A.0
0x3B.0
0x3C.0
0x3D.0
`;var pt=`
LIS3DH Registers
0x07 00
0x08 00
0x09 00
0x0A 00
0x0B 00
0x0C 00
0x0D 00
0x0E 00
0x0F 33

0x1F 00
0x20 08
0x21 00
0x22 00
0x23 18
0x24 00
0x25 00
0x26 00
0x27 00
0x28 00
0x29 00
0x2A 00
0x2B 00
0x2C 00
0x2D 00
0x2E 00
0x2F 20
0x30 00
0x31 00
0x32 00
0x33 00

0x38 00
0x39 00
0x3A 00
0x3B 00
0x3C 00
0x3D 00
`;var ie=`
Board ADS Registers
ADS_ID, 00, 3E, 0, 0, 1, 1, 1, 1, 1, 0
CONFIG1, 01, 96, 1, 0, 0, 1, 0, 1, 1, 0
CONFIG2, 02, C0, 1, 1, 0, 0, 0, 0, 0, 0
CONFIG3, 03, EC, 1, 1, 1, 0, 1, 1, 0, 0
LOFF, 04, 02, 0, 0, 0, 0, 0, 0, 1, 0
CH1SET, 05, 68, 0, 1, 1, 0, 1, 0, 0, 0
CH2SET, 06, 68, 0, 1, 1, 0, 1, 0, 0, 0
CH3SET, 07, 68, 0, 1, 1, 0, 1, 0, 0, 0
CH4SET, 08, 68, 0, 1, 1, 0, 1, 0, 0, 0
CH5SET, 09, 68, 0, 1, 1, 0, 1, 0, 0, 0
CH6SET, 0A, 68, 0, 1, 1, 0, 1, 0, 0, 0
CH7SET, 0B, 68, 0, 1, 1, 0, 1, 0, 0, 0
CH8SET, 0C, 68, 0, 1, 1, 0, 1, 0, 0, 0
BIAS_SENSP, 0D, FF, 1, 1, 1, 1, 1, 1, 1, 1
BIAS_SENSN, 0E, FF, 1, 1, 1, 1, 1, 1, 1, 1
LOFF_SENSP, 0F, 00, 0, 0, 0, 0, 0, 0, 0, 0
LOFF_SENSN, 10, 00, 0, 0, 0, 0, 0, 0, 0, 0
LOFF_FLIP, 11, 00, 0, 0, 0, 0, 0, 0, 0, 0
LOFF_STATP, 12, 00, 0, 0, 0, 0, 0, 0, 0, 0
LOFF_STATN, 13, 00, 0, 0, 0, 0, 0, 0, 0, 0
GPIO, 14, 0F, 0, 0, 0, 0, 1, 1, 1, 1
MISC1, 15, 00, 0, 0, 0, 0, 0, 0, 0, 0
MISC2, 16, 00, 0, 0, 0, 0, 0, 0, 0, 0
CONFIG4, 17, 00, 0, 0, 0, 0, 0, 0, 0, 0
`;var ht=`
Daisy ADS Registers
ADS_ID, 00, 3E, 0, 0, 1, 1, 1, 1, 1, 0
CONFIG1, 01, 96, 1, 0, 0, 1, 0, 1, 1, 0
CONFIG2, 02, C0, 1, 1, 0, 0, 0, 0, 0, 0
CONFIG3, 03, EC, 1, 1, 1, 0, 1, 1, 0, 0
LOFF, 04, 02, 0, 0, 0, 0, 0, 0, 1, 0
CH1SET, 05, 68, 0, 1, 1, 0, 1, 0, 0, 0
CH2SET, 06, 68, 0, 1, 1, 0, 1, 0, 0, 0
CH3SET, 07, 68, 0, 1, 1, 0, 1, 0, 0, 0
CH4SET, 08, 68, 0, 1, 1, 0, 1, 0, 0, 0
CH5SET, 09, 68, 0, 1, 1, 0, 1, 0, 0, 0
CH6SET, 0A, 68, 0, 1, 1, 0, 1, 0, 0, 0
CH7SET, 0B, 68, 0, 1, 1, 0, 1, 0, 0, 0
CH8SET, 0C, 68, 0, 1, 1, 0, 1, 0, 0, 0
BIAS_SENSP, 0D, FF, 1, 1, 1, 1, 1, 1, 1, 1
BIAS_SENSN, 0E, FF, 1, 1, 1, 1, 1, 1, 1, 1
LOFF_SENSP, 0F, 00, 0, 0, 0, 0, 0, 0, 0, 0
LOFF_SENSN, 10, 00, 0, 0, 0, 0, 0, 0, 0, 0
LOFF_FLIP, 11, 00, 0, 0, 0, 0, 0, 0, 0, 0
LOFF_STATP, 12, 00, 0, 0, 0, 0, 0, 0, 0, 0
LOFF_STATN, 13, 00, 0, 0, 0, 0, 0, 0, 0, 0
GPIO, 14, 0F, 0, 0, 0, 0, 1, 1, 1, 1
MISC1, 15, 00, 0, 0, 0, 0, 0, 0, 0, 0
MISC2, 16, 00, 0, 0, 0, 0, 0, 0, 0, 0
CONFIG4, 17, 00, 0, 0, 0, 0, 0, 0, 0, 0
`;var Is=ie.length+Ct.length;var Bs=ie.length+ht.length+Ct.length;var Os=ie.length+pt.length;var gs=ie.length+ht.length+pt.length;var $=.002/Math.pow(2,4);var sps9=250;var defaultsetting4={sps:sps9,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45};var ganglionFilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting4)),"1":JSON.parse(JSON.stringify(defaultsetting4)),"2":JSON.parse(JSON.stringify(defaultsetting4)),"3":JSON.parse(JSON.stringify(defaultsetting4))};var defaultChartSetting6={nSec:10,sps:sps9,units:"mV"};var ganglionChartSettings={lines:{"0":JSON.parse(JSON.stringify(defaultChartSetting6)),"1":JSON.parse(JSON.stringify(defaultChartSetting6)),"2":JSON.parse(JSON.stringify(defaultChartSetting6)),"3":JSON.parse(JSON.stringify(defaultChartSetting6)),"ax":{nSec:10,sps:sps9,units:"mg"},"ay":{nSec:10,sps:sps9,units:"mg"},"az":{nSec:10,sps:sps9,units:"mg"}},generateNewLines:true};var Tf=Object.create;var au=Object.defineProperty;var Mf=Object.getOwnPropertyDescriptor;var Cf=Object.getOwnPropertyNames;var If=Object.getPrototypeOf;var Nf=Object.prototype.hasOwnProperty;var c=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports);var Rf=(r,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Cf(t))!Nf.call(r,i)&&i!==e&&au(r,i,{get:()=>t[i],enumerable:!(n=Mf(t,i))||n.enumerable});return r};var kf=(r,t,e)=>(e=r!=null?Tf(If(r)):{},Rf(t||!r||!r.__esModule?au(e,"default",{value:r,enumerable:true}):e,r));var ue=c(tn2=>{"use strict";Object.defineProperty(tn2,"__esModule",{value:true});function Vf(r){return typeof r=="function"}tn2.isFunction=Vf});var Te=c(nn2=>{"use strict";Object.defineProperty(nn2,"__esModule",{value:true});var rn2=false;nn2.config={Promise:void 0,set useDeprecatedSynchronousErrorHandling(r){if(r){var t=new Error;console.warn(`DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: 
`+t.stack)}else rn2&&console.log("RxJS: Back to a better error behavior. Thank you. <3");rn2=r},get useDeprecatedSynchronousErrorHandling(){return rn2}}});var vr=c(on2=>{"use strict";Object.defineProperty(on2,"__esModule",{value:true});function Wf(r){setTimeout(function(){throw r},0)}on2.hostReportError=Wf});var sn2=c(un2=>{"use strict";Object.defineProperty(un2,"__esModule",{value:true});var Ff=Te(),Df=vr();un2.empty={closed:true,next:function(r){},error:function(r){if(Ff.config.useDeprecatedSynchronousErrorHandling)throw r;Df.hostReportError(r)},complete:function(){}}});var g=c(cn2=>{"use strict";Object.defineProperty(cn2,"__esModule",{value:true});cn2.isArray=function(){return Array.isArray||function(r){return r&&typeof r.length=="number"}}()});var dr=c(an2=>{"use strict";Object.defineProperty(an2,"__esModule",{value:true});function Uf(r){return r!==null&&typeof r=="object"}an2.isObject=Uf});var ln2=c(fn=>{"use strict";Object.defineProperty(fn,"__esModule",{value:true});var Bf=function(){function r(t){return Error.call(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(e,n){return n+1+") "+e.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t,this}return r.prototype=Object.create(Error.prototype),r}();fn.UnsubscriptionError=Bf});var O2=c(pn=>{"use strict";Object.defineProperty(pn,"__esModule",{value:true});var Lf=g(),zf=dr(),Gf=ue(),yr=ln2(),Yf=function(){function r(t){this.closed=false,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=true,this._unsubscribe=t)}return r.prototype.unsubscribe=function(){var t;if(!this.closed){var e=this,n=e._parentOrParents,i=e._ctorUnsubscribe,o=e._unsubscribe,u=e._subscriptions;if(this.closed=true,this._parentOrParents=null,this._subscriptions=null,n instanceof r)n.remove(this);else if(n!==null)for(var s=0;s<n.length;++s){var f=n[s];f.remove(this)}if(Gf.isFunction(o)){i&&(this._unsubscribe=void 0);try{o.call(this)}catch(b){t=b instanceof yr.UnsubscriptionError?fu(b.errors):[b]}}if(Lf.isArray(u))for(var s=-1,a=u.length;++s<a;){var p=u[s];if(zf.isObject(p))try{p.unsubscribe()}catch(v){t=t||[],v instanceof yr.UnsubscriptionError?t=t.concat(fu(v.errors)):t.push(v)}}if(t)throw new yr.UnsubscriptionError(t)}},r.prototype.add=function(t){var e=t;if(!t)return r.EMPTY;switch(typeof t){case"function":e=new r(t);case"object":if(e===this||e.closed||typeof e.unsubscribe!="function")return e;if(this.closed)return e.unsubscribe(),e;if(!(e instanceof r)){var n=e;e=new r,e._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var i=e._parentOrParents;if(i===null)e._parentOrParents=this;else if(i instanceof r){if(i===this)return e;e._parentOrParents=[i,this]}else if(i.indexOf(this)===-1)i.push(this);else return e;var o=this._subscriptions;return o===null?this._subscriptions=[e]:o.push(e),e},r.prototype.remove=function(t){var e=this._subscriptions;if(e){var n=e.indexOf(t);n!==-1&&e.splice(n,1)}},r.EMPTY=function(t){return t.closed=true,t}(new r),r}();pn.Subscription=Yf;function fu(r){return r.reduce(function(t,e){return t.concat(e instanceof yr.UnsubscriptionError?e.errors:e)},[])}});var mr=c(Me2=>{"use strict";Object.defineProperty(Me2,"__esModule",{value:true});Me2.rxSubscriber=function(){return typeof Symbol=="function"?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}();Me2.$$rxSubscriber=Me2.rxSubscriber});var _2=c(ce=>{"use strict";var pu=ce&&ce.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(ce,"__esModule",{value:true});var lu=ue(),hn2=sn2(),Qf=O2(),Hf=mr(),se=Te(),Sr=vr(),hu=function(r){pu(t,r);function t(e,n,i){var o=r.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=false,o.syncErrorThrowable=false,o.isStopped=false,arguments.length){case 0:o.destination=hn2.empty;break;case 1:if(!e){o.destination=hn2.empty;break}if(typeof e=="object"){e instanceof t?(o.syncErrorThrowable=e.syncErrorThrowable,o.destination=e,e.add(o)):(o.syncErrorThrowable=true,o.destination=new bn(o,e));break}default:o.syncErrorThrowable=true,o.destination=new bn(o,e,n,i);break}return o}return t.prototype[Hf.rxSubscriber]=function(){return this},t.create=function(e,n,i){var o=new t(e,n,i);return o.syncErrorThrowable=false,o},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=true,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=true,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=true,r.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=false,this.isStopped=false,this._parentOrParents=e,this},t}(Qf.Subscription);ce.Subscriber=hu;var bn=function(r){pu(t,r);function t(e,n,i,o){var u=r.call(this)||this;u._parentSubscriber=e;var s,f=u;return lu.isFunction(n)?s=n:n&&(s=n.next,i=n.error,o=n.complete,n!==hn2.empty&&(f=Object.create(n),lu.isFunction(f.unsubscribe)&&u.add(f.unsubscribe.bind(f)),f.unsubscribe=u.unsubscribe.bind(u))),u._context=f,u._next=s,u._error=i,u._complete=o,u}return t.prototype.next=function(e){if(!this.isStopped&&this._next){var n=this._parentSubscriber;!se.config.useDeprecatedSynchronousErrorHandling||!n.syncErrorThrowable?this.__tryOrUnsub(this._next,e):this.__tryOrSetError(n,this._next,e)&&this.unsubscribe()}},t.prototype.error=function(e){if(!this.isStopped){var n=this._parentSubscriber,i=se.config.useDeprecatedSynchronousErrorHandling;if(this._error)!i||!n.syncErrorThrowable?(this.__tryOrUnsub(this._error,e),this.unsubscribe()):(this.__tryOrSetError(n,this._error,e),this.unsubscribe());else if(n.syncErrorThrowable)i?(n.syncErrorValue=e,n.syncErrorThrown=true):Sr.hostReportError(e),this.unsubscribe();else{if(this.unsubscribe(),i)throw e;Sr.hostReportError(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var n=this._parentSubscriber;if(this._complete){var i=function(){return e._complete.call(e._context)};!se.config.useDeprecatedSynchronousErrorHandling||!n.syncErrorThrowable?(this.__tryOrUnsub(i),this.unsubscribe()):(this.__tryOrSetError(n,i),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,n){try{e.call(this._context,n)}catch(i){if(this.unsubscribe(),se.config.useDeprecatedSynchronousErrorHandling)throw i;Sr.hostReportError(i)}},t.prototype.__tryOrSetError=function(e,n,i){if(!se.config.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{n.call(this._context,i)}catch(o){return se.config.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=o,e.syncErrorThrown=true,true):(Sr.hostReportError(o),true)}return false},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(hu);ce.SafeSubscriber=bn});var Or=c(_n=>{"use strict";Object.defineProperty(_n,"__esModule",{value:true});var Kf=_2();function Jf(r){for(;r;){var t=r,e=t.closed,n=t.destination,i=t.isStopped;if(e||i)return false;n&&n instanceof Kf.Subscriber?r=n:r=null}return true}_n.canReportError=Jf});var _u=c(dn=>{"use strict";Object.defineProperty(dn,"__esModule",{value:true});var vn=_2(),bu=mr(),Zf=sn2();function $f(r,t,e){if(r){if(r instanceof vn.Subscriber)return r;if(r[bu.rxSubscriber])return r[bu.rxSubscriber]()}return!r&&!t&&!e?new vn.Subscriber(Zf.empty):new vn.Subscriber(r,t,e)}dn.toSubscriber=$f});var Y=c(yn=>{"use strict";Object.defineProperty(yn,"__esModule",{value:true});yn.observable=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}()});var V2=c(mn2=>{"use strict";Object.defineProperty(mn2,"__esModule",{value:true});function Xf(r){return r}mn2.identity=Xf});var gr=c(wr=>{"use strict";Object.defineProperty(wr,"__esModule",{value:true});var el=V2();function tl(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return vu(r)}wr.pipe=tl;function vu(r){return r.length===0?el.identity:r.length===1?r[0]:function(e){return r.reduce(function(n,i){return i(n)},e)}}wr.pipeFromArray=vu});var d2=c(Sn=>{"use strict";Object.defineProperty(Sn,"__esModule",{value:true});var rl=Or(),nl=_u(),il=Y(),ol=gr(),xr=Te(),ul2=function(){function r(t){this._isScalar=false,t&&(this._subscribe=t)}return r.prototype.lift=function(t){var e=new r;return e.source=this,e.operator=t,e},r.prototype.subscribe=function(t,e,n){var i=this.operator,o=nl.toSubscriber(t,e,n);if(i?o.add(i.call(o,this.source)):o.add(this.source||xr.config.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),xr.config.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=false,o.syncErrorThrown))throw o.syncErrorValue;return o},r.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){xr.config.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=true,t.syncErrorValue=e),rl.canReportError(t)?t.error(e):console.warn(e)}},r.prototype.forEach=function(t,e){var n=this;return e=du(e),new e(function(i,o){var u;u=n.subscribe(function(s){try{t(s)}catch(f){o(f),u&&u.unsubscribe()}},o,i)})},r.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},r.prototype[il.observable]=function(){return this},r.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.length===0?this:ol.pipeFromArray(t)(this)},r.prototype.toPromise=function(t){var e=this;return t=du(t),new t(function(n,i){var o;e.subscribe(function(u){return o=u},function(u){return i(u)},function(){return n(o)})})},r.create=function(t){return new r(t)},r}();Sn.Observable=ul2;function du(r){if(r||(r=xr.config.Promise||Promise),!r)throw new Error("no Promise impl found");return r}});var Ce=c(On=>{"use strict";Object.defineProperty(On,"__esModule",{value:true});var sl=function(){function r(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return r.prototype=Object.create(Error.prototype),r}();On.ObjectUnsubscribedError=sl});var wn=c(Ie2=>{"use strict";var cl=Ie2&&Ie2.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Ie2,"__esModule",{value:true});var al=O2(),fl2=function(r){cl(t,r);function t(e,n){var i=r.call(this)||this;return i.subject=e,i.subscriber=n,i.closed=false,i}return t.prototype.unsubscribe=function(){if(!this.closed){this.closed=true;var e=this.subject,n=e.observers;if(this.subject=null,!(!n||n.length===0||e.isStopped||e.closed)){var i=n.indexOf(this.subscriber);i!==-1&&n.splice(i,1)}}},t}(al.Subscription);Ie2.SubjectSubscription=fl2});var w2=c(Q2=>{"use strict";var qn=Q2&&Q2.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Q2,"__esModule",{value:true});var yu=d2(),ll=_2(),gn=O2(),Ne2=Ce(),pl2=wn(),hl2=mr(),mu=function(r){qn(t,r);function t(e){var n=r.call(this,e)||this;return n.destination=e,n}return t}(ll.Subscriber);Q2.SubjectSubscriber=mu;var Su=function(r){qn(t,r);function t(){var e=r.call(this)||this;return e.observers=[],e.closed=false,e.isStopped=false,e.hasError=false,e.thrownError=null,e}return t.prototype[hl2.rxSubscriber]=function(){return new mu(this)},t.prototype.lift=function(e){var n=new xn(this,this);return n.operator=e,n},t.prototype.next=function(e){if(this.closed)throw new Ne2.ObjectUnsubscribedError;if(!this.isStopped)for(var n=this.observers,i=n.length,o=n.slice(),u=0;u<i;u++)o[u].next(e)},t.prototype.error=function(e){if(this.closed)throw new Ne2.ObjectUnsubscribedError;this.hasError=true,this.thrownError=e,this.isStopped=true;for(var n=this.observers,i=n.length,o=n.slice(),u=0;u<i;u++)o[u].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new Ne2.ObjectUnsubscribedError;this.isStopped=true;for(var e=this.observers,n=e.length,i=e.slice(),o=0;o<n;o++)i[o].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=true,this.closed=true,this.observers=null},t.prototype._trySubscribe=function(e){if(this.closed)throw new Ne2.ObjectUnsubscribedError;return r.prototype._trySubscribe.call(this,e)},t.prototype._subscribe=function(e){if(this.closed)throw new Ne2.ObjectUnsubscribedError;return this.hasError?(e.error(this.thrownError),gn.Subscription.EMPTY):this.isStopped?(e.complete(),gn.Subscription.EMPTY):(this.observers.push(e),new pl2.SubjectSubscription(this,e))},t.prototype.asObservable=function(){var e=new yu.Observable;return e.source=this,e},t.create=function(e,n){return new xn(e,n)},t}(yu.Observable);Q2.Subject=Su;var xn=function(r){qn(t,r);function t(e,n){var i=r.call(this)||this;return i.destination=e,i.source=n,i}return t.prototype.next=function(e){var n=this.destination;n&&n.next&&n.next(e)},t.prototype.error=function(e){var n=this.destination;n&&n.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype._subscribe=function(e){var n=this.source;return n?this.source.subscribe(e):gn.Subscription.EMPTY},t}(Su);Q2.AnonymousSubject=xn});var qr=c(Re2=>{"use strict";var bl2=Re2&&Re2.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Re2,"__esModule",{value:true});var _l=_2();function vl(){return function(t){return t.lift(new dl2(t))}}Re2.refCount=vl;var dl2=function(){function r(t){this.connectable=t}return r.prototype.call=function(t,e){var n=this.connectable;n._refCount++;var i=new yl2(t,n),o=e.subscribe(i);return i.closed||(i.connection=n.connect()),o},r}(),yl2=function(r){bl2(t,r);function t(e,n){var i=r.call(this,e)||this;return i.connectable=n,i}return t.prototype._unsubscribe=function(){var e=this.connectable;if(!e){this.connection=null;return}this.connectable=null;var n=e._refCount;if(n<=0){this.connection=null;return}if(e._refCount=n-1,n>1){this.connection=null;return}var i=this.connection,o=e._connection;this.connection=null,o&&(!i||o===i)&&o.unsubscribe()},t}(_l.Subscriber)});var Pn=c(ae=>{"use strict";var jn=ae&&ae.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(ae,"__esModule",{value:true});var ml2=w2(),Sl2=d2(),Ol2=_2(),Ou=O2(),wl=qr(),wu=function(r){jn(t,r);function t(e,n){var i=r.call(this)||this;return i.source=e,i.subjectFactory=n,i._refCount=0,i._isComplete=false,i}return t.prototype._subscribe=function(e){return this.getSubject().subscribe(e)},t.prototype.getSubject=function(){var e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject},t.prototype.connect=function(){var e=this._connection;return e||(this._isComplete=false,e=this._connection=new Ou.Subscription,e.add(this.source.subscribe(new gl2(this.getSubject(),this))),e.closed&&(this._connection=null,e=Ou.Subscription.EMPTY)),e},t.prototype.refCount=function(){return wl.refCount()(this)},t}(Sl2.Observable);ae.ConnectableObservable=wu;ae.connectableObservableDescriptor=function(){var r=wu.prototype;return{operator:{value:null},_refCount:{value:0,writable:true},_subject:{value:null,writable:true},_connection:{value:null,writable:true},_subscribe:{value:r._subscribe},_isComplete:{value:r._isComplete,writable:true},getSubject:{value:r.getSubject},connect:{value:r.connect},refCount:{value:r.refCount}}}();var gl2=function(r){jn(t,r);function t(e,n){var i=r.call(this,e)||this;return i.connectable=n,i}return t.prototype._error=function(e){this._unsubscribe(),r.prototype._error.call(this,e)},t.prototype._complete=function(){this.connectable._isComplete=true,this._unsubscribe(),r.prototype._complete.call(this)},t.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var n=e._connection;e._refCount=0,e._subject=null,e._connection=null,n&&n.unsubscribe()}},t}(ml2.SubjectSubscriber),Rj=function(){function r(t){this.connectable=t}return r.prototype.call=function(t,e){var n=this.connectable;n._refCount++;var i=new xl2(t,n),o=e.subscribe(i);return i.closed||(i.connection=n.connect()),o},r}(),xl2=function(r){jn(t,r);function t(e,n){var i=r.call(this,e)||this;return i.connectable=n,i}return t.prototype._unsubscribe=function(){var e=this.connectable;if(!e){this.connection=null;return}this.connectable=null;var n=e._refCount;if(n<=0){this.connection=null;return}if(e._refCount=n-1,n>1){this.connection=null;return}var i=this.connection,o=e._connection;this.connection=null,o&&(!i||o===i)&&o.unsubscribe()},t}(Ol2.Subscriber)});var An=c(fe=>{"use strict";var jr=fe&&fe.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(fe,"__esModule",{value:true});var gu=_2(),xu=O2(),ql=d2(),jl=w2();function Pl2(r,t,e,n){return function(i){return i.lift(new El(r,t,e,n))}}fe.groupBy=Pl2;var El=function(){function r(t,e,n,i){this.keySelector=t,this.elementSelector=e,this.durationSelector=n,this.subjectSelector=i}return r.prototype.call=function(t,e){return e.subscribe(new Al(t,this.keySelector,this.elementSelector,this.durationSelector,this.subjectSelector))},r}(),Al=function(r){jr(t,r);function t(e,n,i,o,u){var s=r.call(this,e)||this;return s.keySelector=n,s.elementSelector=i,s.durationSelector=o,s.subjectSelector=u,s.groups=null,s.attemptedToUnsubscribe=false,s.count=0,s}return t.prototype._next=function(e){var n;try{n=this.keySelector(e)}catch(i){this.error(i);return}this._group(e,n)},t.prototype._group=function(e,n){var i=this.groups;i||(i=this.groups=new Map);var o=i.get(n),u;if(this.elementSelector)try{u=this.elementSelector(e)}catch(a){this.error(a)}else u=e;if(!o){o=this.subjectSelector?this.subjectSelector():new jl.Subject,i.set(n,o);var s=new En(n,o,this);if(this.destination.next(s),this.durationSelector){var f=void 0;try{f=this.durationSelector(new En(n,o))}catch(a){this.error(a);return}this.add(f.subscribe(new Tl(n,o,this)))}}o.closed||o.next(u)},t.prototype._error=function(e){var n=this.groups;n&&(n.forEach(function(i,o){i.error(e)}),n.clear()),this.destination.error(e)},t.prototype._complete=function(){var e=this.groups;e&&(e.forEach(function(n,i){n.complete()}),e.clear()),this.destination.complete()},t.prototype.removeGroup=function(e){this.groups.delete(e)},t.prototype.unsubscribe=function(){this.closed||(this.attemptedToUnsubscribe=true,this.count===0&&r.prototype.unsubscribe.call(this))},t}(gu.Subscriber),Tl=function(r){jr(t,r);function t(e,n,i){var o=r.call(this,n)||this;return o.key=e,o.group=n,o.parent=i,o}return t.prototype._next=function(e){this.complete()},t.prototype._unsubscribe=function(){var e=this,n=e.parent,i=e.key;this.key=this.parent=null,n&&n.removeGroup(i)},t}(gu.Subscriber),En=function(r){jr(t,r);function t(e,n,i){var o=r.call(this)||this;return o.key=e,o.groupSubject=n,o.refCountSubscription=i,o}return t.prototype._subscribe=function(e){var n=new xu.Subscription,i=this,o=i.refCountSubscription,u=i.groupSubject;return o&&!o.closed&&n.add(new Ml(o)),n.add(u.subscribe(e)),n},t}(ql.Observable);fe.GroupedObservable=En;var Ml=function(r){jr(t,r);function t(e){var n=r.call(this)||this;return n.parent=e,e.count++,n}return t.prototype.unsubscribe=function(){var e=this.parent;!e.closed&&!this.closed&&(r.prototype.unsubscribe.call(this),e.count-=1,e.count===0&&e.attemptedToUnsubscribe&&e.unsubscribe())},t}(xu.Subscription)});var Tn=c(ke=>{"use strict";var Cl2=ke&&ke.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(ke,"__esModule",{value:true});var Il2=w2(),Nl=Ce(),Rl=function(r){Cl2(t,r);function t(e){var n=r.call(this)||this;return n._value=e,n}return Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:true,configurable:true}),t.prototype._subscribe=function(e){var n=r.prototype._subscribe.call(this,e);return n&&!n.closed&&e.next(this._value),n},t.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new Nl.ObjectUnsubscribedError;return this._value},t.prototype.next=function(e){r.prototype.next.call(this,this._value=e)},t}(Il2.Subject);ke.BehaviorSubject=Rl});var qu=c(Ve=>{"use strict";var kl=Ve&&Ve.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Ve,"__esModule",{value:true});var Vl=O2(),Wl=function(r){kl(t,r);function t(e,n){return r.call(this)||this}return t.prototype.schedule=function(e,n){return n===void 0&&(n=0),this},t}(Vl.Subscription);Ve.Action=Wl});var le=c(We=>{"use strict";var Fl=We&&We.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(We,"__esModule",{value:true});var Dl=qu(),Ul=function(r){Fl(t,r);function t(e,n){var i=r.call(this,e,n)||this;return i.scheduler=e,i.work=n,i.pending=false,i}return t.prototype.schedule=function(e,n){if(n===void 0&&(n=0),this.closed)return this;this.state=e;var i=this.id,o=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(o,i,n)),this.pending=true,this.delay=n,this.id=this.id||this.requestAsyncId(o,this.id,n),this},t.prototype.requestAsyncId=function(e,n,i){return i===void 0&&(i=0),setInterval(e.flush.bind(e,this),i)},t.prototype.recycleAsyncId=function(e,n,i){if(i===void 0&&(i=0),i!==null&&this.delay===i&&this.pending===false)return n;clearInterval(n)},t.prototype.execute=function(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=false;var i=this._execute(e,n);if(i)return i;this.pending===false&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,n){var i=false,o=void 0;try{this.work(e)}catch(u){i=true,o=!!u&&u||new Error(u)}if(i)return this.unsubscribe(),o},t.prototype._unsubscribe=function(){var e=this.id,n=this.scheduler,i=n.actions,o=i.indexOf(this);this.work=null,this.state=null,this.pending=false,this.scheduler=null,o!==-1&&i.splice(o,1),e!=null&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null},t}(Dl.Action);We.AsyncAction=Ul});var ju=c(Fe2=>{"use strict";var Bl2=Fe2&&Fe2.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Fe2,"__esModule",{value:true});var Ll=le(),zl=function(r){Bl2(t,r);function t(e,n){var i=r.call(this,e,n)||this;return i.scheduler=e,i.work=n,i}return t.prototype.schedule=function(e,n){return n===void 0&&(n=0),n>0?r.prototype.schedule.call(this,e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)},t.prototype.execute=function(e,n){return n>0||this.closed?r.prototype.execute.call(this,e,n):this._execute(e,n)},t.prototype.requestAsyncId=function(e,n,i){return i===void 0&&(i=0),i!==null&&i>0||i===null&&this.delay>0?r.prototype.requestAsyncId.call(this,e,n,i):e.flush(this)},t}(Ll.AsyncAction);Fe2.QueueAction=zl});var Cn=c(Mn=>{"use strict";Object.defineProperty(Mn,"__esModule",{value:true});var Gl=function(){function r(t,e){e===void 0&&(e=r.now),this.SchedulerAction=t,this.now=e}return r.prototype.schedule=function(t,e,n){return e===void 0&&(e=0),new this.SchedulerAction(this,t).schedule(n,e)},r.now=function(){return Date.now()},r}();Mn.Scheduler=Gl});var pe=c(De=>{"use strict";var Yl=De&&De.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(De,"__esModule",{value:true});var Pu=Cn(),Ql=function(r){Yl(t,r);function t(e,n){n===void 0&&(n=Pu.Scheduler.now);var i=r.call(this,e,function(){return t.delegate&&t.delegate!==i?t.delegate.now():n()})||this;return i.actions=[],i.active=false,i.scheduled=void 0,i}return t.prototype.schedule=function(e,n,i){return n===void 0&&(n=0),t.delegate&&t.delegate!==this?t.delegate.schedule(e,n,i):r.prototype.schedule.call(this,e,n,i)},t.prototype.flush=function(e){var n=this.actions;if(this.active){n.push(e);return}var i;this.active=true;do if(i=e.execute(e.state,e.delay))break;while(e=n.shift());if(this.active=false,i){for(;e=n.shift();)e.unsubscribe();throw i}},t}(Pu.Scheduler);De.AsyncScheduler=Ql});var Eu=c(Ue=>{"use strict";var Hl=Ue&&Ue.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Ue,"__esModule",{value:true});var Kl=pe(),Jl=function(r){Hl(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t}(Kl.AsyncScheduler);Ue.QueueScheduler=Jl});var In=c(Be2=>{"use strict";Object.defineProperty(Be2,"__esModule",{value:true});var Zl=ju(),$l=Eu();Be2.queueScheduler=new $l.QueueScheduler(Zl.QueueAction);Be2.queue=Be2.queueScheduler});var P2=c(Le=>{"use strict";Object.defineProperty(Le,"__esModule",{value:true});var Au=d2();Le.EMPTY=new Au.Observable(function(r){return r.complete()});function Xl(r){return r?ep(r):Le.EMPTY}Le.empty=Xl;function ep(r){return new Au.Observable(function(t){return r.schedule(function(){return t.complete()})})}});var E=c(Nn=>{"use strict";Object.defineProperty(Nn,"__esModule",{value:true});function tp(r){return r&&typeof r.schedule=="function"}Nn.isScheduler=tp});var kn=c(Rn=>{"use strict";Object.defineProperty(Rn,"__esModule",{value:true});Rn.subscribeToArray=function(r){return function(t){for(var e=0,n=r.length;e<n&&!t.closed;e++)t.next(r[e]);t.complete()}}});var Pr=c(Vn=>{"use strict";Object.defineProperty(Vn,"__esModule",{value:true});var rp=d2(),np=O2();function ip(r,t){return new rp.Observable(function(e){var n=new np.Subscription,i=0;return n.add(t.schedule(function(){if(i===r.length){e.complete();return}e.next(r[i++]),e.closed||n.add(this.schedule())})),n})}Vn.scheduleArray=ip});var he=c(Wn=>{"use strict";Object.defineProperty(Wn,"__esModule",{value:true});var op=d2(),up=kn(),sp=Pr();function cp(r,t){return t?sp.scheduleArray(r,t):new op.Observable(up.subscribeToArray(r))}Wn.fromArray=cp});var ze=c(Fn=>{"use strict";Object.defineProperty(Fn,"__esModule",{value:true});var ap=E(),fp=he(),lp=Pr();function pp(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var e=r[r.length-1];return ap.isScheduler(e)?(r.pop(),lp.scheduleArray(r,e)):fp.fromArray(r)}Fn.of=pp});var Er=c(Dn=>{"use strict";Object.defineProperty(Dn,"__esModule",{value:true});var Tu=d2();function hp(r,t){return t?new Tu.Observable(function(e){return t.schedule(bp,0,{error:r,subscriber:e})}):new Tu.Observable(function(e){return e.error(r)})}Dn.throwError=hp;function bp(r){var t=r.error,e=r.subscriber;e.error(t)}});var Ye=c(Ge=>{"use strict";Object.defineProperty(Ge,"__esModule",{value:true});var _p=P2(),vp=ze(),dp=Er(),yp;(function(r){r.NEXT="N",r.ERROR="E",r.COMPLETE="C"})(yp=Ge.NotificationKind||(Ge.NotificationKind={}));var mp=function(){function r(t,e,n){this.kind=t,this.value=e,this.error=n,this.hasValue=t==="N"}return r.prototype.observe=function(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}},r.prototype.do=function(t,e,n){var i=this.kind;switch(i){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return n&&n()}},r.prototype.accept=function(t,e,n){return t&&typeof t.next=="function"?this.observe(t):this.do(t,e,n)},r.prototype.toObservable=function(){var t=this.kind;switch(t){case"N":return vp.of(this.value);case"E":return dp.throwError(this.error);case"C":return _p.empty()}throw new Error("unexpected notification kind value")},r.createNext=function(t){return typeof t<"u"?new r("N",t):r.undefinedValueNotification},r.createError=function(t){return new r("E",void 0,t)},r.createComplete=function(){return r.completeNotification},r.completeNotification=new r("C"),r.undefinedValueNotification=new r("N",void 0),r}();Ge.Notification=mp});var Bn=c(W2=>{"use strict";var Sp=W2&&W2.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(W2,"__esModule",{value:true});var Op=_2(),Un=Ye();function wp(r,t){return t===void 0&&(t=0),function(n){return n.lift(new Mu(r,t))}}W2.observeOn=wp;var Mu=function(){function r(t,e){e===void 0&&(e=0),this.scheduler=t,this.delay=e}return r.prototype.call=function(t,e){return e.subscribe(new Cu(t,this.scheduler,this.delay))},r}();W2.ObserveOnOperator=Mu;var Cu=function(r){Sp(t,r);function t(e,n,i){i===void 0&&(i=0);var o=r.call(this,e)||this;return o.scheduler=n,o.delay=i,o}return t.dispatch=function(e){var n=e.notification,i=e.destination;n.observe(i),this.unsubscribe()},t.prototype.scheduleMessage=function(e){var n=this.destination;n.add(this.scheduler.schedule(t.dispatch,this.delay,new Iu(e,this.destination)))},t.prototype._next=function(e){this.scheduleMessage(Un.Notification.createNext(e))},t.prototype._error=function(e){this.scheduleMessage(Un.Notification.createError(e)),this.unsubscribe()},t.prototype._complete=function(){this.scheduleMessage(Un.Notification.createComplete()),this.unsubscribe()},t}(Op.Subscriber);W2.ObserveOnSubscriber=Cu;var Iu=function(){function r(t,e){this.notification=t,this.destination=e}return r}();W2.ObserveOnMessage=Iu});var Ar=c(Qe=>{"use strict";var gp=Qe&&Qe.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Qe,"__esModule",{value:true});var xp=w2(),qp=In(),jp=O2(),Pp=Bn(),Ep=Ce(),Ap=wn(),Tp=function(r){gp(t,r);function t(e,n,i){e===void 0&&(e=Number.POSITIVE_INFINITY),n===void 0&&(n=Number.POSITIVE_INFINITY);var o=r.call(this)||this;return o.scheduler=i,o._events=[],o._infiniteTimeWindow=false,o._bufferSize=e<1?1:e,o._windowTime=n<1?1:n,n===Number.POSITIVE_INFINITY?(o._infiniteTimeWindow=true,o.next=o.nextInfiniteTimeWindow):o.next=o.nextTimeWindow,o}return t.prototype.nextInfiniteTimeWindow=function(e){if(!this.isStopped){var n=this._events;n.push(e),n.length>this._bufferSize&&n.shift()}r.prototype.next.call(this,e)},t.prototype.nextTimeWindow=function(e){this.isStopped||(this._events.push(new Mp(this._getNow(),e)),this._trimBufferThenGetEvents()),r.prototype.next.call(this,e)},t.prototype._subscribe=function(e){var n=this._infiniteTimeWindow,i=n?this._events:this._trimBufferThenGetEvents(),o=this.scheduler,u=i.length,s;if(this.closed)throw new Ep.ObjectUnsubscribedError;if(this.isStopped||this.hasError?s=jp.Subscription.EMPTY:(this.observers.push(e),s=new Ap.SubjectSubscription(this,e)),o&&e.add(e=new Pp.ObserveOnSubscriber(e,o)),n)for(var f=0;f<u&&!e.closed;f++)e.next(i[f]);else for(var f=0;f<u&&!e.closed;f++)e.next(i[f].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),s},t.prototype._getNow=function(){return(this.scheduler||qp.queue).now()},t.prototype._trimBufferThenGetEvents=function(){for(var e=this._getNow(),n=this._bufferSize,i=this._windowTime,o=this._events,u=o.length,s=0;s<u&&!(e-o[s].time<i);)s++;return u>n&&(s=Math.max(s,u-n)),s>0&&o.splice(0,s),o},t}(xp.Subject);Qe.ReplaySubject=Tp;var Mp=function(){function r(t,e){this.time=t,this.value=e}return r}()});var Ke=c(He=>{"use strict";var Cp=He&&He.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(He,"__esModule",{value:true});var Ip=w2(),Nu=O2(),Np=function(r){Cp(t,r);function t(){var e=r!==null&&r.apply(this,arguments)||this;return e.value=null,e.hasNext=false,e.hasCompleted=false,e}return t.prototype._subscribe=function(e){return this.hasError?(e.error(this.thrownError),Nu.Subscription.EMPTY):this.hasCompleted&&this.hasNext?(e.next(this.value),e.complete(),Nu.Subscription.EMPTY):r.prototype._subscribe.call(this,e)},t.prototype.next=function(e){this.hasCompleted||(this.value=e,this.hasNext=true)},t.prototype.error=function(e){this.hasCompleted||r.prototype.error.call(this,e)},t.prototype.complete=function(){this.hasCompleted=true,this.hasNext&&r.prototype.next.call(this,this.value),r.prototype.complete.call(this)},t}(Ip.Subject);He.AsyncSubject=Np});var ku=c(Mr=>{"use strict";Object.defineProperty(Mr,"__esModule",{value:true});var Rp=1,kp=function(){return Promise.resolve()}(),Tr={};function Ru(r){return r in Tr?(delete Tr[r],true):false}Mr.Immediate={setImmediate:function(r){var t=Rp++;return Tr[t]=true,kp.then(function(){return Ru(t)&&r()}),t},clearImmediate:function(r){Ru(r)}};Mr.TestTools={pending:function(){return Object.keys(Tr).length}}});var Wu=c(Je=>{"use strict";var Vp=Je&&Je.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Je,"__esModule",{value:true});var Vu=ku(),Wp=le(),Fp=function(r){Vp(t,r);function t(e,n){var i=r.call(this,e,n)||this;return i.scheduler=e,i.work=n,i}return t.prototype.requestAsyncId=function(e,n,i){return i===void 0&&(i=0),i!==null&&i>0?r.prototype.requestAsyncId.call(this,e,n,i):(e.actions.push(this),e.scheduled||(e.scheduled=Vu.Immediate.setImmediate(e.flush.bind(e,null))))},t.prototype.recycleAsyncId=function(e,n,i){if(i===void 0&&(i=0),i!==null&&i>0||i===null&&this.delay>0)return r.prototype.recycleAsyncId.call(this,e,n,i);e.actions.length===0&&(Vu.Immediate.clearImmediate(n),e.scheduled=void 0)},t}(Wp.AsyncAction);Je.AsapAction=Fp});var Fu=c(Ze=>{"use strict";var Dp=Ze&&Ze.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Ze,"__esModule",{value:true});var Up=pe(),Bp=function(r){Dp(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.flush=function(e){this.active=true,this.scheduled=void 0;var n=this.actions,i,o=-1,u=n.length;e=e||n.shift();do if(i=e.execute(e.state,e.delay))break;while(++o<u&&(e=n.shift()));if(this.active=false,i){for(;++o<u&&(e=n.shift());)e.unsubscribe();throw i}},t}(Up.AsyncScheduler);Ze.AsapScheduler=Bp});var Ln=c($e=>{"use strict";Object.defineProperty($e,"__esModule",{value:true});var Lp=Wu(),zp=Fu();$e.asapScheduler=new zp.AsapScheduler(Lp.AsapAction);$e.asap=$e.asapScheduler});var x=c(Xe=>{"use strict";Object.defineProperty(Xe,"__esModule",{value:true});var Gp=le(),Yp=pe();Xe.asyncScheduler=new Yp.AsyncScheduler(Gp.AsyncAction);Xe.async=Xe.asyncScheduler});var Du=c(et=>{"use strict";var Qp=et&&et.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(et,"__esModule",{value:true});var Hp=le(),Kp=function(r){Qp(t,r);function t(e,n){var i=r.call(this,e,n)||this;return i.scheduler=e,i.work=n,i}return t.prototype.requestAsyncId=function(e,n,i){return i===void 0&&(i=0),i!==null&&i>0?r.prototype.requestAsyncId.call(this,e,n,i):(e.actions.push(this),e.scheduled||(e.scheduled=requestAnimationFrame(function(){return e.flush(null)})))},t.prototype.recycleAsyncId=function(e,n,i){if(i===void 0&&(i=0),i!==null&&i>0||i===null&&this.delay>0)return r.prototype.recycleAsyncId.call(this,e,n,i);e.actions.length===0&&(cancelAnimationFrame(n),e.scheduled=void 0)},t}(Hp.AsyncAction);et.AnimationFrameAction=Kp});var Uu=c(tt=>{"use strict";var Jp=tt&&tt.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(tt,"__esModule",{value:true});var Zp=pe(),$p=function(r){Jp(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.flush=function(e){this.active=true,this.scheduled=void 0;var n=this.actions,i,o=-1,u=n.length;e=e||n.shift();do if(i=e.execute(e.state,e.delay))break;while(++o<u&&(e=n.shift()));if(this.active=false,i){for(;++o<u&&(e=n.shift());)e.unsubscribe();throw i}},t}(Zp.AsyncScheduler);tt.AnimationFrameScheduler=$p});var Bu=c(rt=>{"use strict";Object.defineProperty(rt,"__esModule",{value:true});var Xp=Du(),eh=Uu();rt.animationFrameScheduler=new eh.AnimationFrameScheduler(Xp.AnimationFrameAction);rt.animationFrame=rt.animationFrameScheduler});var Gu=c(be2=>{"use strict";var Lu=be2&&be2.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(be2,"__esModule",{value:true});var th=le(),rh=pe(),nh=function(r){Lu(t,r);function t(e,n){e===void 0&&(e=zu),n===void 0&&(n=Number.POSITIVE_INFINITY);var i=r.call(this,e,function(){return i.frame})||this;return i.maxFrames=n,i.frame=0,i.index=-1,i}return t.prototype.flush=function(){for(var e=this,n=e.actions,i=e.maxFrames,o,u;(u=n[0])&&u.delay<=i&&(n.shift(),this.frame=u.delay,!(o=u.execute(u.state,u.delay))););if(o){for(;u=n.shift();)u.unsubscribe();throw o}},t.frameTimeFactor=10,t}(rh.AsyncScheduler);be2.VirtualTimeScheduler=nh;var zu=function(r){Lu(t,r);function t(e,n,i){i===void 0&&(i=e.index+=1);var o=r.call(this,e,n)||this;return o.scheduler=e,o.work=n,o.index=i,o.active=true,o.index=e.index=i,o}return t.prototype.schedule=function(e,n){if(n===void 0&&(n=0),!this.id)return r.prototype.schedule.call(this,e,n);this.active=false;var i=new t(this.scheduler,this.work);return this.add(i),i.schedule(e,n)},t.prototype.requestAsyncId=function(e,n,i){i===void 0&&(i=0),this.delay=e.frame+i;var o=e.actions;return o.push(this),o.sort(t.sortActions),true},t.prototype.recycleAsyncId=function(e,n,i){i===void 0&&(i=0)},t.prototype._execute=function(e,n){if(this.active===true)return r.prototype._execute.call(this,e,n)},t.sortActions=function(e,n){return e.delay===n.delay?e.index===n.index?0:e.index>n.index?1:-1:e.delay>n.delay?1:-1},t}(th.AsyncAction);be2.VirtualAction=zu});var Cr=c(zn=>{"use strict";Object.defineProperty(zn,"__esModule",{value:true});function ih(){}zn.noop=ih});var Yu=c(Gn=>{"use strict";Object.defineProperty(Gn,"__esModule",{value:true});var oh=d2();function uh(r){return!!r&&(r instanceof oh.Observable||typeof r.lift=="function"&&typeof r.subscribe=="function")}Gn.isObservable=uh});var _e2=c(Yn=>{"use strict";Object.defineProperty(Yn,"__esModule",{value:true});var sh=function(){function r(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return r.prototype=Object.create(Error.prototype),r}();Yn.ArgumentOutOfRangeError=sh});var ve2=c(Qn=>{"use strict";Object.defineProperty(Qn,"__esModule",{value:true});var ch=function(){function r(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return r.prototype=Object.create(Error.prototype),r}();Qn.EmptyError=ch});var Kn=c(Hn=>{"use strict";Object.defineProperty(Hn,"__esModule",{value:true});var ah=function(){function r(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return r.prototype=Object.create(Error.prototype),r}();Hn.TimeoutError=ah});var j=c(de=>{"use strict";var fh=de&&de.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(de,"__esModule",{value:true});var lh=_2();function ph(r,t){return function(n){if(typeof r!="function")throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new Qu(r,t))}}de.map=ph;var Qu=function(){function r(t,e){this.project=t,this.thisArg=e}return r.prototype.call=function(t,e){return e.subscribe(new hh(t,this.project,this.thisArg))},r}();de.MapOperator=Qu;var hh=function(r){fh(t,r);function t(e,n,i){var o=r.call(this,e)||this;return o.project=n,o.count=0,o.thisArg=i||o,o}return t.prototype._next=function(e){var n;try{n=this.project.call(this.thisArg,e,this.count++)}catch(i){this.destination.error(i);return}this.destination.next(n)},t}(lh.Subscriber)});var Ju=c(Jn=>{"use strict";Object.defineProperty(Jn,"__esModule",{value:true});var bh=d2(),Hu=Ke(),_h=j(),vh=Or(),dh=g(),yh=E();function Ku(r,t,e){if(t)if(yh.isScheduler(t))e=t;else return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return Ku(r,e).apply(void 0,n).pipe(_h.map(function(o){return dh.isArray(o)?t.apply(void 0,o):t(o)}))};return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var o=this,u,s={context:o,subject:u,callbackFunc:r,scheduler:e};return new bh.Observable(function(f){if(e){var p={args:n,subscriber:f,params:s};return e.schedule(mh,0,p)}else{if(!u){u=new Hu.AsyncSubject;var a=function(){for(var b=[],v=0;v<arguments.length;v++)b[v]=arguments[v];u.next(b.length<=1?b[0]:b),u.complete()};try{r.apply(o,n.concat([a]))}catch(b){vh.canReportError(u)?u.error(b):console.warn(b)}}return u.subscribe(f)}})}}Jn.bindCallback=Ku;function mh(r){var t=this,e=this,n=r.args,i=r.subscriber,o=r.params,u=o.callbackFunc,s=o.context,f=o.scheduler,a=o.subject;if(!a){a=o.subject=new Hu.AsyncSubject;var p=function(){for(var b=[],v=0;v<arguments.length;v++)b[v]=arguments[v];var q2=b.length<=1?b[0]:b;t.add(f.schedule(Sh,0,{value:q2,subject:a}))};try{u.apply(s,n.concat([p]))}catch(b){a.error(b)}}this.add(a.subscribe(i))}function Sh(r){var t=r.value,e=r.subject;e.next(t),e.complete()}});var es=c(Zn=>{"use strict";Object.defineProperty(Zn,"__esModule",{value:true});var Oh=d2(),$u=Ke(),wh=j(),gh=Or(),xh=E(),qh=g();function Xu(r,t,e){if(t)if(xh.isScheduler(t))e=t;else return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return Xu(r,e).apply(void 0,n).pipe(wh.map(function(o){return qh.isArray(o)?t.apply(void 0,o):t(o)}))};return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var o={subject:void 0,args:n,callbackFunc:r,scheduler:e,context:this};return new Oh.Observable(function(u){var s=o.context,f=o.subject;if(e)return e.schedule(jh,0,{params:o,subscriber:u,context:s});if(!f){f=o.subject=new $u.AsyncSubject;var a=function(){for(var p=[],b=0;b<arguments.length;b++)p[b]=arguments[b];var v=p.shift();if(v){f.error(v);return}f.next(p.length<=1?p[0]:p),f.complete()};try{r.apply(s,n.concat([a]))}catch(p){gh.canReportError(f)?f.error(p):console.warn(p)}}return f.subscribe(u)})}}Zn.bindNodeCallback=Xu;function jh(r){var t=this,e=r.params,n=r.subscriber,i=r.context,o=e.callbackFunc,u=e.args,s=e.scheduler,f=e.subject;if(!f){f=e.subject=new $u.AsyncSubject;var a=function(){for(var p=[],b=0;b<arguments.length;b++)p[b]=arguments[b];var v=p.shift();if(v)t.add(s.schedule(Zu,0,{err:v,subject:f}));else{var q2=p.length<=1?p[0]:p;t.add(s.schedule(Ph,0,{value:q2,subject:f}))}};try{o.apply(i,u.concat([a]))}catch(p){this.add(s.schedule(Zu,0,{err:p,subject:f}))}}this.add(f.subscribe(n))}function Ph(r){var t=r.value,e=r.subject;e.next(t),e.complete()}function Zu(r){var t=r.err,e=r.subject;e.error(t)}});var F2=c(nt=>{"use strict";var Eh=nt&&nt.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(nt,"__esModule",{value:true});var Ah=_2(),Th=function(r){Eh(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.notifyNext=function(e,n,i,o,u){this.destination.next(n)},t.prototype.notifyError=function(e,n){this.destination.error(e)},t.prototype.notifyComplete=function(e){this.destination.complete()},t}(Ah.Subscriber);nt.OuterSubscriber=Th});var ts=c(it=>{"use strict";var Mh=it&&it.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(it,"__esModule",{value:true});var Ch=_2(),Ih=function(r){Mh(t,r);function t(e,n,i){var o=r.call(this)||this;return o.parent=e,o.outerValue=n,o.outerIndex=i,o.index=0,o}return t.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)},t.prototype._error=function(e){this.parent.notifyError(e,this),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},t}(Ch.Subscriber);it.InnerSubscriber=Ih});var rs=c($n=>{"use strict";Object.defineProperty($n,"__esModule",{value:true});var Nh=vr();$n.subscribeToPromise=function(r){return function(t){return r.then(function(e){t.closed||(t.next(e),t.complete())},function(e){return t.error(e)}).then(null,Nh.hostReportError),t}}});var me=c(ye2=>{"use strict";Object.defineProperty(ye2,"__esModule",{value:true});function ns(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}ye2.getSymbolIterator=ns;ye2.iterator=ns();ye2.$$iterator=ye2.iterator});var is=c(Xn=>{"use strict";Object.defineProperty(Xn,"__esModule",{value:true});var Rh=me();Xn.subscribeToIterable=function(r){return function(t){var e=r[Rh.iterator]();do{var n=void 0;try{n=e.next()}catch(i){return t.error(i),t}if(n.done){t.complete();break}if(t.next(n.value),t.closed)break}while(true);return typeof e.return=="function"&&t.add(function(){e.return&&e.return()}),t}}});var os=c(ei=>{"use strict";Object.defineProperty(ei,"__esModule",{value:true});var kh=Y();ei.subscribeToObservable=function(r){return function(t){var e=r[kh.observable]();if(typeof e.subscribe!="function")throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)}}});var ri=c(ti=>{"use strict";Object.defineProperty(ti,"__esModule",{value:true});ti.isArrayLike=function(r){return r&&typeof r.length=="number"&&typeof r!="function"}});var ii=c(ni=>{"use strict";Object.defineProperty(ni,"__esModule",{value:true});function Vh(r){return!!r&&typeof r.subscribe!="function"&&typeof r.then=="function"}ni.isPromise=Vh});var ot=c(oi=>{"use strict";Object.defineProperty(oi,"__esModule",{value:true});var Wh=kn(),Fh=rs(),Dh=is(),Uh=os(),Bh=ri(),Lh=ii(),zh=dr(),Gh=me(),Yh=Y();oi.subscribeTo=function(r){if(!!r&&typeof r[Yh.observable]=="function")return Uh.subscribeToObservable(r);if(Bh.isArrayLike(r))return Wh.subscribeToArray(r);if(Lh.isPromise(r))return Fh.subscribeToPromise(r);if(!!r&&typeof r[Gh.iterator]=="function")return Dh.subscribeToIterable(r);var t=zh.isObject(r)?"an invalid object":"'"+r+"'",e="You provided "+t+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.";throw new TypeError(e)}});var D2=c(ui=>{"use strict";Object.defineProperty(ui,"__esModule",{value:true});var Qh=ts(),Hh=ot(),Kh=d2();function Jh(r,t,e,n,i){if(i===void 0&&(i=new Qh.InnerSubscriber(r,e,n)),!i.closed)return t instanceof Kh.Observable?t.subscribe(i):Hh.subscribeTo(t)(i)}ui.subscribeToResult=Jh});var Ir=c(H2=>{"use strict";var Zh=H2&&H2.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(H2,"__esModule",{value:true});var $h=E(),Xh=g(),eb=F2(),tb=D2(),rb=he(),us={};function nb(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var e=void 0,n=void 0;return $h.isScheduler(r[r.length-1])&&(n=r.pop()),typeof r[r.length-1]=="function"&&(e=r.pop()),r.length===1&&Xh.isArray(r[0])&&(r=r[0]),rb.fromArray(r,n).lift(new ss(e))}H2.combineLatest=nb;var ss=function(){function r(t){this.resultSelector=t}return r.prototype.call=function(t,e){return e.subscribe(new cs(t,this.resultSelector))},r}();H2.CombineLatestOperator=ss;var cs=function(r){Zh(t,r);function t(e,n){var i=r.call(this,e)||this;return i.resultSelector=n,i.active=0,i.values=[],i.observables=[],i}return t.prototype._next=function(e){this.values.push(us),this.observables.push(e)},t.prototype._complete=function(){var e=this.observables,n=e.length;if(n===0)this.destination.complete();else{this.active=n,this.toRespond=n;for(var i=0;i<n;i++){var o=e[i];this.add(tb.subscribeToResult(this,o,void 0,i))}}},t.prototype.notifyComplete=function(e){(this.active-=1)===0&&this.destination.complete()},t.prototype.notifyNext=function(e,n,i){var o=this.values,u=o[i],s=this.toRespond?u===us?--this.toRespond:this.toRespond:0;o[i]=n,s===0&&(this.resultSelector?this._tryResultSelector(o):this.destination.next(o.slice()))},t.prototype._tryResultSelector=function(e){var n;try{n=this.resultSelector.apply(this,e)}catch(i){this.destination.error(i);return}this.destination.next(n)},t}(eb.OuterSubscriber);H2.CombineLatestSubscriber=cs});var as=c(si=>{"use strict";Object.defineProperty(si,"__esModule",{value:true});var ib=d2(),ob=O2(),ub=Y();function sb(r,t){return new ib.Observable(function(e){var n=new ob.Subscription;return n.add(t.schedule(function(){var i=r[ub.observable]();n.add(i.subscribe({next:function(o){n.add(t.schedule(function(){return e.next(o)}))},error:function(o){n.add(t.schedule(function(){return e.error(o)}))},complete:function(){n.add(t.schedule(function(){return e.complete()}))}}))})),n})}si.scheduleObservable=sb});var fs=c(ci=>{"use strict";Object.defineProperty(ci,"__esModule",{value:true});var cb=d2(),ab=O2();function fb(r,t){return new cb.Observable(function(e){var n=new ab.Subscription;return n.add(t.schedule(function(){return r.then(function(i){n.add(t.schedule(function(){e.next(i),n.add(t.schedule(function(){return e.complete()}))}))},function(i){n.add(t.schedule(function(){return e.error(i)}))})})),n})}ci.schedulePromise=fb});var ls=c(ai=>{"use strict";Object.defineProperty(ai,"__esModule",{value:true});var lb=d2(),pb=O2(),hb=me();function bb(r,t){if(!r)throw new Error("Iterable cannot be null");return new lb.Observable(function(e){var n=new pb.Subscription,i;return n.add(function(){i&&typeof i.return=="function"&&i.return()}),n.add(t.schedule(function(){i=r[hb.iterator](),n.add(t.schedule(function(){if(!e.closed){var o,u;try{var s=i.next();o=s.value,u=s.done}catch(f){e.error(f);return}u?e.complete():(e.next(o),this.schedule())}}))})),n})}ai.scheduleIterable=bb});var ps=c(fi=>{"use strict";Object.defineProperty(fi,"__esModule",{value:true});var _b=Y();function vb(r){return r&&typeof r[_b.observable]=="function"}fi.isInteropObservable=vb});var hs=c(li=>{"use strict";Object.defineProperty(li,"__esModule",{value:true});var db=me();function yb(r){return r&&typeof r[db.iterator]=="function"}li.isIterable=yb});var hi=c(pi=>{"use strict";Object.defineProperty(pi,"__esModule",{value:true});var mb=as(),Sb=fs(),Ob=Pr(),wb=ls(),gb=ps(),xb=ii(),qb=ri(),jb=hs();function Pb(r,t){if(r!=null){if(gb.isInteropObservable(r))return mb.scheduleObservable(r,t);if(xb.isPromise(r))return Sb.schedulePromise(r,t);if(qb.isArrayLike(r))return Ob.scheduleArray(r,t);if(jb.isIterable(r)||typeof r=="string")return wb.scheduleIterable(r,t)}throw new TypeError((r!==null&&typeof r||r)+" is not observable")}pi.scheduled=Pb});var A=c(bi=>{"use strict";Object.defineProperty(bi,"__esModule",{value:true});var bs=d2(),Eb=ot(),Ab=hi();function Tb(r,t){return t?Ab.scheduled(r,t):r instanceof bs.Observable?r:new bs.Observable(Eb.subscribeTo(r))}bi.from=Tb});var y=c(N=>{"use strict";var Nr=N&&N.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(N,"__esModule",{value:true});var Rr=_2(),Mb=d2(),Cb=ot(),Ib=function(r){Nr(t,r);function t(e){var n=r.call(this)||this;return n.parent=e,n}return t.prototype._next=function(e){this.parent.notifyNext(e)},t.prototype._error=function(e){this.parent.notifyError(e),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},t}(Rr.Subscriber);N.SimpleInnerSubscriber=Ib;var Nb=function(r){Nr(t,r);function t(e,n,i){var o=r.call(this)||this;return o.parent=e,o.outerValue=n,o.outerIndex=i,o}return t.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this)},t.prototype._error=function(e){this.parent.notifyError(e),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},t}(Rr.Subscriber);N.ComplexInnerSubscriber=Nb;var Rb=function(r){Nr(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyError=function(e){this.destination.error(e)},t.prototype.notifyComplete=function(){this.destination.complete()},t}(Rr.Subscriber);N.SimpleOuterSubscriber=Rb;var kb=function(r){Nr(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.notifyNext=function(e,n,i,o){this.destination.next(n)},t.prototype.notifyError=function(e){this.destination.error(e)},t.prototype.notifyComplete=function(e){this.destination.complete()},t}(Rr.Subscriber);N.ComplexOuterSubscriber=kb;function Vb(r,t){if(!t.closed){if(r instanceof Mb.Observable)return r.subscribe(t);var e;try{e=Cb.subscribeTo(r)(t)}catch(n){t.error(n)}return e}}N.innerSubscribe=Vb});var ut=c(U=>{"use strict";var Wb=U&&U.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(U,"__esModule",{value:true});var Fb=j(),Db=A(),_i=y();function vi(r,t,e){return e===void 0&&(e=Number.POSITIVE_INFINITY),typeof t=="function"?function(n){return n.pipe(vi(function(i,o){return Db.from(r(i,o)).pipe(Fb.map(function(u,s){return t(i,u,o,s)}))},e))}:(typeof t=="number"&&(e=t),function(n){return n.lift(new _s(r,e))})}U.mergeMap=vi;var _s=function(){function r(t,e){e===void 0&&(e=Number.POSITIVE_INFINITY),this.project=t,this.concurrent=e}return r.prototype.call=function(t,e){return e.subscribe(new vs(t,this.project,this.concurrent))},r}();U.MergeMapOperator=_s;var vs=function(r){Wb(t,r);function t(e,n,i){i===void 0&&(i=Number.POSITIVE_INFINITY);var o=r.call(this,e)||this;return o.project=n,o.concurrent=i,o.hasCompleted=false,o.buffer=[],o.active=0,o.index=0,o}return t.prototype._next=function(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)},t.prototype._tryNext=function(e){var n,i=this.index++;try{n=this.project(e,i)}catch(o){this.destination.error(o);return}this.active++,this._innerSub(n)},t.prototype._innerSub=function(e){var n=new _i.SimpleInnerSubscriber(this),i=this.destination;i.add(n);var o=_i.innerSubscribe(e,n);o!==n&&i.add(o)},t.prototype._complete=function(){this.hasCompleted=true,this.active===0&&this.buffer.length===0&&this.destination.complete(),this.unsubscribe()},t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyComplete=function(){var e=this.buffer;this.active--,e.length>0?this._next(e.shift()):this.active===0&&this.hasCompleted&&this.destination.complete()},t}(_i.SimpleOuterSubscriber);U.MergeMapSubscriber=vs;U.flatMap=vi});var kr=c(di=>{"use strict";Object.defineProperty(di,"__esModule",{value:true});var Ub=ut(),Bb=V2();function Lb(r){return r===void 0&&(r=Number.POSITIVE_INFINITY),Ub.mergeMap(Bb.identity,r)}di.mergeAll=Lb});var mi=c(yi=>{"use strict";Object.defineProperty(yi,"__esModule",{value:true});var zb=kr();function Gb(){return zb.mergeAll(1)}yi.concatAll=Gb});var st=c(Si=>{"use strict";Object.defineProperty(Si,"__esModule",{value:true});var Yb=ze(),Qb=mi();function Hb(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return Qb.concatAll()(Yb.of.apply(void 0,r))}Si.concat=Hb});var Vr=c(Oi=>{"use strict";Object.defineProperty(Oi,"__esModule",{value:true});var Kb=d2(),Jb=A(),Zb=P2();function $b(r){return new Kb.Observable(function(t){var e;try{e=r()}catch(i){t.error(i);return}var n=e?Jb.from(e):Zb.empty();return n.subscribe(t)})}Oi.defer=$b});var ys=c(wi=>{"use strict";Object.defineProperty(wi,"__esModule",{value:true});var Xb=d2(),ds=g(),e_=j(),t_=dr(),r_=A();function n_(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];if(r.length===1){var e=r[0];if(ds.isArray(e))return Wr(e,null);if(t_.isObject(e)&&Object.getPrototypeOf(e)===Object.prototype){var n=Object.keys(e);return Wr(n.map(function(o){return e[o]}),n)}}if(typeof r[r.length-1]=="function"){var i=r.pop();return r=r.length===1&&ds.isArray(r[0])?r[0]:r,Wr(r,null).pipe(e_.map(function(o){return i.apply(void 0,o)}))}return Wr(r,null)}wi.forkJoin=n_;function Wr(r,t){return new Xb.Observable(function(e){var n=r.length;if(n===0){e.complete();return}for(var i=new Array(n),o=0,u=0,s=function(a){var p=r_.from(r[a]),b=false;e.add(p.subscribe({next:function(v){b||(b=true,u++),i[a]=v},error:function(v){return e.error(v)},complete:function(){o++,(o===n||!b)&&(u===n&&e.next(t?t.reduce(function(v,q2,I){return v[q2]=i[I],v},{}):i),e.complete())}}))},f=0;f<n;f++)s(f)})}});var Os2=c(gi=>{"use strict";Object.defineProperty(gi,"__esModule",{value:true});var i_=d2(),o_=g(),u_=ue(),s_=j(),G0=function(){return Object.prototype.toString}();function ms(r,t,e,n){return u_.isFunction(e)&&(n=e,e=void 0),n?ms(r,t,e).pipe(s_.map(function(i){return o_.isArray(i)?n.apply(void 0,i):n(i)})):new i_.Observable(function(i){function o(u){arguments.length>1?i.next(Array.prototype.slice.call(arguments)):i.next(u)}Ss(r,t,o,i,e)})}gi.fromEvent=ms;function Ss(r,t,e,n,i){var o;if(f_(r)){var u=r;r.addEventListener(t,e,i),o=function(){return u.removeEventListener(t,e,i)}}else if(a_(r)){var s=r;r.on(t,e),o=function(){return s.off(t,e)}}else if(c_(r)){var f=r;r.addListener(t,e),o=function(){return f.removeListener(t,e)}}else if(r&&r.length)for(var a=0,p=r.length;a<p;a++)Ss(r[a],t,e,n,i);else throw new TypeError("Invalid event target");n.add(o)}function c_(r){return r&&typeof r.addListener=="function"&&typeof r.removeListener=="function"}function a_(r){return r&&typeof r.on=="function"&&typeof r.off=="function"}function f_(r){return r&&typeof r.addEventListener=="function"&&typeof r.removeEventListener=="function"}});var gs2=c(xi=>{"use strict";Object.defineProperty(xi,"__esModule",{value:true});var l_=d2(),p_=g(),h_=ue(),b_=j();function ws(r,t,e){return e?ws(r,t).pipe(b_.map(function(n){return p_.isArray(n)?e.apply(void 0,n):e(n)})):new l_.Observable(function(n){var i=function(){for(var u=[],s=0;s<arguments.length;s++)u[s]=arguments[s];return n.next(u.length===1?u[0]:u)},o;try{o=r(i)}catch(u){n.error(u);return}if(!!h_.isFunction(t))return function(){return t(i,o)}})}xi.fromEventPattern=ws});var qs=c(qi=>{"use strict";Object.defineProperty(qi,"__esModule",{value:true});var __=d2(),xs=V2(),v_=E();function d_(r,t,e,n,i){var o,u;if(arguments.length==1){var s=r;u=s.initialState,t=s.condition,e=s.iterate,o=s.resultSelector||xs.identity,i=s.scheduler}else n===void 0||v_.isScheduler(n)?(u=r,o=xs.identity,i=n):(u=r,o=n);return new __.Observable(function(f){var a=u;if(i)return i.schedule(y_,0,{subscriber:f,iterate:e,condition:t,resultSelector:o,state:a});do{if(t){var p=void 0;try{p=t(a)}catch(v){f.error(v);return}if(!p){f.complete();break}}var b=void 0;try{b=o(a)}catch(v){f.error(v);return}if(f.next(b),f.closed)break;try{a=e(a)}catch(v){f.error(v);return}}while(true)})}qi.generate=d_;function y_(r){var t=r.subscriber,e=r.condition;if(!t.closed){if(r.needIterate)try{r.state=r.iterate(r.state)}catch(o){t.error(o);return}else r.needIterate=true;if(e){var n=void 0;try{n=e(r.state)}catch(o){t.error(o);return}if(!n){t.complete();return}if(t.closed)return}var i;try{i=r.resultSelector(r.state)}catch(o){t.error(o);return}if(!t.closed&&(t.next(i),!t.closed))return this.schedule(r)}}});var Ps=c(ji=>{"use strict";Object.defineProperty(ji,"__esModule",{value:true});var m_=Vr(),js=P2();function S_(r,t,e){return t===void 0&&(t=js.EMPTY),e===void 0&&(e=js.EMPTY),m_.defer(function(){return r()?t:e})}ji.iif=S_});var ct=c(Pi=>{"use strict";Object.defineProperty(Pi,"__esModule",{value:true});var O_=g();function w_(r){return!O_.isArray(r)&&r-parseFloat(r)+1>=0}Pi.isNumeric=w_});var As=c(Ei=>{"use strict";Object.defineProperty(Ei,"__esModule",{value:true});var g_=d2(),Es=x(),x_=ct();function q_(r,t){return r===void 0&&(r=0),t===void 0&&(t=Es.async),(!x_.isNumeric(r)||r<0)&&(r=0),(!t||typeof t.schedule!="function")&&(t=Es.async),new g_.Observable(function(e){return e.add(t.schedule(j_,r,{subscriber:e,counter:0,period:r})),e})}Ei.interval=q_;function j_(r){var t=r.subscriber,e=r.counter,n=r.period;t.next(e),this.schedule({subscriber:t,counter:e+1,period:n},n)}});var Ti=c(Ai=>{"use strict";Object.defineProperty(Ai,"__esModule",{value:true});var P_=d2(),E_=E(),A_=kr(),T_=he();function M_(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var e=Number.POSITIVE_INFINITY,n=null,i=r[r.length-1];return E_.isScheduler(i)?(n=r.pop(),r.length>1&&typeof r[r.length-1]=="number"&&(e=r.pop())):typeof i=="number"&&(e=r.pop()),n===null&&r.length===1&&r[0]instanceof P_.Observable?r[0]:A_.mergeAll(e)(T_.fromArray(r,n))}Ai.merge=M_});var Mi=c(at=>{"use strict";Object.defineProperty(at,"__esModule",{value:true});var C_=d2(),I_=Cr();at.NEVER=new C_.Observable(I_.noop);function N_(){return at.NEVER}at.never=N_});var Ts=c(Ii=>{"use strict";Object.defineProperty(Ii,"__esModule",{value:true});var R_=d2(),k_=A(),V_=g(),W_=P2();function Ci(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];if(r.length===0)return W_.EMPTY;var e=r[0],n=r.slice(1);return r.length===1&&V_.isArray(e)?Ci.apply(void 0,e):new R_.Observable(function(i){var o=function(){return i.add(Ci.apply(void 0,n).subscribe(i))};return k_.from(e).subscribe({next:function(u){i.next(u)},error:o,complete:o})})}Ii.onErrorResumeNext=Ci});var Is2=c(Fr=>{"use strict";Object.defineProperty(Fr,"__esModule",{value:true});var Ms=d2(),F_=O2();function D_(r,t){return t?new Ms.Observable(function(e){var n=Object.keys(r),i=new F_.Subscription;return i.add(t.schedule(Cs,0,{keys:n,index:0,subscriber:e,subscription:i,obj:r})),i}):new Ms.Observable(function(e){for(var n=Object.keys(r),i=0;i<n.length&&!e.closed;i++){var o=n[i];r.hasOwnProperty(o)&&e.next([o,r[o]])}e.complete()})}Fr.pairs=D_;function Cs(r){var t=r.keys,e=r.index,n=r.subscriber,i=r.subscription,o=r.obj;if(!n.closed)if(e<t.length){var u=t[e];n.next([u,o[u]]),i.add(this.schedule({keys:t,index:e+1,subscriber:n,subscription:i,obj:o}))}else n.complete()}Fr.dispatch=Cs});var Ri=c(Ni=>{"use strict";Object.defineProperty(Ni,"__esModule",{value:true});function U_(r,t){function e(){return!e.pred.apply(e.thisArg,arguments)}return e.pred=r,e.thisArg=t,e}Ni.not=U_});var K2=c(ft=>{"use strict";var B_=ft&&ft.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(ft,"__esModule",{value:true});var L_=_2();function z_(r,t){return function(n){return n.lift(new G_(r,t))}}ft.filter=z_;var G_=function(){function r(t,e){this.predicate=t,this.thisArg=e}return r.prototype.call=function(t,e){return e.subscribe(new Y_(t,this.predicate,this.thisArg))},r}(),Y_=function(r){B_(t,r);function t(e,n,i){var o=r.call(this,e)||this;return o.predicate=n,o.thisArg=i,o.count=0,o}return t.prototype._next=function(e){var n;try{n=this.predicate.call(this.thisArg,e,this.count++)}catch(i){this.destination.error(i);return}n&&this.destination.next(e)},t}(L_.Subscriber)});var Vs=c(ki=>{"use strict";Object.defineProperty(ki,"__esModule",{value:true});var Q_=Ri(),Ns=ot(),Rs=K2(),ks=d2();function H_(r,t,e){return[Rs.filter(t,e)(new ks.Observable(Ns.subscribeTo(r))),Rs.filter(Q_.not(t,e))(new ks.Observable(Ns.subscribeTo(r)))]}ki.partition=H_});var Vi=c(J2=>{"use strict";var K_=J2&&J2.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(J2,"__esModule",{value:true});var J_=g(),Z_=he(),$_=F2(),X_=D2();function ev(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];if(r.length===1)if(J_.isArray(r[0]))r=r[0];else return r[0];return Z_.fromArray(r,void 0).lift(new Ws)}J2.race=ev;var Ws=function(){function r(){}return r.prototype.call=function(t,e){return e.subscribe(new Fs(t))},r}();J2.RaceOperator=Ws;var Fs=function(r){K_(t,r);function t(e){var n=r.call(this,e)||this;return n.hasFirst=false,n.observables=[],n.subscriptions=[],n}return t.prototype._next=function(e){this.observables.push(e)},t.prototype._complete=function(){var e=this.observables,n=e.length;if(n===0)this.destination.complete();else{for(var i=0;i<n&&!this.hasFirst;i++){var o=e[i],u=X_.subscribeToResult(this,o,void 0,i);this.subscriptions&&this.subscriptions.push(u),this.add(u)}this.observables=null}},t.prototype.notifyNext=function(e,n,i){if(!this.hasFirst){this.hasFirst=true;for(var o=0;o<this.subscriptions.length;o++)if(o!==i){var u=this.subscriptions[o];u.unsubscribe(),this.remove(u)}this.subscriptions=null}this.destination.next(n)},t}($_.OuterSubscriber);J2.RaceSubscriber=Fs});var Us=c(Dr=>{"use strict";Object.defineProperty(Dr,"__esModule",{value:true});var tv=d2();function rv(r,t,e){return r===void 0&&(r=0),new tv.Observable(function(n){t===void 0&&(t=r,r=0);var i=0,o=r;if(e)return e.schedule(Ds,0,{index:i,count:t,start:r,subscriber:n});do{if(i++>=t){n.complete();break}if(n.next(o++),n.closed)break}while(true)})}Dr.range=rv;function Ds(r){var t=r.start,e=r.index,n=r.count,i=r.subscriber;if(e>=n){i.complete();return}i.next(t),!i.closed&&(r.index=e+1,r.start=t+1,this.schedule(r))}Dr.dispatch=Ds});var Fi=c(Wi=>{"use strict";Object.defineProperty(Wi,"__esModule",{value:true});var nv=d2(),iv=x(),Bs2=ct(),Ls=E();function ov(r,t,e){r===void 0&&(r=0);var n=-1;return Bs2.isNumeric(t)?n=Number(t)<1&&1||Number(t):Ls.isScheduler(t)&&(e=t),Ls.isScheduler(e)||(e=iv.async),new nv.Observable(function(i){var o=Bs2.isNumeric(r)?r:+r-e.now();return e.schedule(uv,o,{index:0,period:n,subscriber:i})})}Wi.timer=ov;function uv(r){var t=r.index,e=r.period,n=r.subscriber;if(n.next(t),!n.closed){if(e===-1)return n.complete();r.index=t+1,this.schedule(r,e)}}});var zs=c(Di=>{"use strict";Object.defineProperty(Di,"__esModule",{value:true});var sv=d2(),cv=A(),av=P2();function fv(r,t){return new sv.Observable(function(e){var n;try{n=r()}catch(s){e.error(s);return}var i;try{i=t(n)}catch(s){e.error(s);return}var o=i?cv.from(i):av.EMPTY,u=o.subscribe(e);return function(){u.unsubscribe(),n&&n.unsubscribe()}})}Di.using=fv});var Br=c(Z=>{"use strict";var Gs=Z&&Z.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Z,"__esModule",{value:true});var lv=he(),pv=g(),hv=_2(),Ur=me(),Ui=y();function bv(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var e=r[r.length-1];return typeof e=="function"&&r.pop(),lv.fromArray(r,void 0).lift(new Ys(e))}Z.zip=bv;var Ys=function(){function r(t){this.resultSelector=t}return r.prototype.call=function(t,e){return e.subscribe(new Qs(t,this.resultSelector))},r}();Z.ZipOperator=Ys;var Qs=function(r){Gs(t,r);function t(e,n,i){i===void 0&&(i=Object.create(null));var o=r.call(this,e)||this;return o.resultSelector=n,o.iterators=[],o.active=0,o.resultSelector=typeof n=="function"?n:void 0,o}return t.prototype._next=function(e){var n=this.iterators;pv.isArray(e)?n.push(new vv(e)):typeof e[Ur.iterator]=="function"?n.push(new _v(e[Ur.iterator]())):n.push(new dv(this.destination,this,e))},t.prototype._complete=function(){var e=this.iterators,n=e.length;if(this.unsubscribe(),n===0){this.destination.complete();return}this.active=n;for(var i=0;i<n;i++){var o=e[i];if(o.stillUnsubscribed){var u=this.destination;u.add(o.subscribe())}else this.active--}},t.prototype.notifyInactive=function(){this.active--,this.active===0&&this.destination.complete()},t.prototype.checkIterators=function(){for(var e=this.iterators,n=e.length,i=this.destination,o=0;o<n;o++){var u=e[o];if(typeof u.hasValue=="function"&&!u.hasValue())return}for(var s=false,f=[],o=0;o<n;o++){var u=e[o],a=u.next();if(u.hasCompleted()&&(s=true),a.done){i.complete();return}f.push(a.value)}this.resultSelector?this._tryresultSelector(f):i.next(f),s&&i.complete()},t.prototype._tryresultSelector=function(e){var n;try{n=this.resultSelector.apply(this,e)}catch(i){this.destination.error(i);return}this.destination.next(n)},t}(hv.Subscriber);Z.ZipSubscriber=Qs;var _v=function(){function r(t){this.iterator=t,this.nextResult=t.next()}return r.prototype.hasValue=function(){return true},r.prototype.next=function(){var t=this.nextResult;return this.nextResult=this.iterator.next(),t},r.prototype.hasCompleted=function(){var t=this.nextResult;return Boolean(t&&t.done)},r}(),vv=function(){function r(t){this.array=t,this.index=0,this.length=0,this.length=t.length}return r.prototype[Ur.iterator]=function(){return this},r.prototype.next=function(t){var e=this.index++,n=this.array;return e<this.length?{value:n[e],done:false}:{value:null,done:true}},r.prototype.hasValue=function(){return this.array.length>this.index},r.prototype.hasCompleted=function(){return this.array.length===this.index},r}(),dv=function(r){Gs(t,r);function t(e,n,i){var o=r.call(this,e)||this;return o.parent=n,o.observable=i,o.stillUnsubscribed=true,o.buffer=[],o.isComplete=false,o}return t.prototype[Ur.iterator]=function(){return this},t.prototype.next=function(){var e=this.buffer;return e.length===0&&this.isComplete?{value:null,done:true}:{value:e.shift(),done:false}},t.prototype.hasValue=function(){return this.buffer.length>0},t.prototype.hasCompleted=function(){return this.buffer.length===0&&this.isComplete},t.prototype.notifyComplete=function(){this.buffer.length>0?(this.isComplete=true,this.parent.notifyInactive()):this.destination.complete()},t.prototype.notifyNext=function(e){this.buffer.push(e),this.parent.checkIterators()},t.prototype.subscribe=function(){return Ui.innerSubscribe(this.observable,new Ui.SimpleInnerSubscriber(this))},t}(Ui.SimpleOuterSubscriber)});var lt=c(h=>{"use strict";Object.defineProperty(h,"__esModule",{value:true});var yv=d2();h.Observable=yv.Observable;var mv=Pn();h.ConnectableObservable=mv.ConnectableObservable;var Sv=An();h.GroupedObservable=Sv.GroupedObservable;var Ov=Y();h.observable=Ov.observable;var wv=w2();h.Subject=wv.Subject;var gv=Tn();h.BehaviorSubject=gv.BehaviorSubject;var xv=Ar();h.ReplaySubject=xv.ReplaySubject;var qv=Ke();h.AsyncSubject=qv.AsyncSubject;var Hs=Ln();h.asap=Hs.asap;h.asapScheduler=Hs.asapScheduler;var Ks=x();h.async=Ks.async;h.asyncScheduler=Ks.asyncScheduler;var Js=In();h.queue=Js.queue;h.queueScheduler=Js.queueScheduler;var Zs=Bu();h.animationFrame=Zs.animationFrame;h.animationFrameScheduler=Zs.animationFrameScheduler;var $s=Gu();h.VirtualTimeScheduler=$s.VirtualTimeScheduler;h.VirtualAction=$s.VirtualAction;var jv=Cn();h.Scheduler=jv.Scheduler;var Pv=O2();h.Subscription=Pv.Subscription;var Ev=_2();h.Subscriber=Ev.Subscriber;var Xs=Ye();h.Notification=Xs.Notification;h.NotificationKind=Xs.NotificationKind;var Av=gr();h.pipe=Av.pipe;var Tv=Cr();h.noop=Tv.noop;var Mv=V2();h.identity=Mv.identity;var Cv=Yu();h.isObservable=Cv.isObservable;var Iv=_e2();h.ArgumentOutOfRangeError=Iv.ArgumentOutOfRangeError;var Nv=ve2();h.EmptyError=Nv.EmptyError;var Rv=Ce();h.ObjectUnsubscribedError=Rv.ObjectUnsubscribedError;var kv=ln2();h.UnsubscriptionError=kv.UnsubscriptionError;var Vv=Kn();h.TimeoutError=Vv.TimeoutError;var Wv=Ju();h.bindCallback=Wv.bindCallback;var Fv=es();h.bindNodeCallback=Fv.bindNodeCallback;var Dv=Ir();h.combineLatest=Dv.combineLatest;var Uv=st();h.concat=Uv.concat;var Bv=Vr();h.defer=Bv.defer;var Lv=P2();h.empty=Lv.empty;var zv=ys();h.forkJoin=zv.forkJoin;var Gv=A();h.from=Gv.from;var Yv=Os2();h.fromEvent=Yv.fromEvent;var Qv=gs2();h.fromEventPattern=Qv.fromEventPattern;var Hv=qs();h.generate=Hv.generate;var Kv=Ps();h.iif=Kv.iif;var Jv=As();h.interval=Jv.interval;var Zv=Ti();h.merge=Zv.merge;var $v=Mi();h.never=$v.never;var Xv=ze();h.of=Xv.of;var ed=Ts();h.onErrorResumeNext=ed.onErrorResumeNext;var td=Is2();h.pairs=td.pairs;var rd=Vs();h.partition=rd.partition;var nd=Vi();h.race=nd.race;var id=Us();h.range=id.range;var od=Er();h.throwError=od.throwError;var ud=Fi();h.timer=ud.timer;var sd=zs();h.using=sd.using;var cd=Br();h.zip=cd.zip;var ad=hi();h.scheduled=ad.scheduled;var fd=P2();h.EMPTY=fd.EMPTY;var ld=Mi();h.NEVER=ld.NEVER;var pd=Te();h.config=pd.config});var Li=c(pt2=>{"use strict";var hd=pt2&&pt2.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(pt2,"__esModule",{value:true});var Bi=y();function bd(r){return function(e){return e.lift(new _d(r))}}pt2.audit=bd;var _d=function(){function r(t){this.durationSelector=t}return r.prototype.call=function(t,e){return e.subscribe(new vd(t,this.durationSelector))},r}(),vd=function(r){hd(t,r);function t(e,n){var i=r.call(this,e)||this;return i.durationSelector=n,i.hasValue=false,i}return t.prototype._next=function(e){if(this.value=e,this.hasValue=true,!this.throttled){var n=void 0;try{var i=this.durationSelector;n=i(e)}catch(u){return this.destination.error(u)}var o=Bi.innerSubscribe(n,new Bi.SimpleInnerSubscriber(this));!o||o.closed?this.clearThrottle():this.add(this.throttled=o)}},t.prototype.clearThrottle=function(){var e=this,n=e.value,i=e.hasValue,o=e.throttled;o&&(this.remove(o),this.throttled=void 0,o.unsubscribe()),i&&(this.value=void 0,this.hasValue=false,this.destination.next(n))},t.prototype.notifyNext=function(){this.clearThrottle()},t.prototype.notifyComplete=function(){this.clearThrottle()},t}(Bi.SimpleOuterSubscriber)});var ec=c(zi=>{"use strict";Object.defineProperty(zi,"__esModule",{value:true});var dd=x(),yd=Li(),md=Fi();function Sd(r,t){return t===void 0&&(t=dd.async),yd.audit(function(){return md.timer(r,t)})}zi.auditTime=Sd});var tc=c(ht2=>{"use strict";var Od=ht2&&ht2.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(ht2,"__esModule",{value:true});var Gi=y();function wd(r){return function(e){return e.lift(new gd(r))}}ht2.buffer=wd;var gd=function(){function r(t){this.closingNotifier=t}return r.prototype.call=function(t,e){return e.subscribe(new xd(t,this.closingNotifier))},r}(),xd=function(r){Od(t,r);function t(e,n){var i=r.call(this,e)||this;return i.buffer=[],i.add(Gi.innerSubscribe(n,new Gi.SimpleInnerSubscriber(i))),i}return t.prototype._next=function(e){this.buffer.push(e)},t.prototype.notifyNext=function(){var e=this.buffer;this.buffer=[],this.destination.next(e)},t}(Gi.SimpleOuterSubscriber)});var ic=c(bt=>{"use strict";var rc=bt&&bt.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(bt,"__esModule",{value:true});var nc=_2();function qd(r,t){return t===void 0&&(t=null),function(n){return n.lift(new jd(r,t))}}bt.bufferCount=qd;var jd=function(){function r(t,e){this.bufferSize=t,this.startBufferEvery=e,!e||t===e?this.subscriberClass=Pd:this.subscriberClass=Ed}return r.prototype.call=function(t,e){return e.subscribe(new this.subscriberClass(t,this.bufferSize,this.startBufferEvery))},r}(),Pd=function(r){rc(t,r);function t(e,n){var i=r.call(this,e)||this;return i.bufferSize=n,i.buffer=[],i}return t.prototype._next=function(e){var n=this.buffer;n.push(e),n.length==this.bufferSize&&(this.destination.next(n),this.buffer=[])},t.prototype._complete=function(){var e=this.buffer;e.length>0&&this.destination.next(e),r.prototype._complete.call(this)},t}(nc.Subscriber),Ed=function(r){rc(t,r);function t(e,n,i){var o=r.call(this,e)||this;return o.bufferSize=n,o.startBufferEvery=i,o.buffers=[],o.count=0,o}return t.prototype._next=function(e){var n=this,i=n.bufferSize,o=n.startBufferEvery,u=n.buffers,s=n.count;this.count++,s%o===0&&u.push([]);for(var f=u.length;f--;){var a=u[f];a.push(e),a.length===i&&(u.splice(f,1),this.destination.next(a))}},t.prototype._complete=function(){for(var e=this,n=e.buffers,i=e.destination;n.length>0;){var o=n.shift();o.length>0&&i.next(o)}r.prototype._complete.call(this)},t}(nc.Subscriber)});var sc=c(_t=>{"use strict";var Ad=_t&&_t.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(_t,"__esModule",{value:true});var Td=x(),Md=_2(),Cd=E();function Id(r){var t=arguments.length,e=Td.async;Cd.isScheduler(arguments[arguments.length-1])&&(e=arguments[arguments.length-1],t--);var n=null;t>=2&&(n=arguments[1]);var i=Number.POSITIVE_INFINITY;return t>=3&&(i=arguments[2]),function(u){return u.lift(new Nd(r,n,i,e))}}_t.bufferTime=Id;var Nd=function(){function r(t,e,n,i){this.bufferTimeSpan=t,this.bufferCreationInterval=e,this.maxBufferSize=n,this.scheduler=i}return r.prototype.call=function(t,e){return e.subscribe(new kd(t,this.bufferTimeSpan,this.bufferCreationInterval,this.maxBufferSize,this.scheduler))},r}(),Rd=function(){function r(){this.buffer=[]}return r}(),kd=function(r){Ad(t,r);function t(e,n,i,o,u){var s=r.call(this,e)||this;s.bufferTimeSpan=n,s.bufferCreationInterval=i,s.maxBufferSize=o,s.scheduler=u,s.contexts=[];var f=s.openContext();if(s.timespanOnly=i==null||i<0,s.timespanOnly){var a={subscriber:s,context:f,bufferTimeSpan:n};s.add(f.closeAction=u.schedule(oc,n,a))}else{var p={subscriber:s,context:f},b={bufferTimeSpan:n,bufferCreationInterval:i,subscriber:s,scheduler:u};s.add(f.closeAction=u.schedule(uc,n,p)),s.add(u.schedule(Vd,i,b))}return s}return t.prototype._next=function(e){for(var n=this.contexts,i=n.length,o,u=0;u<i;u++){var s=n[u],f=s.buffer;f.push(e),f.length==this.maxBufferSize&&(o=s)}o&&this.onBufferFull(o)},t.prototype._error=function(e){this.contexts.length=0,r.prototype._error.call(this,e)},t.prototype._complete=function(){for(var e=this,n=e.contexts,i=e.destination;n.length>0;){var o=n.shift();i.next(o.buffer)}r.prototype._complete.call(this)},t.prototype._unsubscribe=function(){this.contexts=null},t.prototype.onBufferFull=function(e){this.closeContext(e);var n=e.closeAction;if(n.unsubscribe(),this.remove(n),!this.closed&&this.timespanOnly){e=this.openContext();var i=this.bufferTimeSpan,o={subscriber:this,context:e,bufferTimeSpan:i};this.add(e.closeAction=this.scheduler.schedule(oc,i,o))}},t.prototype.openContext=function(){var e=new Rd;return this.contexts.push(e),e},t.prototype.closeContext=function(e){this.destination.next(e.buffer);var n=this.contexts,i=n?n.indexOf(e):-1;i>=0&&n.splice(n.indexOf(e),1)},t}(Md.Subscriber);function oc(r){var t=r.subscriber,e=r.context;e&&t.closeContext(e),t.closed||(r.context=t.openContext(),r.context.closeAction=this.schedule(r,r.bufferTimeSpan))}function Vd(r){var t=r.bufferCreationInterval,e=r.bufferTimeSpan,n=r.subscriber,i=r.scheduler,o=n.openContext(),u=this;n.closed||(n.add(o.closeAction=i.schedule(uc,e,{subscriber:n,context:o})),u.schedule(r,t))}function uc(r){var t=r.subscriber,e=r.context;t.closeContext(e)}});var ac=c(vt=>{"use strict";var Wd=vt&&vt.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(vt,"__esModule",{value:true});var Fd=O2(),cc=D2(),Dd=F2();function Ud(r,t){return function(n){return n.lift(new Bd(r,t))}}vt.bufferToggle=Ud;var Bd=function(){function r(t,e){this.openings=t,this.closingSelector=e}return r.prototype.call=function(t,e){return e.subscribe(new Ld(t,this.openings,this.closingSelector))},r}(),Ld=function(r){Wd(t,r);function t(e,n,i){var o=r.call(this,e)||this;return o.closingSelector=i,o.contexts=[],o.add(cc.subscribeToResult(o,n)),o}return t.prototype._next=function(e){for(var n=this.contexts,i=n.length,o=0;o<i;o++)n[o].buffer.push(e)},t.prototype._error=function(e){for(var n=this.contexts;n.length>0;){var i=n.shift();i.subscription.unsubscribe(),i.buffer=null,i.subscription=null}this.contexts=null,r.prototype._error.call(this,e)},t.prototype._complete=function(){for(var e=this.contexts;e.length>0;){var n=e.shift();this.destination.next(n.buffer),n.subscription.unsubscribe(),n.buffer=null,n.subscription=null}this.contexts=null,r.prototype._complete.call(this)},t.prototype.notifyNext=function(e,n){e?this.closeBuffer(e):this.openBuffer(n)},t.prototype.notifyComplete=function(e){this.closeBuffer(e.context)},t.prototype.openBuffer=function(e){try{var n=this.closingSelector,i=n.call(this,e);i&&this.trySubscribe(i)}catch(o){this._error(o)}},t.prototype.closeBuffer=function(e){var n=this.contexts;if(n&&e){var i=e.buffer,o=e.subscription;this.destination.next(i),n.splice(n.indexOf(e),1),this.remove(o),o.unsubscribe()}},t.prototype.trySubscribe=function(e){var n=this.contexts,i=[],o=new Fd.Subscription,u={buffer:i,subscription:o};n.push(u);var s=cc.subscribeToResult(this,e,u);!s||s.closed?this.closeBuffer(u):(s.context=u,this.add(s),o.add(s))},t}(Dd.OuterSubscriber)});var fc=c(dt=>{"use strict";var zd=dt&&dt.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(dt,"__esModule",{value:true});var Gd=O2(),Yi=y();function Yd(r){return function(t){return t.lift(new Qd(r))}}dt.bufferWhen=Yd;var Qd=function(){function r(t){this.closingSelector=t}return r.prototype.call=function(t,e){return e.subscribe(new Hd(t,this.closingSelector))},r}(),Hd=function(r){zd(t,r);function t(e,n){var i=r.call(this,e)||this;return i.closingSelector=n,i.subscribing=false,i.openBuffer(),i}return t.prototype._next=function(e){this.buffer.push(e)},t.prototype._complete=function(){var e=this.buffer;e&&this.destination.next(e),r.prototype._complete.call(this)},t.prototype._unsubscribe=function(){this.buffer=void 0,this.subscribing=false},t.prototype.notifyNext=function(){this.openBuffer()},t.prototype.notifyComplete=function(){this.subscribing?this.complete():this.openBuffer()},t.prototype.openBuffer=function(){var e=this.closingSubscription;e&&(this.remove(e),e.unsubscribe());var n=this.buffer;this.buffer&&this.destination.next(n),this.buffer=[];var i;try{var o=this.closingSelector;i=o()}catch(u){return this.error(u)}e=new Gd.Subscription,this.closingSubscription=e,this.add(e),this.subscribing=true,e.add(Yi.innerSubscribe(i,new Yi.SimpleInnerSubscriber(this))),this.subscribing=false},t}(Yi.SimpleOuterSubscriber)});var lc=c(yt=>{"use strict";var Kd=yt&&yt.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(yt,"__esModule",{value:true});var Qi=y();function Jd(r){return function(e){var n=new Zd(r),i=e.lift(n);return n.caught=i}}yt.catchError=Jd;var Zd=function(){function r(t){this.selector=t}return r.prototype.call=function(t,e){return e.subscribe(new $d(t,this.selector,this.caught))},r}(),$d=function(r){Kd(t,r);function t(e,n,i){var o=r.call(this,e)||this;return o.selector=n,o.caught=i,o}return t.prototype.error=function(e){if(!this.isStopped){var n=void 0;try{n=this.selector(e,this.caught)}catch(u){r.prototype.error.call(this,u);return}this._unsubscribeAndRecycle();var i=new Qi.SimpleInnerSubscriber(this);this.add(i);var o=Qi.innerSubscribe(n,i);o!==i&&this.add(o)}},t}(Qi.SimpleOuterSubscriber)});var pc=c(Hi=>{"use strict";Object.defineProperty(Hi,"__esModule",{value:true});var Xd=Ir();function ey(r){return function(t){return t.lift(new Xd.CombineLatestOperator(r))}}Hi.combineAll=ey});var hc=c(Ki=>{"use strict";Object.defineProperty(Ki,"__esModule",{value:true});var ty=g(),ry=Ir(),ny=A();function iy(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var e=null;return typeof r[r.length-1]=="function"&&(e=r.pop()),r.length===1&&ty.isArray(r[0])&&(r=r[0].slice()),function(n){return n.lift.call(ny.from([n].concat(r)),new ry.CombineLatestOperator(e))}}Ki.combineLatest=iy});var bc=c(Ji=>{"use strict";Object.defineProperty(Ji,"__esModule",{value:true});var oy=st();function uy(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return function(e){return e.lift.call(oy.concat.apply(void 0,[e].concat(r)))}}Ji.concat=uy});var $i=c(Zi=>{"use strict";Object.defineProperty(Zi,"__esModule",{value:true});var sy=ut();function cy(r,t){return sy.mergeMap(r,t,1)}Zi.concatMap=cy});var _c=c(Xi=>{"use strict";Object.defineProperty(Xi,"__esModule",{value:true});var ay=$i();function fy(r,t){return ay.concatMap(function(){return r},t)}Xi.concatMapTo=fy});var vc=c(mt=>{"use strict";var ly=mt&&mt.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(mt,"__esModule",{value:true});var py=_2();function hy(r){return function(t){return t.lift(new by(r,t))}}mt.count=hy;var by=function(){function r(t,e){this.predicate=t,this.source=e}return r.prototype.call=function(t,e){return e.subscribe(new _y(t,this.predicate,this.source))},r}(),_y=function(r){ly(t,r);function t(e,n,i){var o=r.call(this,e)||this;return o.predicate=n,o.source=i,o.count=0,o.index=0,o}return t.prototype._next=function(e){this.predicate?this._tryPredicate(e):this.count++},t.prototype._tryPredicate=function(e){var n;try{n=this.predicate(e,this.index++,this.source)}catch(i){this.destination.error(i);return}n&&this.count++},t.prototype._complete=function(){this.destination.next(this.count),this.destination.complete()},t}(py.Subscriber)});var dc=c(St=>{"use strict";var vy=St&&St.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(St,"__esModule",{value:true});var eo=y();function dy(r){return function(t){return t.lift(new yy(r))}}St.debounce=dy;var yy=function(){function r(t){this.durationSelector=t}return r.prototype.call=function(t,e){return e.subscribe(new my(t,this.durationSelector))},r}(),my=function(r){vy(t,r);function t(e,n){var i=r.call(this,e)||this;return i.durationSelector=n,i.hasValue=false,i}return t.prototype._next=function(e){try{var n=this.durationSelector.call(this,e);n&&this._tryNext(e,n)}catch(i){this.destination.error(i)}},t.prototype._complete=function(){this.emitValue(),this.destination.complete()},t.prototype._tryNext=function(e,n){var i=this.durationSubscription;this.value=e,this.hasValue=true,i&&(i.unsubscribe(),this.remove(i)),i=eo.innerSubscribe(n,new eo.SimpleInnerSubscriber(this)),i&&!i.closed&&this.add(this.durationSubscription=i)},t.prototype.notifyNext=function(){this.emitValue()},t.prototype.notifyComplete=function(){this.emitValue()},t.prototype.emitValue=function(){if(this.hasValue){var e=this.value,n=this.durationSubscription;n&&(this.durationSubscription=void 0,n.unsubscribe(),this.remove(n)),this.value=void 0,this.hasValue=false,r.prototype._next.call(this,e)}},t}(eo.SimpleOuterSubscriber)});var yc=c(Ot=>{"use strict";var Sy=Ot&&Ot.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Ot,"__esModule",{value:true});var Oy=_2(),wy=x();function gy(r,t){return t===void 0&&(t=wy.async),function(e){return e.lift(new xy(r,t))}}Ot.debounceTime=gy;var xy=function(){function r(t,e){this.dueTime=t,this.scheduler=e}return r.prototype.call=function(t,e){return e.subscribe(new qy(t,this.dueTime,this.scheduler))},r}(),qy=function(r){Sy(t,r);function t(e,n,i){var o=r.call(this,e)||this;return o.dueTime=n,o.scheduler=i,o.debouncedSubscription=null,o.lastValue=null,o.hasValue=false,o}return t.prototype._next=function(e){this.clearDebounce(),this.lastValue=e,this.hasValue=true,this.add(this.debouncedSubscription=this.scheduler.schedule(jy,this.dueTime,this))},t.prototype._complete=function(){this.debouncedNext(),this.destination.complete()},t.prototype.debouncedNext=function(){if(this.clearDebounce(),this.hasValue){var e=this.lastValue;this.lastValue=null,this.hasValue=false,this.destination.next(e)}},t.prototype.clearDebounce=function(){var e=this.debouncedSubscription;e!==null&&(this.remove(e),e.unsubscribe(),this.debouncedSubscription=null)},t}(Oy.Subscriber);function jy(r){r.debouncedNext()}});var Se2=c(wt=>{"use strict";var Py=wt&&wt.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(wt,"__esModule",{value:true});var Ey=_2();function Ay(r){return r===void 0&&(r=null),function(t){return t.lift(new Ty(r))}}wt.defaultIfEmpty=Ay;var Ty=function(){function r(t){this.defaultValue=t}return r.prototype.call=function(t,e){return e.subscribe(new My(t,this.defaultValue))},r}(),My=function(r){Py(t,r);function t(e,n){var i=r.call(this,e)||this;return i.defaultValue=n,i.isEmpty=true,i}return t.prototype._next=function(e){this.isEmpty=false,this.destination.next(e)},t.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},t}(Ey.Subscriber)});var ro=c(to=>{"use strict";Object.defineProperty(to,"__esModule",{value:true});function Cy(r){return r instanceof Date&&!isNaN(+r)}to.isDate=Cy});var Sc=c(gt=>{"use strict";var Iy=gt&&gt.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(gt,"__esModule",{value:true});var Ny=x(),Ry=ro(),ky=_2(),mc=Ye();function Vy(r,t){t===void 0&&(t=Ny.async);var e=Ry.isDate(r),n=e?+r-t.now():Math.abs(r);return function(i){return i.lift(new Wy(n,t))}}gt.delay=Vy;var Wy=function(){function r(t,e){this.delay=t,this.scheduler=e}return r.prototype.call=function(t,e){return e.subscribe(new Fy(t,this.delay,this.scheduler))},r}(),Fy=function(r){Iy(t,r);function t(e,n,i){var o=r.call(this,e)||this;return o.delay=n,o.scheduler=i,o.queue=[],o.active=false,o.errored=false,o}return t.dispatch=function(e){for(var n=e.source,i=n.queue,o=e.scheduler,u=e.destination;i.length>0&&i[0].time-o.now()<=0;)i.shift().notification.observe(u);if(i.length>0){var s=Math.max(0,i[0].time-o.now());this.schedule(e,s)}else this.unsubscribe(),n.active=false},t.prototype._schedule=function(e){this.active=true;var n=this.destination;n.add(e.schedule(t.dispatch,this.delay,{source:this,destination:this.destination,scheduler:e}))},t.prototype.scheduleNotification=function(e){if(this.errored!==true){var n=this.scheduler,i=new Dy(n.now()+this.delay,e);this.queue.push(i),this.active===false&&this._schedule(n)}},t.prototype._next=function(e){this.scheduleNotification(mc.Notification.createNext(e))},t.prototype._error=function(e){this.errored=true,this.queue=[],this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.scheduleNotification(mc.Notification.createComplete()),this.unsubscribe()},t}(ky.Subscriber),Dy=function(){function r(t,e){this.time=t,this.notification=e}return r}()});var wc=c(xt=>{"use strict";var no=xt&&xt.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(xt,"__esModule",{value:true});var Uy=_2(),By=d2(),Ly=F2(),zy=D2();function Gy(r,t){return t?function(e){return new Qy(e,t).lift(new Oc(r))}:function(e){return e.lift(new Oc(r))}}xt.delayWhen=Gy;var Oc=function(){function r(t){this.delayDurationSelector=t}return r.prototype.call=function(t,e){return e.subscribe(new Yy(t,this.delayDurationSelector))},r}(),Yy=function(r){no(t,r);function t(e,n){var i=r.call(this,e)||this;return i.delayDurationSelector=n,i.completed=false,i.delayNotifierSubscriptions=[],i.index=0,i}return t.prototype.notifyNext=function(e,n,i,o,u){this.destination.next(e),this.removeSubscription(u),this.tryComplete()},t.prototype.notifyError=function(e,n){this._error(e)},t.prototype.notifyComplete=function(e){var n=this.removeSubscription(e);n&&this.destination.next(n),this.tryComplete()},t.prototype._next=function(e){var n=this.index++;try{var i=this.delayDurationSelector(e,n);i&&this.tryDelay(i,e)}catch(o){this.destination.error(o)}},t.prototype._complete=function(){this.completed=true,this.tryComplete(),this.unsubscribe()},t.prototype.removeSubscription=function(e){e.unsubscribe();var n=this.delayNotifierSubscriptions.indexOf(e);return n!==-1&&this.delayNotifierSubscriptions.splice(n,1),e.outerValue},t.prototype.tryDelay=function(e,n){var i=zy.subscribeToResult(this,e,n);if(i&&!i.closed){var o=this.destination;o.add(i),this.delayNotifierSubscriptions.push(i)}},t.prototype.tryComplete=function(){this.completed&&this.delayNotifierSubscriptions.length===0&&this.destination.complete()},t}(Ly.OuterSubscriber),Qy=function(r){no(t,r);function t(e,n){var i=r.call(this)||this;return i.source=e,i.subscriptionDelay=n,i}return t.prototype._subscribe=function(e){this.subscriptionDelay.subscribe(new Hy(e,this.source))},t}(By.Observable),Hy=function(r){no(t,r);function t(e,n){var i=r.call(this)||this;return i.parent=e,i.source=n,i.sourceSubscribed=false,i}return t.prototype._next=function(e){this.subscribeToSource()},t.prototype._error=function(e){this.unsubscribe(),this.parent.error(e)},t.prototype._complete=function(){this.unsubscribe(),this.subscribeToSource()},t.prototype.subscribeToSource=function(){this.sourceSubscribed||(this.sourceSubscribed=true,this.unsubscribe(),this.source.subscribe(this.parent))},t}(Uy.Subscriber)});var gc=c(qt=>{"use strict";var Ky=qt&&qt.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(qt,"__esModule",{value:true});var Jy=_2();function Zy(){return function(t){return t.lift(new $y)}}qt.dematerialize=Zy;var $y=function(){function r(){}return r.prototype.call=function(t,e){return e.subscribe(new Xy(t))},r}(),Xy=function(r){Ky(t,r);function t(e){return r.call(this,e)||this}return t.prototype._next=function(e){e.observe(this.destination)},t}(Jy.Subscriber)});var qc=c(Oe2=>{"use strict";var em=Oe2&&Oe2.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Oe2,"__esModule",{value:true});var io=y();function tm(r,t){return function(e){return e.lift(new rm(r,t))}}Oe2.distinct=tm;var rm=function(){function r(t,e){this.keySelector=t,this.flushes=e}return r.prototype.call=function(t,e){return e.subscribe(new xc(t,this.keySelector,this.flushes))},r}(),xc=function(r){em(t,r);function t(e,n,i){var o=r.call(this,e)||this;return o.keySelector=n,o.values=new Set,i&&o.add(io.innerSubscribe(i,new io.SimpleInnerSubscriber(o))),o}return t.prototype.notifyNext=function(){this.values.clear()},t.prototype.notifyError=function(e){this._error(e)},t.prototype._next=function(e){this.keySelector?this._useKeySelector(e):this._finalizeNext(e,e)},t.prototype._useKeySelector=function(e){var n,i=this.destination;try{n=this.keySelector(e)}catch(o){i.error(o);return}this._finalizeNext(n,e)},t.prototype._finalizeNext=function(e,n){var i=this.values;i.has(e)||(i.add(e),this.destination.next(n))},t}(io.SimpleOuterSubscriber);Oe2.DistinctSubscriber=xc});var oo=c(jt2=>{"use strict";var nm=jt2&&jt2.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(jt2,"__esModule",{value:true});var im=_2();function om(r,t){return function(e){return e.lift(new um(r,t))}}jt2.distinctUntilChanged=om;var um=function(){function r(t,e){this.compare=t,this.keySelector=e}return r.prototype.call=function(t,e){return e.subscribe(new sm(t,this.compare,this.keySelector))},r}(),sm=function(r){nm(t,r);function t(e,n,i){var o=r.call(this,e)||this;return o.keySelector=i,o.hasKey=false,typeof n=="function"&&(o.compare=n),o}return t.prototype.compare=function(e,n){return e===n},t.prototype._next=function(e){var n;try{var i=this.keySelector;n=i?i(e):e}catch(s){return this.destination.error(s)}var o=false;if(this.hasKey)try{var u=this.compare;o=u(this.key,n)}catch(s){return this.destination.error(s)}else this.hasKey=true;o||(this.key=n,this.destination.next(e))},t}(im.Subscriber)});var jc=c(uo=>{"use strict";Object.defineProperty(uo,"__esModule",{value:true});var cm=oo();function am(r,t){return cm.distinctUntilChanged(function(e,n){return t?t(e[r],n[r]):e[r]===n[r]})}uo.distinctUntilKeyChanged=am});var Et=c(Pt=>{"use strict";var fm=Pt&&Pt.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Pt,"__esModule",{value:true});var lm=ve2(),pm=_2();function hm(r){return r===void 0&&(r=vm),function(t){return t.lift(new bm(r))}}Pt.throwIfEmpty=hm;var bm=function(){function r(t){this.errorFactory=t}return r.prototype.call=function(t,e){return e.subscribe(new _m(t,this.errorFactory))},r}(),_m=function(r){fm(t,r);function t(e,n){var i=r.call(this,e)||this;return i.errorFactory=n,i.hasValue=false,i}return t.prototype._next=function(e){this.hasValue=true,this.destination.next(e)},t.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var e=void 0;try{e=this.errorFactory()}catch(n){e=n}this.destination.error(e)},t}(pm.Subscriber);function vm(){return new lm.EmptyError}});var Lr=c(At=>{"use strict";var dm=At&&At.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(At,"__esModule",{value:true});var ym=_2(),mm=_e2(),Sm=P2();function Om(r){return function(t){return r===0?Sm.empty():t.lift(new wm(r))}}At.take=Om;var wm=function(){function r(t){if(this.total=t,this.total<0)throw new mm.ArgumentOutOfRangeError}return r.prototype.call=function(t,e){return e.subscribe(new gm(t,this.total))},r}(),gm=function(r){dm(t,r);function t(e,n){var i=r.call(this,e)||this;return i.total=n,i.count=0,i}return t.prototype._next=function(e){var n=this.total,i=++this.count;i<=n&&(this.destination.next(e),i===n&&(this.destination.complete(),this.unsubscribe()))},t}(ym.Subscriber)});var Ec=c(so=>{"use strict";Object.defineProperty(so,"__esModule",{value:true});var Pc=_e2(),xm=K2(),qm=Et(),jm=Se2(),Pm=Lr();function Em(r,t){if(r<0)throw new Pc.ArgumentOutOfRangeError;var e=arguments.length>=2;return function(n){return n.pipe(xm.filter(function(i,o){return o===r}),Pm.take(1),e?jm.defaultIfEmpty(t):qm.throwIfEmpty(function(){return new Pc.ArgumentOutOfRangeError}))}}so.elementAt=Em});var Ac=c(co=>{"use strict";Object.defineProperty(co,"__esModule",{value:true});var Am=st(),Tm=ze();function Mm(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return function(e){return Am.concat(e,Tm.of.apply(void 0,r))}}co.endWith=Mm});var Tc=c(Tt=>{"use strict";var Cm=Tt&&Tt.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Tt,"__esModule",{value:true});var Im=_2();function Nm(r,t){return function(e){return e.lift(new Rm(r,t,e))}}Tt.every=Nm;var Rm=function(){function r(t,e,n){this.predicate=t,this.thisArg=e,this.source=n}return r.prototype.call=function(t,e){return e.subscribe(new km(t,this.predicate,this.thisArg,this.source))},r}(),km=function(r){Cm(t,r);function t(e,n,i,o){var u=r.call(this,e)||this;return u.predicate=n,u.thisArg=i,u.source=o,u.index=0,u.thisArg=i||u,u}return t.prototype.notifyComplete=function(e){this.destination.next(e),this.destination.complete()},t.prototype._next=function(e){var n=false;try{n=this.predicate.call(this.thisArg,e,this.index++,this.source)}catch(i){this.destination.error(i);return}n||this.notifyComplete(false)},t.prototype._complete=function(){this.notifyComplete(true)},t}(Im.Subscriber)});var Mc=c(Mt=>{"use strict";var Vm=Mt&&Mt.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Mt,"__esModule",{value:true});var ao=y();function Wm(){return function(r){return r.lift(new Fm)}}Mt.exhaust=Wm;var Fm=function(){function r(){}return r.prototype.call=function(t,e){return e.subscribe(new Dm(t))},r}(),Dm=function(r){Vm(t,r);function t(e){var n=r.call(this,e)||this;return n.hasCompleted=false,n.hasSubscription=false,n}return t.prototype._next=function(e){this.hasSubscription||(this.hasSubscription=true,this.add(ao.innerSubscribe(e,new ao.SimpleInnerSubscriber(this))))},t.prototype._complete=function(){this.hasCompleted=true,this.hasSubscription||this.destination.complete()},t.prototype.notifyComplete=function(){this.hasSubscription=false,this.hasCompleted&&this.destination.complete()},t}(ao.SimpleOuterSubscriber)});var Ic=c(Ct2=>{"use strict";var Um=Ct2&&Ct2.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Ct2,"__esModule",{value:true});var Bm=j(),Lm=A(),fo=y();function Cc(r,t){return t?function(e){return e.pipe(Cc(function(n,i){return Lm.from(r(n,i)).pipe(Bm.map(function(o,u){return t(n,o,i,u)}))}))}:function(e){return e.lift(new zm(r))}}Ct2.exhaustMap=Cc;var zm=function(){function r(t){this.project=t}return r.prototype.call=function(t,e){return e.subscribe(new Gm(t,this.project))},r}(),Gm=function(r){Um(t,r);function t(e,n){var i=r.call(this,e)||this;return i.project=n,i.hasSubscription=false,i.hasCompleted=false,i.index=0,i}return t.prototype._next=function(e){this.hasSubscription||this.tryNext(e)},t.prototype.tryNext=function(e){var n,i=this.index++;try{n=this.project(e,i)}catch(o){this.destination.error(o);return}this.hasSubscription=true,this._innerSub(n)},t.prototype._innerSub=function(e){var n=new fo.SimpleInnerSubscriber(this),i=this.destination;i.add(n);var o=fo.innerSubscribe(e,n);o!==n&&i.add(o)},t.prototype._complete=function(){this.hasCompleted=true,this.hasSubscription||this.destination.complete(),this.unsubscribe()},t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyError=function(e){this.destination.error(e)},t.prototype.notifyComplete=function(){this.hasSubscription=false,this.hasCompleted&&this.destination.complete()},t}(fo.SimpleOuterSubscriber)});var kc=c($2=>{"use strict";var Ym=$2&&$2.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty($2,"__esModule",{value:true});var lo=y();function Qm(r,t,e){return t===void 0&&(t=Number.POSITIVE_INFINITY),t=(t||0)<1?Number.POSITIVE_INFINITY:t,function(n){return n.lift(new Nc(r,t,e))}}$2.expand=Qm;var Nc=function(){function r(t,e,n){this.project=t,this.concurrent=e,this.scheduler=n}return r.prototype.call=function(t,e){return e.subscribe(new Rc(t,this.project,this.concurrent,this.scheduler))},r}();$2.ExpandOperator=Nc;var Rc=function(r){Ym(t,r);function t(e,n,i,o){var u=r.call(this,e)||this;return u.project=n,u.concurrent=i,u.scheduler=o,u.index=0,u.active=0,u.hasCompleted=false,i<Number.POSITIVE_INFINITY&&(u.buffer=[]),u}return t.dispatch=function(e){var n=e.subscriber,i=e.result,o=e.value,u=e.index;n.subscribeToProjection(i,o,u)},t.prototype._next=function(e){var n=this.destination;if(n.closed){this._complete();return}var i=this.index++;if(this.active<this.concurrent){n.next(e);try{var o=this.project,u=o(e,i);if(!this.scheduler)this.subscribeToProjection(u,e,i);else{var s={subscriber:this,result:u,value:e,index:i},f=this.destination;f.add(this.scheduler.schedule(t.dispatch,0,s))}}catch(a){n.error(a)}}else this.buffer.push(e)},t.prototype.subscribeToProjection=function(e,n,i){this.active++;var o=this.destination;o.add(lo.innerSubscribe(e,new lo.SimpleInnerSubscriber(this)))},t.prototype._complete=function(){this.hasCompleted=true,this.hasCompleted&&this.active===0&&this.destination.complete(),this.unsubscribe()},t.prototype.notifyNext=function(e){this._next(e)},t.prototype.notifyComplete=function(){var e=this.buffer;this.active--,e&&e.length>0&&this._next(e.shift()),this.hasCompleted&&this.active===0&&this.destination.complete()},t}(lo.SimpleOuterSubscriber);$2.ExpandSubscriber=Rc});var Vc=c(It=>{"use strict";var Hm=It&&It.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(It,"__esModule",{value:true});var Km=_2(),Jm=O2();function Zm(r){return function(t){return t.lift(new $m(r))}}It.finalize=Zm;var $m=function(){function r(t){this.callback=t}return r.prototype.call=function(t,e){return e.subscribe(new Xm(t,this.callback))},r}(),Xm=function(r){Hm(t,r);function t(e,n){var i=r.call(this,e)||this;return i.add(new Jm.Subscription(n)),i}return t}(Km.Subscriber)});var po=c(X=>{"use strict";var eS=X&&X.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(X,"__esModule",{value:true});var tS=_2();function rS(r,t){if(typeof r!="function")throw new TypeError("predicate is not a function");return function(e){return e.lift(new Wc(r,e,false,t))}}X.find=rS;var Wc=function(){function r(t,e,n,i){this.predicate=t,this.source=e,this.yieldIndex=n,this.thisArg=i}return r.prototype.call=function(t,e){return e.subscribe(new Fc(t,this.predicate,this.source,this.yieldIndex,this.thisArg))},r}();X.FindValueOperator=Wc;var Fc=function(r){eS(t,r);function t(e,n,i,o,u){var s=r.call(this,e)||this;return s.predicate=n,s.source=i,s.yieldIndex=o,s.thisArg=u,s.index=0,s}return t.prototype.notifyComplete=function(e){var n=this.destination;n.next(e),n.complete(),this.unsubscribe()},t.prototype._next=function(e){var n=this,i=n.predicate,o=n.thisArg,u=this.index++;try{var s=i.call(o||this,e,u,this.source);s&&this.notifyComplete(this.yieldIndex?u:e)}catch(f){this.destination.error(f)}},t.prototype._complete=function(){this.notifyComplete(this.yieldIndex?-1:void 0)},t}(tS.Subscriber);X.FindValueSubscriber=Fc});var Dc=c(ho=>{"use strict";Object.defineProperty(ho,"__esModule",{value:true});var nS=po();function iS(r,t){return function(e){return e.lift(new nS.FindValueOperator(r,e,true,t))}}ho.findIndex=iS});var Uc=c(bo=>{"use strict";Object.defineProperty(bo,"__esModule",{value:true});var oS=ve2(),uS=K2(),sS=Lr(),cS=Se2(),aS=Et(),fS=V2();function lS(r,t){var e=arguments.length>=2;return function(n){return n.pipe(r?uS.filter(function(i,o){return r(i,o,n)}):fS.identity,sS.take(1),e?cS.defaultIfEmpty(t):aS.throwIfEmpty(function(){return new oS.EmptyError}))}}bo.first=lS});var Bc=c(Nt=>{"use strict";var pS=Nt&&Nt.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Nt,"__esModule",{value:true});var hS=_2();function bS(){return function(t){return t.lift(new _S)}}Nt.ignoreElements=bS;var _S=function(){function r(){}return r.prototype.call=function(t,e){return e.subscribe(new vS(t))},r}(),vS=function(r){pS(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype._next=function(e){},t}(hS.Subscriber)});var Lc=c(Rt=>{"use strict";var dS=Rt&&Rt.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Rt,"__esModule",{value:true});var yS=_2();function mS(){return function(r){return r.lift(new SS)}}Rt.isEmpty=mS;var SS=function(){function r(){}return r.prototype.call=function(t,e){return e.subscribe(new OS(t))},r}(),OS=function(r){dS(t,r);function t(e){return r.call(this,e)||this}return t.prototype.notifyComplete=function(e){var n=this.destination;n.next(e),n.complete()},t.prototype._next=function(e){this.notifyComplete(false)},t.prototype._complete=function(){this.notifyComplete(true)},t}(yS.Subscriber)});var zr=c(kt=>{"use strict";var wS=kt&&kt.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(kt,"__esModule",{value:true});var gS=_2(),xS=_e2(),qS=P2();function jS(r){return function(e){return r===0?qS.empty():e.lift(new PS(r))}}kt.takeLast=jS;var PS=function(){function r(t){if(this.total=t,this.total<0)throw new xS.ArgumentOutOfRangeError}return r.prototype.call=function(t,e){return e.subscribe(new ES(t,this.total))},r}(),ES=function(r){wS(t,r);function t(e,n){var i=r.call(this,e)||this;return i.total=n,i.ring=new Array,i.count=0,i}return t.prototype._next=function(e){var n=this.ring,i=this.total,o=this.count++;if(n.length<i)n.push(e);else{var u=o%i;n[u]=e}},t.prototype._complete=function(){var e=this.destination,n=this.count;if(n>0)for(var i=this.count>=this.total?this.total:this.count,o=this.ring,u=0;u<i;u++){var s=n++%i;e.next(o[s])}e.complete()},t}(gS.Subscriber)});var zc=c(_o2=>{"use strict";Object.defineProperty(_o2,"__esModule",{value:true});var AS=ve2(),TS=K2(),MS=zr(),CS=Et(),IS=Se2(),NS=V2();function RS(r,t){var e=arguments.length>=2;return function(n){return n.pipe(r?TS.filter(function(i,o){return r(i,o,n)}):NS.identity,MS.takeLast(1),e?IS.defaultIfEmpty(t):CS.throwIfEmpty(function(){return new AS.EmptyError}))}}_o2.last=RS});var Gc=c(Vt=>{"use strict";var kS=Vt&&Vt.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Vt,"__esModule",{value:true});var VS=_2();function WS(r){return function(t){return t.lift(new FS(r))}}Vt.mapTo=WS;var FS=function(){function r(t){this.value=t}return r.prototype.call=function(t,e){return e.subscribe(new DS(t,this.value))},r}(),DS=function(r){kS(t,r);function t(e,n){var i=r.call(this,e)||this;return i.value=n,i}return t.prototype._next=function(e){this.destination.next(this.value)},t}(VS.Subscriber)});var Yc2=c(Wt=>{"use strict";var US=Wt&&Wt.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Wt,"__esModule",{value:true});var BS=_2(),vo2=Ye();function LS(){return function(t){return t.lift(new zS)}}Wt.materialize=LS;var zS=function(){function r(){}return r.prototype.call=function(t,e){return e.subscribe(new GS(t))},r}(),GS=function(r){US(t,r);function t(e){return r.call(this,e)||this}return t.prototype._next=function(e){this.destination.next(vo2.Notification.createNext(e))},t.prototype._error=function(e){var n=this.destination;n.next(vo2.Notification.createError(e)),n.complete()},t.prototype._complete=function(){var e=this.destination;e.next(vo2.Notification.createComplete()),e.complete()},t}(BS.Subscriber)});var Gr=c(Ft=>{"use strict";var YS=Ft&&Ft.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Ft,"__esModule",{value:true});var QS=_2();function HS(r,t){var e=false;return arguments.length>=2&&(e=true),function(i){return i.lift(new KS(r,t,e))}}Ft.scan=HS;var KS=function(){function r(t,e,n){n===void 0&&(n=false),this.accumulator=t,this.seed=e,this.hasSeed=n}return r.prototype.call=function(t,e){return e.subscribe(new JS(t,this.accumulator,this.seed,this.hasSeed))},r}(),JS=function(r){YS(t,r);function t(e,n,i,o){var u=r.call(this,e)||this;return u.accumulator=n,u._seed=i,u.hasSeed=o,u.index=0,u}return Object.defineProperty(t.prototype,"seed",{get:function(){return this._seed},set:function(e){this.hasSeed=true,this._seed=e},enumerable:true,configurable:true}),t.prototype._next=function(e){if(!this.hasSeed)this.seed=e,this.destination.next(e);else return this._tryNext(e)},t.prototype._tryNext=function(e){var n=this.index++,i;try{i=this.accumulator(this.seed,e,n)}catch(o){this.destination.error(o)}this.seed=i,this.destination.next(i)},t}(QS.Subscriber)});var Dt=c(yo=>{"use strict";Object.defineProperty(yo,"__esModule",{value:true});var Qc=Gr(),Hc=zr(),ZS=Se2(),Kc=gr();function $S(r,t){return arguments.length>=2?function(n){return Kc.pipe(Qc.scan(r,t),Hc.takeLast(1),ZS.defaultIfEmpty(t))(n)}:function(n){return Kc.pipe(Qc.scan(function(i,o,u){return r(i,o,u+1)}),Hc.takeLast(1))(n)}}yo.reduce=$S});var Jc=c(mo=>{"use strict";Object.defineProperty(mo,"__esModule",{value:true});var XS=Dt();function eO(r){var t=typeof r=="function"?function(e,n){return r(e,n)>0?e:n}:function(e,n){return e>n?e:n};return XS.reduce(t)}mo.max=eO});var Zc=c(So=>{"use strict";Object.defineProperty(So,"__esModule",{value:true});var tO=Ti();function rO(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return function(e){return e.lift.call(tO.merge.apply(void 0,[e].concat(r)))}}So.merge=rO});var Xc=c(Oo=>{"use strict";Object.defineProperty(Oo,"__esModule",{value:true});var $c=ut();function nO(r,t,e){return e===void 0&&(e=Number.POSITIVE_INFINITY),typeof t=="function"?$c.mergeMap(function(){return r},t,e):(typeof t=="number"&&(e=t),$c.mergeMap(function(){return r},e))}Oo.mergeMapTo=nO});var ra=c(ee2=>{"use strict";var iO=ee2&&ee2.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(ee2,"__esModule",{value:true});var wo=y();function oO(r,t,e){return e===void 0&&(e=Number.POSITIVE_INFINITY),function(n){return n.lift(new ea(r,t,e))}}ee2.mergeScan=oO;var ea=function(){function r(t,e,n){this.accumulator=t,this.seed=e,this.concurrent=n}return r.prototype.call=function(t,e){return e.subscribe(new ta(t,this.accumulator,this.seed,this.concurrent))},r}();ee2.MergeScanOperator=ea;var ta=function(r){iO(t,r);function t(e,n,i,o){var u=r.call(this,e)||this;return u.accumulator=n,u.acc=i,u.concurrent=o,u.hasValue=false,u.hasCompleted=false,u.buffer=[],u.active=0,u.index=0,u}return t.prototype._next=function(e){if(this.active<this.concurrent){var n=this.index++,i=this.destination,o=void 0;try{var u=this.accumulator;o=u(this.acc,e,n)}catch(s){return i.error(s)}this.active++,this._innerSub(o)}else this.buffer.push(e)},t.prototype._innerSub=function(e){var n=new wo.SimpleInnerSubscriber(this),i=this.destination;i.add(n);var o=wo.innerSubscribe(e,n);o!==n&&i.add(o)},t.prototype._complete=function(){this.hasCompleted=true,this.active===0&&this.buffer.length===0&&(this.hasValue===false&&this.destination.next(this.acc),this.destination.complete()),this.unsubscribe()},t.prototype.notifyNext=function(e){var n=this.destination;this.acc=e,this.hasValue=true,n.next(e)},t.prototype.notifyComplete=function(){var e=this.buffer;this.active--,e.length>0?this._next(e.shift()):this.active===0&&this.hasCompleted&&(this.hasValue===false&&this.destination.next(this.acc),this.destination.complete())},t}(wo.SimpleOuterSubscriber);ee2.MergeScanSubscriber=ta});var na=c(go=>{"use strict";Object.defineProperty(go,"__esModule",{value:true});var uO=Dt();function sO(r){var t=typeof r=="function"?function(e,n){return r(e,n)<0?e:n}:function(e,n){return e<n?e:n};return uO.reduce(t)}go.min=sO});var te=c(Yr=>{"use strict";Object.defineProperty(Yr,"__esModule",{value:true});var cO=Pn();function aO(r,t){return function(n){var i;if(typeof r=="function"?i=r:i=function(){return r},typeof t=="function")return n.lift(new ia(i,t));var o=Object.create(n,cO.connectableObservableDescriptor);return o.source=n,o.subjectFactory=i,o}}Yr.multicast=aO;var ia=function(){function r(t,e){this.subjectFactory=t,this.selector=e}return r.prototype.call=function(t,e){var n=this.selector,i=this.subjectFactory(),o=n(i).subscribe(t);return o.add(e.subscribe(i)),o},r}();Yr.MulticastOperator=ia});var sa=c(we=>{"use strict";var fO=we&&we.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(we,"__esModule",{value:true});var lO=A(),oa=g(),xo=y();function pO(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return r.length===1&&oa.isArray(r[0])&&(r=r[0]),function(e){return e.lift(new ua(r))}}we.onErrorResumeNext=pO;function hO(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var e=void 0;return r.length===1&&oa.isArray(r[0])&&(r=r[0]),e=r.shift(),lO.from(e).lift(new ua(r))}we.onErrorResumeNextStatic=hO;var ua=function(){function r(t){this.nextSources=t}return r.prototype.call=function(t,e){return e.subscribe(new bO(t,this.nextSources))},r}(),bO=function(r){fO(t,r);function t(e,n){var i=r.call(this,e)||this;return i.destination=e,i.nextSources=n,i}return t.prototype.notifyError=function(){this.subscribeToNextSource()},t.prototype.notifyComplete=function(){this.subscribeToNextSource()},t.prototype._error=function(e){this.subscribeToNextSource(),this.unsubscribe()},t.prototype._complete=function(){this.subscribeToNextSource(),this.unsubscribe()},t.prototype.subscribeToNextSource=function(){var e=this.nextSources.shift();if(e){var n=new xo.SimpleInnerSubscriber(this),i=this.destination;i.add(n);var o=xo.innerSubscribe(e,n);o!==n&&i.add(o)}else this.destination.complete()},t}(xo.SimpleOuterSubscriber)});var ca=c(Ut=>{"use strict";var _O=Ut&&Ut.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Ut,"__esModule",{value:true});var vO=_2();function dO(){return function(r){return r.lift(new yO)}}Ut.pairwise=dO;var yO=function(){function r(){}return r.prototype.call=function(t,e){return e.subscribe(new mO(t))},r}(),mO=function(r){_O(t,r);function t(e){var n=r.call(this,e)||this;return n.hasPrev=false,n}return t.prototype._next=function(e){var n;this.hasPrev?n=[this.prev,e]:this.hasPrev=true,this.prev=e,n&&this.destination.next(n)},t}(vO.Subscriber)});var fa=c(qo=>{"use strict";Object.defineProperty(qo,"__esModule",{value:true});var SO=Ri(),aa=K2();function OO(r,t){return function(e){return[aa.filter(r,t)(e),aa.filter(SO.not(r,t))(e)]}}qo.partition=OO});var la=c(jo=>{"use strict";Object.defineProperty(jo,"__esModule",{value:true});var wO=j();function gO(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var e=r.length;if(e===0)throw new Error("list of properties cannot be empty.");return function(n){return wO.map(xO(r,e))(n)}}jo.pluck=gO;function xO(r,t){var e=function(n){for(var i=n,o=0;o<t;o++){var u=i?.[r[o]];if(u!==void 0)i=u;else return}return i};return e}});var ba=c(Po2=>{"use strict";Object.defineProperty(Po2,"__esModule",{value:true});var pa=w2(),ha=te();function qO(r){return r?ha.multicast(function(){return new pa.Subject},r):ha.multicast(new pa.Subject)}Po2.publish=qO});var _a=c(Eo2=>{"use strict";Object.defineProperty(Eo2,"__esModule",{value:true});var jO=Tn(),PO=te();function EO(r){return function(t){return PO.multicast(new jO.BehaviorSubject(r))(t)}}Eo2.publishBehavior=EO});var va=c(Ao2=>{"use strict";Object.defineProperty(Ao2,"__esModule",{value:true});var AO=Ke(),TO=te();function MO(){return function(r){return TO.multicast(new AO.AsyncSubject)(r)}}Ao2.publishLast=MO});var da=c(To2=>{"use strict";Object.defineProperty(To2,"__esModule",{value:true});var CO=Ar(),IO=te();function NO(r,t,e,n){e&&typeof e!="function"&&(n=e);var i=typeof e=="function"?e:void 0,o=new CO.ReplaySubject(r,t,n);return function(u){return IO.multicast(function(){return o},i)(u)}}To2.publishReplay=NO});var ya=c(Mo2=>{"use strict";Object.defineProperty(Mo2,"__esModule",{value:true});var RO=g(),kO=Vi();function VO(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return function(n){return r.length===1&&RO.isArray(r[0])&&(r=r[0]),n.lift.call(kO.race.apply(void 0,[n].concat(r)))}}Mo2.race=VO});var Sa=c(Bt=>{"use strict";var WO=Bt&&Bt.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Bt,"__esModule",{value:true});var FO=_2(),DO=P2();function UO(r){return r===void 0&&(r=-1),function(t){return r===0?DO.empty():r<0?t.lift(new ma(-1,t)):t.lift(new ma(r-1,t))}}Bt.repeat=UO;var ma=function(){function r(t,e){this.count=t,this.source=e}return r.prototype.call=function(t,e){return e.subscribe(new BO(t,this.count,this.source))},r}(),BO=function(r){WO(t,r);function t(e,n,i){var o=r.call(this,e)||this;return o.count=n,o.source=i,o}return t.prototype.complete=function(){if(!this.isStopped){var e=this,n=e.source,i=e.count;if(i===0)return r.prototype.complete.call(this);i>-1&&(this.count=i-1),n.subscribe(this._unsubscribeAndRecycle())}},t}(FO.Subscriber)});var Oa=c(Lt=>{"use strict";var LO=Lt&&Lt.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Lt,"__esModule",{value:true});var zO=w2(),Co=y();function GO(r){return function(t){return t.lift(new YO(r))}}Lt.repeatWhen=GO;var YO=function(){function r(t){this.notifier=t}return r.prototype.call=function(t,e){return e.subscribe(new QO(t,this.notifier,e))},r}(),QO=function(r){LO(t,r);function t(e,n,i){var o=r.call(this,e)||this;return o.notifier=n,o.source=i,o.sourceIsBeingSubscribedTo=true,o}return t.prototype.notifyNext=function(){this.sourceIsBeingSubscribedTo=true,this.source.subscribe(this)},t.prototype.notifyComplete=function(){if(this.sourceIsBeingSubscribedTo===false)return r.prototype.complete.call(this)},t.prototype.complete=function(){if(this.sourceIsBeingSubscribedTo=false,!this.isStopped){if(this.retries||this.subscribeToRetries(),!this.retriesSubscription||this.retriesSubscription.closed)return r.prototype.complete.call(this);this._unsubscribeAndRecycle(),this.notifications.next(void 0)}},t.prototype._unsubscribe=function(){var e=this,n=e.notifications,i=e.retriesSubscription;n&&(n.unsubscribe(),this.notifications=void 0),i&&(i.unsubscribe(),this.retriesSubscription=void 0),this.retries=void 0},t.prototype._unsubscribeAndRecycle=function(){var e=this._unsubscribe;return this._unsubscribe=null,r.prototype._unsubscribeAndRecycle.call(this),this._unsubscribe=e,this},t.prototype.subscribeToRetries=function(){this.notifications=new zO.Subject;var e;try{var n=this.notifier;e=n(this.notifications)}catch{return r.prototype.complete.call(this)}this.retries=e,this.retriesSubscription=Co.innerSubscribe(e,new Co.SimpleInnerSubscriber(this))},t}(Co.SimpleOuterSubscriber)});var wa=c(zt=>{"use strict";var HO=zt&&zt.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(zt,"__esModule",{value:true});var KO=_2();function JO(r){return r===void 0&&(r=-1),function(t){return t.lift(new ZO(r,t))}}zt.retry=JO;var ZO=function(){function r(t,e){this.count=t,this.source=e}return r.prototype.call=function(t,e){return e.subscribe(new $O(t,this.count,this.source))},r}(),$O=function(r){HO(t,r);function t(e,n,i){var o=r.call(this,e)||this;return o.count=n,o.source=i,o}return t.prototype.error=function(e){if(!this.isStopped){var n=this,i=n.source,o=n.count;if(o===0)return r.prototype.error.call(this,e);o>-1&&(this.count=o-1),i.subscribe(this._unsubscribeAndRecycle())}},t}(KO.Subscriber)});var ga=c(Gt=>{"use strict";var XO=Gt&&Gt.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Gt,"__esModule",{value:true});var ew=w2(),Io=y();function tw(r){return function(t){return t.lift(new rw(r,t))}}Gt.retryWhen=tw;var rw=function(){function r(t,e){this.notifier=t,this.source=e}return r.prototype.call=function(t,e){return e.subscribe(new nw(t,this.notifier,this.source))},r}(),nw=function(r){XO(t,r);function t(e,n,i){var o=r.call(this,e)||this;return o.notifier=n,o.source=i,o}return t.prototype.error=function(e){if(!this.isStopped){var n=this.errors,i=this.retries,o=this.retriesSubscription;if(i)this.errors=void 0,this.retriesSubscription=void 0;else{n=new ew.Subject;try{var u=this.notifier;i=u(n)}catch(s){return r.prototype.error.call(this,s)}o=Io.innerSubscribe(i,new Io.SimpleInnerSubscriber(this))}this._unsubscribeAndRecycle(),this.errors=n,this.retries=i,this.retriesSubscription=o,n.next(e)}},t.prototype._unsubscribe=function(){var e=this,n=e.errors,i=e.retriesSubscription;n&&(n.unsubscribe(),this.errors=void 0),i&&(i.unsubscribe(),this.retriesSubscription=void 0),this.retries=void 0},t.prototype.notifyNext=function(){var e=this._unsubscribe;this._unsubscribe=null,this._unsubscribeAndRecycle(),this._unsubscribe=e,this.source.subscribe(this)},t}(Io.SimpleOuterSubscriber)});var xa=c(Yt=>{"use strict";var iw=Yt&&Yt.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Yt,"__esModule",{value:true});var No2=y();function ow(r){return function(t){return t.lift(new uw(r))}}Yt.sample=ow;var uw=function(){function r(t){this.notifier=t}return r.prototype.call=function(t,e){var n=new sw(t),i=e.subscribe(n);return i.add(No2.innerSubscribe(this.notifier,new No2.SimpleInnerSubscriber(n))),i},r}(),sw=function(r){iw(t,r);function t(){var e=r!==null&&r.apply(this,arguments)||this;return e.hasValue=false,e}return t.prototype._next=function(e){this.value=e,this.hasValue=true},t.prototype.notifyNext=function(){this.emitValue()},t.prototype.notifyComplete=function(){this.emitValue()},t.prototype.emitValue=function(){this.hasValue&&(this.hasValue=false,this.destination.next(this.value))},t}(No2.SimpleOuterSubscriber)});var qa=c(Qt=>{"use strict";var cw=Qt&&Qt.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Qt,"__esModule",{value:true});var aw=_2(),fw=x();function lw(r,t){return t===void 0&&(t=fw.async),function(e){return e.lift(new pw(r,t))}}Qt.sampleTime=lw;var pw=function(){function r(t,e){this.period=t,this.scheduler=e}return r.prototype.call=function(t,e){return e.subscribe(new hw(t,this.period,this.scheduler))},r}(),hw=function(r){cw(t,r);function t(e,n,i){var o=r.call(this,e)||this;return o.period=n,o.scheduler=i,o.hasValue=false,o.add(i.schedule(bw,n,{subscriber:o,period:n})),o}return t.prototype._next=function(e){this.lastValue=e,this.hasValue=true},t.prototype.notifyNext=function(){this.hasValue&&(this.hasValue=false,this.destination.next(this.lastValue))},t}(aw.Subscriber);function bw(r){var t=r.subscriber,e=r.period;t.notifyNext(),this.schedule(r,e)}});var Ta=c(re=>{"use strict";var ja=re&&re.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(re,"__esModule",{value:true});var Pa=_2();function _w(r,t){return function(e){return e.lift(new Ea(r,t))}}re.sequenceEqual=_w;var Ea=function(){function r(t,e){this.compareTo=t,this.comparator=e}return r.prototype.call=function(t,e){return e.subscribe(new Aa(t,this.compareTo,this.comparator))},r}();re.SequenceEqualOperator=Ea;var Aa=function(r){ja(t,r);function t(e,n,i){var o=r.call(this,e)||this;return o.compareTo=n,o.comparator=i,o._a=[],o._b=[],o._oneComplete=false,o.destination.add(n.subscribe(new vw(e,o))),o}return t.prototype._next=function(e){this._oneComplete&&this._b.length===0?this.emit(false):(this._a.push(e),this.checkValues())},t.prototype._complete=function(){this._oneComplete?this.emit(this._a.length===0&&this._b.length===0):this._oneComplete=true,this.unsubscribe()},t.prototype.checkValues=function(){for(var e=this,n=e._a,i=e._b,o=e.comparator;n.length>0&&i.length>0;){var u=n.shift(),s=i.shift(),f=false;try{f=o?o(u,s):u===s}catch(a){this.destination.error(a)}f||this.emit(false)}},t.prototype.emit=function(e){var n=this.destination;n.next(e),n.complete()},t.prototype.nextB=function(e){this._oneComplete&&this._a.length===0?this.emit(false):(this._b.push(e),this.checkValues())},t.prototype.completeB=function(){this._oneComplete?this.emit(this._a.length===0&&this._b.length===0):this._oneComplete=true},t}(Pa.Subscriber);re.SequenceEqualSubscriber=Aa;var vw=function(r){ja(t,r);function t(e,n){var i=r.call(this,e)||this;return i.parent=n,i}return t.prototype._next=function(e){this.parent.nextB(e)},t.prototype._error=function(e){this.parent.error(e),this.unsubscribe()},t.prototype._complete=function(){this.parent.completeB(),this.unsubscribe()},t}(Pa.Subscriber)});var Ma=c(Ro2=>{"use strict";Object.defineProperty(Ro2,"__esModule",{value:true});var dw=te(),yw=qr(),mw=w2();function Sw(){return new mw.Subject}function Ow(){return function(r){return yw.refCount()(dw.multicast(Sw)(r))}}Ro2.share=Ow});var Ca=c(ko=>{"use strict";Object.defineProperty(ko,"__esModule",{value:true});var ww=Ar();function gw(r,t,e){var n;return r&&typeof r=="object"?n=r:n={bufferSize:r,windowTime:t,refCount:false,scheduler:e},function(i){return i.lift(xw(n))}}ko.shareReplay=gw;function xw(r){var t=r.bufferSize,e=t===void 0?Number.POSITIVE_INFINITY:t,n=r.windowTime,i=n===void 0?Number.POSITIVE_INFINITY:n,o=r.refCount,u=r.scheduler,s,f=0,a,p=false,b=false;return function(q2){f++;var I;!s||p?(p=false,s=new ww.ReplaySubject(e,i,u),I=s.subscribe(this),a=q2.subscribe({next:function(oe){s.next(oe)},error:function(oe){p=true,s.error(oe)},complete:function(){b=true,a=void 0,s.complete()}}),b&&(a=void 0)):I=s.subscribe(this),this.add(function(){f--,I.unsubscribe(),I=void 0,a&&!b&&o&&f===0&&(a.unsubscribe(),a=void 0,s=void 0)})}}});var Ia=c(Ht=>{"use strict";var qw=Ht&&Ht.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Ht,"__esModule",{value:true});var jw=_2(),Pw=ve2();function Ew(r){return function(t){return t.lift(new Aw(r,t))}}Ht.single=Ew;var Aw=function(){function r(t,e){this.predicate=t,this.source=e}return r.prototype.call=function(t,e){return e.subscribe(new Tw(t,this.predicate,this.source))},r}(),Tw=function(r){qw(t,r);function t(e,n,i){var o=r.call(this,e)||this;return o.predicate=n,o.source=i,o.seenValue=false,o.index=0,o}return t.prototype.applySingleValue=function(e){this.seenValue?this.destination.error("Sequence contains more than one element"):(this.seenValue=true,this.singleValue=e)},t.prototype._next=function(e){var n=this.index++;this.predicate?this.tryNext(e,n):this.applySingleValue(e)},t.prototype.tryNext=function(e,n){try{this.predicate(e,n,this.source)&&this.applySingleValue(e)}catch(i){this.destination.error(i)}},t.prototype._complete=function(){var e=this.destination;this.index>0?(e.next(this.seenValue?this.singleValue:void 0),e.complete()):e.error(new Pw.EmptyError)},t}(jw.Subscriber)});var Na=c(Kt2=>{"use strict";var Mw=Kt2&&Kt2.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Kt2,"__esModule",{value:true});var Cw=_2();function Iw(r){return function(t){return t.lift(new Nw(r))}}Kt2.skip=Iw;var Nw=function(){function r(t){this.total=t}return r.prototype.call=function(t,e){return e.subscribe(new Rw(t,this.total))},r}(),Rw=function(r){Mw(t,r);function t(e,n){var i=r.call(this,e)||this;return i.total=n,i.count=0,i}return t.prototype._next=function(e){++this.count>this.total&&this.destination.next(e)},t}(Cw.Subscriber)});var ka=c(Jt2=>{"use strict";var kw=Jt2&&Jt2.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Jt2,"__esModule",{value:true});var Ra=_2(),Vw=_e2();function Ww(r){return function(t){return t.lift(new Fw(r))}}Jt2.skipLast=Ww;var Fw=function(){function r(t){if(this._skipCount=t,this._skipCount<0)throw new Vw.ArgumentOutOfRangeError}return r.prototype.call=function(t,e){return this._skipCount===0?e.subscribe(new Ra.Subscriber(t)):e.subscribe(new Dw(t,this._skipCount))},r}(),Dw=function(r){kw(t,r);function t(e,n){var i=r.call(this,e)||this;return i._skipCount=n,i._count=0,i._ring=new Array(n),i}return t.prototype._next=function(e){var n=this._skipCount,i=this._count++;if(i<n)this._ring[i]=e;else{var o=i%n,u=this._ring,s=u[o];u[o]=e,this.destination.next(s)}},t}(Ra.Subscriber)});var Va2=c(Zt=>{"use strict";var Uw=Zt&&Zt.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Zt,"__esModule",{value:true});var Vo=y();function Bw(r){return function(t){return t.lift(new Lw(r))}}Zt.skipUntil=Bw;var Lw=function(){function r(t){this.notifier=t}return r.prototype.call=function(t,e){return e.subscribe(new zw(t,this.notifier))},r}(),zw=function(r){Uw(t,r);function t(e,n){var i=r.call(this,e)||this;i.hasValue=false;var o=new Vo.SimpleInnerSubscriber(i);i.add(o),i.innerSubscription=o;var u=Vo.innerSubscribe(n,o);return u!==o&&(i.add(u),i.innerSubscription=u),i}return t.prototype._next=function(e){this.hasValue&&r.prototype._next.call(this,e)},t.prototype.notifyNext=function(){this.hasValue=true,this.innerSubscription&&this.innerSubscription.unsubscribe()},t.prototype.notifyComplete=function(){},t}(Vo.SimpleOuterSubscriber)});var Wa=c($t=>{"use strict";var Gw=$t&&$t.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty($t,"__esModule",{value:true});var Yw=_2();function Qw(r){return function(t){return t.lift(new Hw(r))}}$t.skipWhile=Qw;var Hw=function(){function r(t){this.predicate=t}return r.prototype.call=function(t,e){return e.subscribe(new Kw(t,this.predicate))},r}(),Kw=function(r){Gw(t,r);function t(e,n){var i=r.call(this,e)||this;return i.predicate=n,i.skipping=true,i.index=0,i}return t.prototype._next=function(e){var n=this.destination;this.skipping&&this.tryCallPredicate(e),this.skipping||n.next(e)},t.prototype.tryCallPredicate=function(e){try{var n=this.predicate(e,this.index++);this.skipping=Boolean(n)}catch(i){this.destination.error(i)}},t}(Yw.Subscriber)});var Da=c(Wo=>{"use strict";Object.defineProperty(Wo,"__esModule",{value:true});var Fa=st(),Jw=E();function Zw(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var e=r[r.length-1];return Jw.isScheduler(e)?(r.pop(),function(n){return Fa.concat(r,n,e)}):function(n){return Fa.concat(r,n)}}Wo.startWith=Zw});var Ua=c(Xt2=>{"use strict";var $w=Xt2&&Xt2.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(Xt2,"__esModule",{value:true});var Xw=d2(),Fo2=Ln(),e1=ct(),t1=function(r){$w(t,r);function t(e,n,i){n===void 0&&(n=0),i===void 0&&(i=Fo2.asap);var o=r.call(this)||this;return o.source=e,o.delayTime=n,o.scheduler=i,(!e1.isNumeric(n)||n<0)&&(o.delayTime=0),(!i||typeof i.schedule!="function")&&(o.scheduler=Fo2.asap),o}return t.create=function(e,n,i){return n===void 0&&(n=0),i===void 0&&(i=Fo2.asap),new t(e,n,i)},t.dispatch=function(e){var n=e.source,i=e.subscriber;return this.add(n.subscribe(i))},t.prototype._subscribe=function(e){var n=this.delayTime,i=this.source,o=this.scheduler;return o.schedule(t.dispatch,n,{source:i,subscriber:e})},t}(Xw.Observable);Xt2.SubscribeOnObservable=t1});var Ba=c(Do2=>{"use strict";Object.defineProperty(Do2,"__esModule",{value:true});var r1=Ua();function n1(r,t){return t===void 0&&(t=0),function(n){return n.lift(new i1(r,t))}}Do2.subscribeOn=n1;var i1=function(){function r(t,e){this.scheduler=t,this.delay=e}return r.prototype.call=function(t,e){return new r1.SubscribeOnObservable(e,this.delay,this.scheduler).subscribe(t)},r}()});var Qr=c(er=>{"use strict";var o1=er&&er.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(er,"__esModule",{value:true});var u1=j(),s1=A(),Uo2=y();function La(r,t){return typeof t=="function"?function(e){return e.pipe(La(function(n,i){return s1.from(r(n,i)).pipe(u1.map(function(o,u){return t(n,o,i,u)}))}))}:function(e){return e.lift(new c1(r))}}er.switchMap=La;var c1=function(){function r(t){this.project=t}return r.prototype.call=function(t,e){return e.subscribe(new a1(t,this.project))},r}(),a1=function(r){o1(t,r);function t(e,n){var i=r.call(this,e)||this;return i.project=n,i.index=0,i}return t.prototype._next=function(e){var n,i=this.index++;try{n=this.project(e,i)}catch(o){this.destination.error(o);return}this._innerSub(n)},t.prototype._innerSub=function(e){var n=this.innerSubscription;n&&n.unsubscribe();var i=new Uo2.SimpleInnerSubscriber(this),o=this.destination;o.add(i),this.innerSubscription=Uo2.innerSubscribe(e,i),this.innerSubscription!==i&&o.add(this.innerSubscription)},t.prototype._complete=function(){var e=this.innerSubscription;(!e||e.closed)&&r.prototype._complete.call(this),this.unsubscribe()},t.prototype._unsubscribe=function(){this.innerSubscription=void 0},t.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&r.prototype._complete.call(this)},t.prototype.notifyNext=function(e){this.destination.next(e)},t}(Uo2.SimpleOuterSubscriber)});var za=c(Bo=>{"use strict";Object.defineProperty(Bo,"__esModule",{value:true});var f1=Qr(),l1=V2();function p1(){return f1.switchMap(l1.identity)}Bo.switchAll=p1});var Ya=c(Lo=>{"use strict";Object.defineProperty(Lo,"__esModule",{value:true});var Ga=Qr();function h1(r,t){return t?Ga.switchMap(function(){return r},t):Ga.switchMap(function(){return r})}Lo.switchMapTo=h1});var Qa2=c(tr=>{"use strict";var b1=tr&&tr.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(tr,"__esModule",{value:true});var zo2=y();function _1(r){return function(t){return t.lift(new v1(r))}}tr.takeUntil=_1;var v1=function(){function r(t){this.notifier=t}return r.prototype.call=function(t,e){var n=new d1(t),i=zo2.innerSubscribe(this.notifier,new zo2.SimpleInnerSubscriber(n));return i&&!n.seenValue?(n.add(i),e.subscribe(n)):n},r}(),d1=function(r){b1(t,r);function t(e){var n=r.call(this,e)||this;return n.seenValue=false,n}return t.prototype.notifyNext=function(){this.seenValue=true,this.complete()},t.prototype.notifyComplete=function(){},t}(zo2.SimpleOuterSubscriber)});var Ha=c(rr=>{"use strict";var y1=rr&&rr.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(rr,"__esModule",{value:true});var m1=_2();function S1(r,t){return t===void 0&&(t=false),function(e){return e.lift(new O1(r,t))}}rr.takeWhile=S1;var O1=function(){function r(t,e){this.predicate=t,this.inclusive=e}return r.prototype.call=function(t,e){return e.subscribe(new w1(t,this.predicate,this.inclusive))},r}(),w1=function(r){y1(t,r);function t(e,n,i){var o=r.call(this,e)||this;return o.predicate=n,o.inclusive=i,o.index=0,o}return t.prototype._next=function(e){var n=this.destination,i;try{i=this.predicate(e,this.index++)}catch(o){n.error(o);return}this.nextOrComplete(e,i)},t.prototype.nextOrComplete=function(e,n){var i=this.destination;Boolean(n)?i.next(e):(this.inclusive&&i.next(e),i.complete())},t}(m1.Subscriber)});var Ka=c(nr=>{"use strict";var g1=nr&&nr.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(nr,"__esModule",{value:true});var x1=_2(),B=Cr(),q1=ue();function j1(r,t,e){return function(i){return i.lift(new P1(r,t,e))}}nr.tap=j1;var P1=function(){function r(t,e,n){this.nextOrObserver=t,this.error=e,this.complete=n}return r.prototype.call=function(t,e){return e.subscribe(new E1(t,this.nextOrObserver,this.error,this.complete))},r}(),E1=function(r){g1(t,r);function t(e,n,i,o){var u=r.call(this,e)||this;return u._tapNext=B.noop,u._tapError=B.noop,u._tapComplete=B.noop,u._tapError=i||B.noop,u._tapComplete=o||B.noop,q1.isFunction(n)?(u._context=u,u._tapNext=n):n&&(u._context=n,u._tapNext=n.next||B.noop,u._tapError=n.error||B.noop,u._tapComplete=n.complete||B.noop),u}return t.prototype._next=function(e){try{this._tapNext.call(this._context,e)}catch(n){this.destination.error(n);return}this.destination.next(e)},t.prototype._error=function(e){try{this._tapError.call(this._context,e)}catch(n){this.destination.error(n);return}this.destination.error(e)},t.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(e){this.destination.error(e);return}return this.destination.complete()},t}(x1.Subscriber)});var Yo=c(ne=>{"use strict";var A1=ne&&ne.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(ne,"__esModule",{value:true});var Go2=y();ne.defaultThrottleConfig={leading:true,trailing:false};function T1(r,t){return t===void 0&&(t=ne.defaultThrottleConfig),function(e){return e.lift(new M1(r,!!t.leading,!!t.trailing))}}ne.throttle=T1;var M1=function(){function r(t,e,n){this.durationSelector=t,this.leading=e,this.trailing=n}return r.prototype.call=function(t,e){return e.subscribe(new C1(t,this.durationSelector,this.leading,this.trailing))},r}(),C1=function(r){A1(t,r);function t(e,n,i,o){var u=r.call(this,e)||this;return u.destination=e,u.durationSelector=n,u._leading=i,u._trailing=o,u._hasValue=false,u}return t.prototype._next=function(e){this._hasValue=true,this._sendValue=e,this._throttled||(this._leading?this.send():this.throttle(e))},t.prototype.send=function(){var e=this,n=e._hasValue,i=e._sendValue;n&&(this.destination.next(i),this.throttle(i)),this._hasValue=false,this._sendValue=void 0},t.prototype.throttle=function(e){var n=this.tryDurationSelector(e);n&&this.add(this._throttled=Go2.innerSubscribe(n,new Go2.SimpleInnerSubscriber(this)))},t.prototype.tryDurationSelector=function(e){try{return this.durationSelector(e)}catch(n){return this.destination.error(n),null}},t.prototype.throttlingDone=function(){var e=this,n=e._throttled,i=e._trailing;n&&n.unsubscribe(),this._throttled=void 0,i&&this.send()},t.prototype.notifyNext=function(){this.throttlingDone()},t.prototype.notifyComplete=function(){this.throttlingDone()},t}(Go2.SimpleOuterSubscriber)});var Ja=c(ir=>{"use strict";var I1=ir&&ir.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(ir,"__esModule",{value:true});var N1=_2(),R1=x(),k1=Yo();function V1(r,t,e){return t===void 0&&(t=R1.async),e===void 0&&(e=k1.defaultThrottleConfig),function(n){return n.lift(new W1(r,t,e.leading,e.trailing))}}ir.throttleTime=V1;var W1=function(){function r(t,e,n,i){this.duration=t,this.scheduler=e,this.leading=n,this.trailing=i}return r.prototype.call=function(t,e){return e.subscribe(new F1(t,this.duration,this.scheduler,this.leading,this.trailing))},r}(),F1=function(r){I1(t,r);function t(e,n,i,o,u){var s=r.call(this,e)||this;return s.duration=n,s.scheduler=i,s.leading=o,s.trailing=u,s._hasTrailingValue=false,s._trailingValue=null,s}return t.prototype._next=function(e){this.throttled?this.trailing&&(this._trailingValue=e,this._hasTrailingValue=true):(this.add(this.throttled=this.scheduler.schedule(D1,this.duration,{subscriber:this})),this.leading?this.destination.next(e):this.trailing&&(this._trailingValue=e,this._hasTrailingValue=true))},t.prototype._complete=function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()},t.prototype.clearThrottle=function(){var e=this.throttled;e&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=false),e.unsubscribe(),this.remove(e),this.throttled=null)},t}(N1.Subscriber);function D1(r){var t=r.subscriber;t.clearThrottle()}});var $a=c(Hr=>{"use strict";Object.defineProperty(Hr,"__esModule",{value:true});var U1=x(),B1=Gr(),L1=Vr(),z1=j();function G1(r){return r===void 0&&(r=U1.async),function(t){return L1.defer(function(){return t.pipe(B1.scan(function(e,n){var i=e.current;return{value:n,current:r.now(),last:i}},{current:r.now(),value:void 0,last:void 0}),z1.map(function(e){var n=e.current,i=e.last,o=e.value;return new Za(o,n-i)}))})}}Hr.timeInterval=G1;var Za=function(){function r(t,e){this.value=t,this.interval=e}return r}();Hr.TimeInterval=Za});var Ho2=c(or=>{"use strict";var Y1=or&&or.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(or,"__esModule",{value:true});var Q1=x(),H1=ro(),Qo=y();function K1(r,t,e){return e===void 0&&(e=Q1.async),function(n){var i=H1.isDate(r),o=i?+r-e.now():Math.abs(r);return n.lift(new J1(o,i,t,e))}}or.timeoutWith=K1;var J1=function(){function r(t,e,n,i){this.waitFor=t,this.absoluteTimeout=e,this.withObservable=n,this.scheduler=i}return r.prototype.call=function(t,e){return e.subscribe(new Z1(t,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},r}(),Z1=function(r){Y1(t,r);function t(e,n,i,o,u){var s=r.call(this,e)||this;return s.absoluteTimeout=n,s.waitFor=i,s.withObservable=o,s.scheduler=u,s.scheduleTimeout(),s}return t.dispatchTimeout=function(e){var n=e.withObservable;e._unsubscribeAndRecycle(),e.add(Qo.innerSubscribe(n,new Qo.SimpleInnerSubscriber(e)))},t.prototype.scheduleTimeout=function(){var e=this.action;e?this.action=e.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(t.dispatchTimeout,this.waitFor,this))},t.prototype._next=function(e){this.absoluteTimeout||this.scheduleTimeout(),r.prototype._next.call(this,e)},t.prototype._unsubscribe=function(){this.action=void 0,this.scheduler=null,this.withObservable=null},t}(Qo.SimpleOuterSubscriber)});var Xa=c(Ko=>{"use strict";Object.defineProperty(Ko,"__esModule",{value:true});var $1=x(),X1=Kn(),eg=Ho2(),tg=Er();function rg(r,t){return t===void 0&&(t=$1.async),eg.timeoutWith(r,tg.throwError(new X1.TimeoutError),t)}Ko.timeout=rg});var tf=c(Kr=>{"use strict";Object.defineProperty(Kr,"__esModule",{value:true});var ng=x(),ig=j();function og(r){return r===void 0&&(r=ng.async),ig.map(function(t){return new ef(t,r.now())})}Kr.timestamp=og;var ef=function(){function r(t,e){this.value=t,this.timestamp=e}return r}();Kr.Timestamp=ef});var rf=c(Jo=>{"use strict";Object.defineProperty(Jo,"__esModule",{value:true});var ug=Dt();function sg(r,t,e){return e===0?[t]:(r.push(t),r)}function cg(){return ug.reduce(sg,[])}Jo.toArray=cg});var of=c(ur=>{"use strict";var ag=ur&&ur.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(ur,"__esModule",{value:true});var nf=w2(),Zo2=y();function fg(r){return function(e){return e.lift(new lg(r))}}ur.window=fg;var lg=function(){function r(t){this.windowBoundaries=t}return r.prototype.call=function(t,e){var n=new pg(t),i=e.subscribe(n);return i.closed||n.add(Zo2.innerSubscribe(this.windowBoundaries,new Zo2.SimpleInnerSubscriber(n))),i},r}(),pg=function(r){ag(t,r);function t(e){var n=r.call(this,e)||this;return n.window=new nf.Subject,e.next(n.window),n}return t.prototype.notifyNext=function(){this.openWindow()},t.prototype.notifyError=function(e){this._error(e)},t.prototype.notifyComplete=function(){this._complete()},t.prototype._next=function(e){this.window.next(e)},t.prototype._error=function(e){this.window.error(e),this.destination.error(e)},t.prototype._complete=function(){this.window.complete(),this.destination.complete()},t.prototype._unsubscribe=function(){this.window=null},t.prototype.openWindow=function(){var e=this.window;e&&e.complete();var n=this.destination,i=this.window=new nf.Subject;n.next(i)},t}(Zo2.SimpleOuterSubscriber)});var sf=c(sr=>{"use strict";var hg=sr&&sr.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(sr,"__esModule",{value:true});var bg=_2(),uf=w2();function _g(r,t){return t===void 0&&(t=0),function(n){return n.lift(new vg(r,t))}}sr.windowCount=_g;var vg=function(){function r(t,e){this.windowSize=t,this.startWindowEvery=e}return r.prototype.call=function(t,e){return e.subscribe(new dg(t,this.windowSize,this.startWindowEvery))},r}(),dg=function(r){hg(t,r);function t(e,n,i){var o=r.call(this,e)||this;return o.destination=e,o.windowSize=n,o.startWindowEvery=i,o.windows=[new uf.Subject],o.count=0,e.next(o.windows[0]),o}return t.prototype._next=function(e){for(var n=this.startWindowEvery>0?this.startWindowEvery:this.windowSize,i=this.destination,o=this.windowSize,u=this.windows,s=u.length,f=0;f<s&&!this.closed;f++)u[f].next(e);var a=this.count-o+1;if(a>=0&&a%n===0&&!this.closed&&u.shift().complete(),++this.count%n===0&&!this.closed){var p=new uf.Subject;u.push(p),i.next(p)}},t.prototype._error=function(e){var n=this.windows;if(n)for(;n.length>0&&!this.closed;)n.shift().error(e);this.destination.error(e)},t.prototype._complete=function(){var e=this.windows;if(e)for(;e.length>0&&!this.closed;)e.shift().complete();this.destination.complete()},t.prototype._unsubscribe=function(){this.count=0,this.windows=null},t}(bg.Subscriber)});var lf=c(cr=>{"use strict";var af=cr&&cr.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(cr,"__esModule",{value:true});var yg=w2(),mg=x(),Sg=_2(),cf=ct(),$o=E();function Og(r){var t=mg.async,e=null,n=Number.POSITIVE_INFINITY;return $o.isScheduler(arguments[3])&&(t=arguments[3]),$o.isScheduler(arguments[2])?t=arguments[2]:cf.isNumeric(arguments[2])&&(n=Number(arguments[2])),$o.isScheduler(arguments[1])?t=arguments[1]:cf.isNumeric(arguments[1])&&(e=Number(arguments[1])),function(o){return o.lift(new wg(r,e,n,t))}}cr.windowTime=Og;var wg=function(){function r(t,e,n,i){this.windowTimeSpan=t,this.windowCreationInterval=e,this.maxWindowSize=n,this.scheduler=i}return r.prototype.call=function(t,e){return e.subscribe(new xg(t,this.windowTimeSpan,this.windowCreationInterval,this.maxWindowSize,this.scheduler))},r}(),gg=function(r){af(t,r);function t(){var e=r!==null&&r.apply(this,arguments)||this;return e._numberOfNextedValues=0,e}return t.prototype.next=function(e){this._numberOfNextedValues++,r.prototype.next.call(this,e)},Object.defineProperty(t.prototype,"numberOfNextedValues",{get:function(){return this._numberOfNextedValues},enumerable:true,configurable:true}),t}(yg.Subject),xg=function(r){af(t,r);function t(e,n,i,o,u){var s=r.call(this,e)||this;s.destination=e,s.windowTimeSpan=n,s.windowCreationInterval=i,s.maxWindowSize=o,s.scheduler=u,s.windows=[];var f=s.openWindow();if(i!==null&&i>=0){var a={subscriber:s,window:f,context:null},p={windowTimeSpan:n,windowCreationInterval:i,subscriber:s,scheduler:u};s.add(u.schedule(ff,n,a)),s.add(u.schedule(jg,i,p))}else{var b={subscriber:s,window:f,windowTimeSpan:n};s.add(u.schedule(qg,n,b))}return s}return t.prototype._next=function(e){for(var n=this.windows,i=n.length,o=0;o<i;o++){var u=n[o];u.closed||(u.next(e),u.numberOfNextedValues>=this.maxWindowSize&&this.closeWindow(u))}},t.prototype._error=function(e){for(var n=this.windows;n.length>0;)n.shift().error(e);this.destination.error(e)},t.prototype._complete=function(){for(var e=this.windows;e.length>0;){var n=e.shift();n.closed||n.complete()}this.destination.complete()},t.prototype.openWindow=function(){var e=new gg;this.windows.push(e);var n=this.destination;return n.next(e),e},t.prototype.closeWindow=function(e){e.complete();var n=this.windows;n.splice(n.indexOf(e),1)},t}(Sg.Subscriber);function qg(r){var t=r.subscriber,e=r.windowTimeSpan,n=r.window;n&&t.closeWindow(n),r.window=t.openWindow(),this.schedule(r,e)}function jg(r){var t=r.windowTimeSpan,e=r.subscriber,n=r.scheduler,i=r.windowCreationInterval,o=e.openWindow(),u=this,s={action:u,subscription:null},f={subscriber:e,window:o,context:s};s.subscription=n.schedule(ff,t,f),u.add(s.subscription),u.schedule(r,i)}function ff(r){var t=r.subscriber,e=r.window,n=r.context;n&&n.action&&n.subscription&&n.action.remove(n.subscription),t.closeWindow(e)}});var hf=c(ar=>{"use strict";var Pg=ar&&ar.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(ar,"__esModule",{value:true});var Eg=w2(),Ag=O2(),Tg=F2(),pf=D2();function Mg(r,t){return function(e){return e.lift(new Cg(r,t))}}ar.windowToggle=Mg;var Cg=function(){function r(t,e){this.openings=t,this.closingSelector=e}return r.prototype.call=function(t,e){return e.subscribe(new Ig(t,this.openings,this.closingSelector))},r}(),Ig=function(r){Pg(t,r);function t(e,n,i){var o=r.call(this,e)||this;return o.openings=n,o.closingSelector=i,o.contexts=[],o.add(o.openSubscription=pf.subscribeToResult(o,n,n)),o}return t.prototype._next=function(e){var n=this.contexts;if(n)for(var i=n.length,o=0;o<i;o++)n[o].window.next(e)},t.prototype._error=function(e){var n=this.contexts;if(this.contexts=null,n)for(var i=n.length,o=-1;++o<i;){var u=n[o];u.window.error(e),u.subscription.unsubscribe()}r.prototype._error.call(this,e)},t.prototype._complete=function(){var e=this.contexts;if(this.contexts=null,e)for(var n=e.length,i=-1;++i<n;){var o=e[i];o.window.complete(),o.subscription.unsubscribe()}r.prototype._complete.call(this)},t.prototype._unsubscribe=function(){var e=this.contexts;if(this.contexts=null,e)for(var n=e.length,i=-1;++i<n;){var o=e[i];o.window.unsubscribe(),o.subscription.unsubscribe()}},t.prototype.notifyNext=function(e,n,i,o,u){if(e===this.openings){var s=void 0;try{var f=this.closingSelector;s=f(n)}catch(q2){return this.error(q2)}var a=new Eg.Subject,p=new Ag.Subscription,b={window:a,subscription:p};this.contexts.push(b);var v=pf.subscribeToResult(this,s,b);v.closed?this.closeWindow(this.contexts.length-1):(v.context=b,p.add(v)),this.destination.next(a)}else this.closeWindow(this.contexts.indexOf(e))},t.prototype.notifyError=function(e){this.error(e)},t.prototype.notifyComplete=function(e){e!==this.openSubscription&&this.closeWindow(this.contexts.indexOf(e.context))},t.prototype.closeWindow=function(e){if(e!==-1){var n=this.contexts,i=n[e],o=i.window,u=i.subscription;n.splice(e,1),o.complete(),u.unsubscribe()}},t}(Tg.OuterSubscriber)});var bf=c(fr=>{"use strict";var Ng=fr&&fr.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(fr,"__esModule",{value:true});var Rg=w2(),kg=F2(),Vg=D2();function Wg(r){return function(e){return e.lift(new Fg(r))}}fr.windowWhen=Wg;var Fg=function(){function r(t){this.closingSelector=t}return r.prototype.call=function(t,e){return e.subscribe(new Dg(t,this.closingSelector))},r}(),Dg=function(r){Ng(t,r);function t(e,n){var i=r.call(this,e)||this;return i.destination=e,i.closingSelector=n,i.openWindow(),i}return t.prototype.notifyNext=function(e,n,i,o,u){this.openWindow(u)},t.prototype.notifyError=function(e){this._error(e)},t.prototype.notifyComplete=function(e){this.openWindow(e)},t.prototype._next=function(e){this.window.next(e)},t.prototype._error=function(e){this.window.error(e),this.destination.error(e),this.unsubscribeClosingNotification()},t.prototype._complete=function(){this.window.complete(),this.destination.complete(),this.unsubscribeClosingNotification()},t.prototype.unsubscribeClosingNotification=function(){this.closingNotification&&this.closingNotification.unsubscribe()},t.prototype.openWindow=function(e){e===void 0&&(e=null),e&&(this.remove(e),e.unsubscribe());var n=this.window;n&&n.complete();var i=this.window=new Rg.Subject;this.destination.next(i);var o;try{var u=this.closingSelector;o=u()}catch(s){this.destination.error(s),this.window.error(s);return}this.add(this.closingNotification=Vg.subscribeToResult(this,o))},t}(kg.OuterSubscriber)});var _f=c(lr=>{"use strict";var Ug=lr&&lr.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(lr,"__esModule",{value:true});var Bg=F2(),Lg=D2();function zg(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return function(e){var n;typeof r[r.length-1]=="function"&&(n=r.pop());var i=r;return e.lift(new Gg(i,n))}}lr.withLatestFrom=zg;var Gg=function(){function r(t,e){this.observables=t,this.project=e}return r.prototype.call=function(t,e){return e.subscribe(new Yg(t,this.observables,this.project))},r}(),Yg=function(r){Ug(t,r);function t(e,n,i){var o=r.call(this,e)||this;o.observables=n,o.project=i,o.toRespond=[];var u=n.length;o.values=new Array(u);for(var s=0;s<u;s++)o.toRespond.push(s);for(var s=0;s<u;s++){var f=n[s];o.add(Lg.subscribeToResult(o,f,void 0,s))}return o}return t.prototype.notifyNext=function(e,n,i){this.values[i]=n;var o=this.toRespond;if(o.length>0){var u=o.indexOf(i);u!==-1&&o.splice(u,1)}},t.prototype.notifyComplete=function(){},t.prototype._next=function(e){if(this.toRespond.length===0){var n=[e].concat(this.values);this.project?this._tryProject(n):this.destination.next(n)}},t.prototype._tryProject=function(e){var n;try{n=this.project.apply(this,e)}catch(i){this.destination.error(i);return}this.destination.next(n)},t}(Bg.OuterSubscriber)});var vf=c(Xo=>{"use strict";Object.defineProperty(Xo,"__esModule",{value:true});var Qg=Br();function Hg(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return function(n){return n.lift.call(Qg.zip.apply(void 0,[n].concat(r)))}}Xo.zip=Hg});var df=c(eu=>{"use strict";Object.defineProperty(eu,"__esModule",{value:true});var Kg=Br();function Jg(r){return function(t){return t.lift(new Kg.ZipOperator(r))}}eu.zipAll=Jg});var ge2=c(l=>{"use strict";Object.defineProperty(l,"__esModule",{value:true});var Zg=Li();l.audit=Zg.audit;var $g=ec();l.auditTime=$g.auditTime;var Xg=tc();l.buffer=Xg.buffer;var ex=ic();l.bufferCount=ex.bufferCount;var tx=sc();l.bufferTime=tx.bufferTime;var rx=ac();l.bufferToggle=rx.bufferToggle;var nx=fc();l.bufferWhen=nx.bufferWhen;var ix=lc();l.catchError=ix.catchError;var ox=pc();l.combineAll=ox.combineAll;var ux=hc();l.combineLatest=ux.combineLatest;var sx=bc();l.concat=sx.concat;var cx=mi();l.concatAll=cx.concatAll;var ax=$i();l.concatMap=ax.concatMap;var fx=_c();l.concatMapTo=fx.concatMapTo;var lx=vc();l.count=lx.count;var px=dc();l.debounce=px.debounce;var hx=yc();l.debounceTime=hx.debounceTime;var bx=Se2();l.defaultIfEmpty=bx.defaultIfEmpty;var _x=Sc();l.delay=_x.delay;var vx=wc();l.delayWhen=vx.delayWhen;var dx=gc();l.dematerialize=dx.dematerialize;var yx=qc();l.distinct=yx.distinct;var mx=oo();l.distinctUntilChanged=mx.distinctUntilChanged;var Sx=jc();l.distinctUntilKeyChanged=Sx.distinctUntilKeyChanged;var Ox=Ec();l.elementAt=Ox.elementAt;var wx=Ac();l.endWith=wx.endWith;var gx=Tc();l.every=gx.every;var xx=Mc();l.exhaust=xx.exhaust;var qx=Ic();l.exhaustMap=qx.exhaustMap;var jx=kc();l.expand=jx.expand;var Px=K2();l.filter=Px.filter;var Ex=Vc();l.finalize=Ex.finalize;var Ax=po();l.find=Ax.find;var Tx=Dc();l.findIndex=Tx.findIndex;var Mx=Uc();l.first=Mx.first;var Cx=An();l.groupBy=Cx.groupBy;var Ix=Bc();l.ignoreElements=Ix.ignoreElements;var Nx=Lc();l.isEmpty=Nx.isEmpty;var Rx=zc();l.last=Rx.last;var kx=j();l.map=kx.map;var Vx=Gc();l.mapTo=Vx.mapTo;var Wx=Yc2();l.materialize=Wx.materialize;var Fx=Jc();l.max=Fx.max;var Dx=Zc();l.merge=Dx.merge;var Ux=kr();l.mergeAll=Ux.mergeAll;var yf=ut();l.mergeMap=yf.mergeMap;l.flatMap=yf.flatMap;var Bx=Xc();l.mergeMapTo=Bx.mergeMapTo;var Lx=ra();l.mergeScan=Lx.mergeScan;var zx=na();l.min=zx.min;var Gx=te();l.multicast=Gx.multicast;var Yx=Bn();l.observeOn=Yx.observeOn;var Qx=sa();l.onErrorResumeNext=Qx.onErrorResumeNext;var Hx=ca();l.pairwise=Hx.pairwise;var Kx=fa();l.partition=Kx.partition;var Jx=la();l.pluck=Jx.pluck;var Zx=ba();l.publish=Zx.publish;var $x=_a();l.publishBehavior=$x.publishBehavior;var Xx=va();l.publishLast=Xx.publishLast;var eq=da();l.publishReplay=eq.publishReplay;var tq=ya();l.race=tq.race;var rq=Dt();l.reduce=rq.reduce;var nq=Sa();l.repeat=nq.repeat;var iq=Oa();l.repeatWhen=iq.repeatWhen;var oq=wa();l.retry=oq.retry;var uq=ga();l.retryWhen=uq.retryWhen;var sq=qr();l.refCount=sq.refCount;var cq=xa();l.sample=cq.sample;var aq=qa();l.sampleTime=aq.sampleTime;var fq=Gr();l.scan=fq.scan;var lq=Ta();l.sequenceEqual=lq.sequenceEqual;var pq=Ma();l.share=pq.share;var hq=Ca();l.shareReplay=hq.shareReplay;var bq=Ia();l.single=bq.single;var _q=Na();l.skip=_q.skip;var vq=ka();l.skipLast=vq.skipLast;var dq=Va2();l.skipUntil=dq.skipUntil;var yq=Wa();l.skipWhile=yq.skipWhile;var mq=Da();l.startWith=mq.startWith;var Sq=Ba();l.subscribeOn=Sq.subscribeOn;var Oq=za();l.switchAll=Oq.switchAll;var wq=Qr();l.switchMap=wq.switchMap;var gq=Ya();l.switchMapTo=gq.switchMapTo;var xq=Lr();l.take=xq.take;var qq=zr();l.takeLast=qq.takeLast;var jq=Qa2();l.takeUntil=jq.takeUntil;var Pq=Ha();l.takeWhile=Pq.takeWhile;var Eq=Ka();l.tap=Eq.tap;var Aq=Yo();l.throttle=Aq.throttle;var Tq=Ja();l.throttleTime=Tq.throttleTime;var Mq=Et();l.throwIfEmpty=Mq.throwIfEmpty;var Cq=$a();l.timeInterval=Cq.timeInterval;var Iq=Xa();l.timeout=Iq.timeout;var Nq=Ho2();l.timeoutWith=Nq.timeoutWith;var Rq=tf();l.timestamp=Rq.timestamp;var kq=rf();l.toArray=kq.toArray;var Vq=of();l.window=Vq.window;var Wq=sf();l.windowCount=Wq.windowCount;var Fq=lf();l.windowTime=Fq.windowTime;var Dq=hf();l.windowToggle=Dq.windowToggle;var Uq=bf();l.windowWhen=Uq.windowWhen;var Bq=_f();l.withLatestFrom=Bq.withLatestFrom;var Lq=vf();l.zip=Lq.zip;var zq=df();l.zipAll=zq.zipAll});var wf=c(T=>{"use strict";Object.defineProperty(T,"__esModule",{value:true});var Jr=ge2();function Gq(r){return r.pipe(Jr.concatMap(function(t){return t.split("")}),Jr.scan(function(t,e){return t.indexOf("}")>=0?e:t+e},""),Jr.filter(function(t){return t.indexOf("}")>=0}),Jr.map(function(t){return JSON.parse(t)}))}T.parseControl=Gq;function mf(r){for(var t=[],e=0;e<r.length;e++)e%3===0?t.push(r[e]<<4|r[e+1]>>4):(t.push((r[e]&15)<<8|r[e+1]),e++);return t}T.decodeUnsigned12BitData=mf;function Sf(r){for(var t=[],e=0;e<r.length;e=e+3)t.push(r[e]<<16|r[e+1]<<8|r[e+2]);return t}T.decodeUnsigned24BitData=Sf;function Yq(r){return mf(r).map(function(t){return .48828125*(t-2048)})}T.decodeEEGSamples=Yq;function Qq(r){return Sf(r)}T.decodePPGSamples=Qq;function Hq(r){return{sequenceId:r.getUint16(0),batteryLevel:r.getUint16(2)/512,fuelGaugeVoltage:r.getUint16(4)*2.2,temperature:r.getUint16(8)}}T.parseTelemetry=Hq;function Of(r,t){function e(n){return{x:t*r.getInt16(n),y:t*r.getInt16(n+2),z:t*r.getInt16(n+4)}}return{sequenceId:r.getUint16(0),samples:[e(2),e(8),e(14)]}}function Kq(r){return Of(r,610352e-10)}T.parseAccelerometer=Kq;function Jq(r){return Of(r,.0074768)}T.parseGyroscope=Jq});var qf=c(R2=>{"use strict";var Zq=R2&&R2.__awaiter||function(r,t,e,n){return new(e||(e=Promise))(function(i,o){function u(a){try{f(n.next(a))}catch(p){o(p)}}function s(a){try{f(n.throw(a))}catch(p){o(p)}}function f(a){a.done?i(a.value):new e(function(p){p(a.value)}).then(u,s)}f((n=n.apply(r,t||[])).next())})},$q=R2&&R2.__generator||function(r,t){var e={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,u;return u={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function s(a){return function(p){return f([a,p])}}function f(a){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,i&&(o=a[0]&2?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[a[0]&2,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return e.label++,{value:a[1],done:false};case 5:e.label++,i=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(o=e.trys,!(o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){e.label=a[1];break}if(a[0]===6&&e.label<o[1]){e.label=o[1],o=a;break}if(o&&e.label<o[2]){e.label=o[2],e.ops.push(a);break}o[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(p){a=[6,p],i=0}finally{n=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};Object.defineProperty(R2,"__esModule",{value:true});var gf=lt(),xf=ge2();function Xq(r){return new TextDecoder().decode(r.subarray(1,1+r[0]))}R2.decodeResponse=Xq;function ej(r){var t=new TextEncoder().encode("X"+r+`
`);return t[0]=t.length-1,t}R2.encodeCommand=ej;function tj(r){return Zq(this,void 0,void 0,function(){var t;return $q(this,function(e){switch(e.label){case 0:return[4,r.startNotifications()];case 1:return e.sent(),t=gf.fromEvent(r.service.device,"gattserverdisconnected"),[2,gf.fromEvent(r,"characteristicvaluechanged").pipe(xf.takeUntil(t),xf.map(function(n){return n.target.value}))]}})})}R2.observableCharacteristic=tj});var jf=c(ru=>{"use strict";Object.defineProperty(ru,"__esModule",{value:true});var Zr=lt(),tu=ge2(),rj=$r();function nj(r){var t=[],e=null;return r.pipe(tu.mergeMap(function(n){if(n.timestamp!==e&&(e=n.timestamp,t.length)){var i=Zr.from([t.slice()]);return t.splice(0,t.length,n),i}return t.push(n),Zr.from([])}),tu.concat(Zr.from([t])),tu.mergeMap(function(n){var i=n[0].samples.map(function(o,u){for(var s=[NaN,NaN,NaN,NaN,NaN],f=0,a=n;f<a.length;f++){var p=a[f];s[p.electrode]=p.samples[u]}return{data:s,index:n[0].index,timestamp:n[0].timestamp+u*1e3/rj.EEG_FREQUENCY}});return Zr.from(i)}))}ru.zipSamples=nj});var Pf=c(iu=>{"use strict";Object.defineProperty(iu,"__esModule",{value:true});var Xr=lt(),nu=ge2(),ij=$r();function oj(r){var t=[],e=null;return r.pipe(nu.mergeMap(function(n){if(n.timestamp!==e&&(e=n.timestamp,t.length)){var i=Xr.from([t.slice()]);return t.splice(0,t.length,n),i}return t.push(n),Xr.from([])}),nu.concat(Xr.from([t])),nu.mergeMap(function(n){var i=n[0].samples.map(function(o,u){for(var s=[NaN,NaN,NaN],f=0,a=n;f<a.length;f++){var p=a[f];s[p.ppgChannel]=p.samples[u]}return{data:s,index:n[0].index,timestamp:n[0].timestamp+u*1e3/ij.PPG_FREQUENCY}});return Xr.from(i)}))}iu.zipSamplesPpg=oj});var $r=c(m=>{"use strict";var ie2=m&&m.__awaiter||function(r,t,e,n){return new(e||(e=Promise))(function(i,o){function u(a){try{f(n.next(a))}catch(p){o(p)}}function s(a){try{f(n.throw(a))}catch(p){o(p)}}function f(a){a.done?i(a.value):new e(function(p){p(a.value)}).then(u,s)}f((n=n.apply(r,t||[])).next())})},k=m&&m.__generator||function(r,t){var e={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,u;return u={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function s(a){return function(p){return f([a,p])}}function f(a){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,i&&(o=a[0]&2?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[a[0]&2,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return e.label++,{value:a[1],done:false};case 5:e.label++,i=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(o=e.trys,!(o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){e.label=a[1];break}if(a[0]===6&&e.label<o[1]){e.label=o[1],o=a;break}if(o&&e.label<o[2]){e.label=o[2],e.ops.push(a);break}o[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(p){a=[6,p],i=0}finally{n=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};Object.defineProperty(m,"__esModule",{value:true});var pr=lt(),M2=ge2(),xe=wf(),C=qf(),uj=jf();m.zipSamples=uj.zipSamples;var sj=Pf();m.zipSamplesPpg=sj.zipSamplesPpg;m.MUSE_SERVICE=65165;var cj="273e0001-4c4d-454d-96be-f03bac821358",aj="273e000b-4c4d-454d-96be-f03bac821358",fj="273e0009-4c4d-454d-96be-f03bac821358",lj="273e000a-4c4d-454d-96be-f03bac821358",Ef=["273e000f-4c4d-454d-96be-f03bac821358","273e0010-4c4d-454d-96be-f03bac821358","273e0011-4c4d-454d-96be-f03bac821358"];m.PPG_FREQUENCY=64;m.PPG_SAMPLES_PER_READING=6;var Af=["273e0003-4c4d-454d-96be-f03bac821358","273e0004-4c4d-454d-96be-f03bac821358","273e0005-4c4d-454d-96be-f03bac821358","273e0006-4c4d-454d-96be-f03bac821358","273e0007-4c4d-454d-96be-f03bac821358"];m.EEG_FREQUENCY=256;m.EEG_SAMPLES_PER_READING=12;m.ppgChannelNames=["ambient","infrared","red"];m.channelNames=["TP9","AF7","AF8","TP10","AUX"];var pj=function(){function r(){this.enableAux=false,this.enablePpg=false,this.deviceName="",this.connectionStatus=new pr.BehaviorSubject(false),this.gatt=null,this.lastIndex=null,this.lastTimestamp=null}return r.prototype.connect=function(t){return ie2(this,void 0,void 0,function(){var e,n,i,o,u,s,f,a,p,b,v,q2,I,oe,ou,hr,en2,uu,su,cu,br,_r=this;return k(this,function(S){switch(S.label){case 0:return t?(this.gatt=t,[3,4]):[3,1];case 1:return[4,navigator.bluetooth.requestDevice({filters:[{services:[m.MUSE_SERVICE]}]})];case 2:return e=S.sent(),n=this,[4,e.gatt.connect()];case 3:n.gatt=S.sent(),S.label=4;case 4:return this.deviceName=this.gatt.device.name||null,[4,this.gatt.getPrimaryService(m.MUSE_SERVICE)];case 5:return i=S.sent(),pr.fromEvent(this.gatt.device,"gattserverdisconnected").pipe(M2.first()).subscribe(function(){_r.gatt=null,_r.connectionStatus.next(false)}),o=this,[4,i.getCharacteristic(cj)];case 6:return o.controlChar=S.sent(),u=this,[4,C.observableCharacteristic(this.controlChar)];case 7:return u.rawControlData=S.sent().pipe(M2.map(function(L){return C.decodeResponse(new Uint8Array(L.buffer))}),M2.share()),this.controlResponses=xe.parseControl(this.rawControlData),[4,i.getCharacteristic(aj)];case 8:return s=S.sent(),f=this,[4,C.observableCharacteristic(s)];case 9:return f.telemetryData=S.sent().pipe(M2.map(xe.parseTelemetry)),[4,i.getCharacteristic(fj)];case 10:return a=S.sent(),p=this,[4,C.observableCharacteristic(a)];case 11:return p.gyroscopeData=S.sent().pipe(M2.map(xe.parseGyroscope)),[4,i.getCharacteristic(lj)];case 12:return b=S.sent(),v=this,[4,C.observableCharacteristic(b)];case 13:if(v.accelerometerData=S.sent().pipe(M2.map(xe.parseAccelerometer)),this.eventMarkers=new pr.Subject,!this.enablePpg)return[3,18];this.ppgCharacteristics=[],q2=[],I=Ef.length,oe=function(L){var qe,z2,je,Pe2;return k(this,function(G){switch(G.label){case 0:return qe=Ef[L],[4,i.getCharacteristic(qe)];case 1:return z2=G.sent(),Pe2=(je=q2).push,[4,C.observableCharacteristic(z2)];case 2:return Pe2.apply(je,[G.sent().pipe(M2.map(function(Ee2){var Ae2=Ee2.getUint16(0);return{index:Ae2,ppgChannel:L,samples:xe.decodePPGSamples(new Uint8Array(Ee2.buffer).subarray(2)),timestamp:_r.getTimestamp(Ae2,m.PPG_SAMPLES_PER_READING,m.PPG_FREQUENCY)}}))]),ou.ppgCharacteristics.push(z2),[2]}})},ou=this,hr=0,S.label=14;case 14:return hr<I?[5,oe(hr)]:[3,17];case 15:S.sent(),S.label=16;case 16:return hr++,[3,14];case 17:this.ppgReadings=pr.merge.apply(void 0,q2),S.label=18;case 18:this.eegCharacteristics=[],en2=[],uu=this.enableAux?Af.length:4,su=function(L){var qe,z2,je,Pe2;return k(this,function(G){switch(G.label){case 0:return qe=Af[L],[4,i.getCharacteristic(qe)];case 1:return z2=G.sent(),Pe2=(je=en2).push,[4,C.observableCharacteristic(z2)];case 2:return Pe2.apply(je,[G.sent().pipe(M2.map(function(Ee2){var Ae2=Ee2.getUint16(0);return{electrode:L,index:Ae2,samples:xe.decodeEEGSamples(new Uint8Array(Ee2.buffer).subarray(2)),timestamp:_r.getTimestamp(Ae2,m.EEG_SAMPLES_PER_READING,m.EEG_FREQUENCY)}}))]),cu.eegCharacteristics.push(z2),[2]}})},cu=this,br=0,S.label=19;case 19:return br<uu?[5,su(br)]:[3,22];case 20:S.sent(),S.label=21;case 21:return br++,[3,19];case 22:return this.eegReadings=pr.merge.apply(void 0,en2),this.connectionStatus.next(true),[2]}})})},r.prototype.sendCommand=function(t){return ie2(this,void 0,void 0,function(){return k(this,function(e){switch(e.label){case 0:return[4,this.controlChar.writeValue(C.encodeCommand(t))];case 1:return e.sent(),[2]}})})},r.prototype.start=function(){return ie2(this,void 0,void 0,function(){var t;return k(this,function(e){switch(e.label){case 0:return[4,this.pause()];case 1:return e.sent(),t="p21",this.enablePpg?t="p50":this.enableAux&&(t="p20"),[4,this.controlChar.writeValue(C.encodeCommand(t))];case 2:return e.sent(),[4,this.controlChar.writeValue(C.encodeCommand("s"))];case 3:return e.sent(),[4,this.resume()];case 4:return e.sent(),[2]}})})},r.prototype.pause=function(){return ie2(this,void 0,void 0,function(){return k(this,function(t){switch(t.label){case 0:return[4,this.sendCommand("h")];case 1:return t.sent(),[2]}})})},r.prototype.resume=function(){return ie2(this,void 0,void 0,function(){return k(this,function(t){switch(t.label){case 0:return[4,this.sendCommand("d")];case 1:return t.sent(),[2]}})})},r.prototype.deviceInfo=function(){return ie2(this,void 0,void 0,function(){var t;return k(this,function(e){switch(e.label){case 0:return t=this.controlResponses.pipe(M2.filter(function(n){return!!n.fw}),M2.take(1)).toPromise(),[4,this.sendCommand("v1")];case 1:return e.sent(),[2,t]}})})},r.prototype.injectMarker=function(t,e){return e===void 0&&(e=new Date().getTime()),ie2(this,void 0,void 0,function(){return k(this,function(n){switch(n.label){case 0:return[4,this.eventMarkers.next({value:t,timestamp:e})];case 1:return n.sent(),[2]}})})},r.prototype.disconnect=function(){this.gatt&&(this.lastIndex=null,this.lastTimestamp=null,this.gatt.disconnect(),this.connectionStatus.next(false))},r.prototype.getTimestamp=function(t,e,n){var i=1e3*(1/n)*e;for((this.lastIndex===null||this.lastTimestamp===null)&&(this.lastIndex=t,this.lastTimestamp=new Date().getTime()-i);this.lastIndex-t>4096;)t+=65536;return t===this.lastIndex?this.lastTimestamp:t>this.lastIndex?(this.lastTimestamp+=i*(t-this.lastIndex),this.lastIndex=t,this.lastTimestamp):this.lastTimestamp-i*(this.lastIndex-t)},r}();m.MuseClient=pj});var hj=kf($r(),1);var export_MuseClient=hj.MuseClient;var sps10=250;var defaultsetting5={sps:sps10,useDCBlock:true,useBandpass:true,bandpassLower:3,bandpassUpper:45};var museFilterSettings={"0":JSON.parse(JSON.stringify(defaultsetting5)),"1":JSON.parse(JSON.stringify(defaultsetting5)),"2":JSON.parse(JSON.stringify(defaultsetting5)),"3":JSON.parse(JSON.stringify(defaultsetting5)),"4":JSON.parse(JSON.stringify(defaultsetting5))};function hrcodec(data){return{hr:data.getInt8(1),timestamp:Date.now()}}var heartRateBLESettings={services:{"heart_rate":{"heart_rate_measurement":{notify:true,notifyCallback:void 0,codec:hrcodec}}}};var simulatorSettings={sps:250,simulate:{"0":{sps:250,freq:1,amplitude:1,offset:0},"1":{sps:250,freq:10,amplitude:1,offset:0},"2":{sps:250,freq:100,amplitude:.5,offset:.5},"3":{sps:250,freq:25,amplitude:1,offset:0}},connect:(settings={})=>{return new Promise(async(res,rej)=>{let _id=`simulated${Math.floor(Math.random()*1e15)}`;let info={_id,settings:Object.assign(Object.assign({},simulatorSettings),settings)};info.settings.looping=true;let loopTime=50;let lastTime=Date.now();let loop=()=>{if(info.settings.looping){let newData={};let now=Date.now();let frame=now-lastTime;for(const key in info.settings.simulate){let newPoints=Math.floor(info.settings.simulate[key].sps*frame/1e3);newData[key]=new Array(newPoints).fill(0);newData[key]=newData[key].map((v,i)=>{return Math.sin(2*Math.PI*info.settings.simulate[key].freq*.001*(lastTime+frame*(i+1)/newPoints))*info.settings.simulate[key].amplitude+info.settings.simulate[key].offset})}lastTime=now;newData.timestamp=lastTime;info.settings.ondata(newData);setTimeout(()=>{loop()},loopTime)}};loop();if(info.settings.onconnect)info.settings.onconnect(info);res(info)})},codec:reading=>{return reading},disconnect:info=>{console.log(info);info.settings.looping=false;info.settings.ondisconnect(info)},onconnect:info=>{console.log("muse connected!",info)},ondisconnect:info=>{console.log("muse disconnected!",info)},ondata:data=>{console.log(data)}};var Devices={BLE:{"nrf5x":nrf5xBLESettings,"hegduino":hegduinoBLESettings,"hegduinoV1":hegduinoV1BLESettings,"cognixionONE":cognixionONEBLESettings,"statechanger":statechangerBLESettings,"blueberry":blueberryBLESettings,"blueberry2":blueberry2BLESettings,"heart_rate":heartRateBLESettings},USB:{"nrf5x":nrf5xSerialSettings,"freeEEG32":freeeeg32SerialSettings,"freeEEG32_optical":freeeeg32_optical_SerialSettings,"freeEEG128":freeeeg128SerialSettings,"hegduino":hegduinoSerialSettings,"hegduinoV1":hegduinoV1SerialSettings,"cyton":cytonSerialSettings,"cyton_daisy":cytonSerialSettings,"peanut":peanutSerialSettings,"statechanger":statechangerSerialSettings,"cognixionONE":cytonSerialSettings},BLE_OTHER:{},USB_OTHER:{},OTHER:{"simulator":simulatorSettings}};var textdecoder3=new TextDecoder;var decoders={"raw":data=>{if(data?.buffer)return Array.from(new Uint8Array(data));else return data},"utf8":data=>{return textdecoder3.decode(data)},"console-f12":data=>{if(data?.buffer)data=Array.from(new Uint8Array(data));console.log(data);return data},"debug":(data,debugmessage)=>{if(data?.buffer)data=Array.from(new Uint8Array(data));console.log(debugmessage,data);return data},"ads131m08":ads131m08codec,"arduino_ads131m08":ads131m08_arduinocodec,"max3010x":max3010xcodec,"mpu6050":mpu6050codec,"bme280":bme280codec,"freeeeg32":freeeeg32codec,"freeeeg128":freeeeg128codec,"cyton":cytoncodec,"cognixionONE_BLE":cognixionONE_EEG_codec,"hegduino":hegduinocodec,"nrf5x":nrf5x_usbcodec,"peanut":peanutcodec,"statechanger":statechangercodec,"blueberry":blueberrycodec,"heart_rate":hrcodec};var BiquadChannelFilterer=class{constructor(options={sps:512,useSMA4:false,useNotch50:true,useNotch60:true,useLowpass:false,lowpassHz:100,useBandpass:false,bandpassLower:3,bandpassUpper:45,useDCBlock:true,DCBresonance:.995,trimOutliers:false,outlierTolerance:.2,useScaling:false,scalar:1}){this.idx=0;this.sps=options.sps;this.bandpassLower=options.bandpassLower?options.bandpassLower:3;this.bandpassUpper=options.bandpassUpper?options.bandpassUpper:45;this.useSMA4=options.useSMA4;this.last4=[];this.useNotch50=options.useNotch50;this.useNotch60=options.useNotch60;this.useLowpass=options.useLowpass;this.lowpassHz=options.lowpassHz?options.lowpassHz:100;this.useBandpass=options.useBandpass;this.useDCBlock=options.useDCBlock;this.DCBresonance=options.DCBresonance?options.DCBresonance:.995;this.useScaling=options.useScaling;this.scalar=options.scalar;this.trimOutliers=options.trimOutliers;this.outlierTolerance=options.outlierTolerance;let sps11=this.sps;this.notch50=[makeNotchFilter(50,sps11,2),makeNotchFilter(100,sps11,2)];this.notch60=[makeNotchFilter(60,sps11,2),makeNotchFilter(120,sps11,2)];this.lp1=[new Biquad("lowpass",this.lowpassHz,sps11),new Biquad("lowpass",this.lowpassHz,sps11),new Biquad("lowpass",this.lowpassHz,sps11),new Biquad("lowpass",this.lowpassHz,sps11)];this.bp1=[makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps11,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps11,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps11,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps11,1)];this.dcb=new DCBlocker(options.DCBresonance?options.DCBresonance:.995)}reset(sps11=this.sps){this.notch50=[makeNotchFilter(50,sps11,2),makeNotchFilter(100,sps11,2)];this.notch60=[makeNotchFilter(60,sps11,2),makeNotchFilter(120,sps11,2)];this.lp1=[new Biquad("lowpass",this.lowpassHz,sps11),new Biquad("lowpass",this.lowpassHz,sps11),new Biquad("lowpass",this.lowpassHz,sps11),new Biquad("lowpass",this.lowpassHz,sps11)];this.bp1=[makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps11,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps11,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps11,1),makeBandpassFilter(this.bandpassLower,this.bandpassUpper,sps11,1)];this.dcb=new DCBlocker(this.DCBresonance)}setBandpass(bandpassLower=this.bandpassLower,bandpassUpper=this.bandpassUpper,sps11=this.sps){this.bandpassLower=bandpassLower;this.bandpassUpper=bandpassUpper;this.bp1=[makeBandpassFilter(bandpassLower,bandpassUpper,sps11),makeBandpassFilter(bandpassLower,bandpassUpper,sps11),makeBandpassFilter(bandpassLower,bandpassUpper,sps11),makeBandpassFilter(bandpassLower,bandpassUpper,sps11)]}apply(latestData=0){let out=latestData;if(this.useScaling===true){out*=this.scalar}if(this.filtered&&this.trimOutliers&&this.outlierTolerance){if(Math.abs(out-this.filtered)>this.outlierTolerance){out=this.filtered}}if(this.useDCBlock===true){out=this.dcb.applyFilter(out)}if(this.useSMA4===true){if(this.last4.length<4){this.last4.push(out)}else{out=this.last4.reduce((accumulator,currentValue)=>accumulator+currentValue)/this.last4.length;this.last4.shift();this.last4.push(out)}}if(this.useNotch50===true){this.notch50.forEach((f,i)=>{out=f.applyFilter(out)})}if(this.useNotch60===true){this.notch60.forEach((f,i)=>{out=f.applyFilter(out)})}if(this.useLowpass===true){this.lp1.forEach((f,i)=>{out=f.applyFilter(out)})}if(this.useBandpass===true){this.bp1.forEach((f,i)=>{out=f.applyFilter(out)})}this.filtered=out;this.idx++;return out}};var Biquad=class{constructor(type,freq,sps11,Q2=1/Math.sqrt(2),dbGain=0){this.a0=0;this.a1=0;this.a2=0;this.b0=0;this.b1=0;this.b2=0;this.x1=0;this.x2=0;this.y1=0;this.y2=0;let types=["lowpass","highpass","bandpass","notch","peak","lowshelf","highshelf"];if(types.indexOf(type)<0){console.error("Valid types: 'lowpass','highpass','bandpass','notch','peak','lowshelf','highshelf'");return}this.type=type;this.freq=freq;this.sps=sps11;this.Q=Q2;this.dbGain=dbGain;let A2=Math.pow(10,dbGain/40);let omega=2*Math.PI*freq/sps11;let sn3=Math.sin(omega);let cs=Math.cos(omega);let alpha=sn3/(2*Q2);let beta=Math.sqrt(A2+A2);this[type](A2,sn3,cs,alpha,beta);this.b0/=this.a0;this.b1/=this.a0;this.b2/=this.a0;this.a1/=this.a0;this.a2/=this.a0}lowpass(A2,sn3,cs,alpha,beta){this.b0=(1-cs)*.5;this.b1=1-cs;this.b2=(1-cs)*.5;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}highpass(A2,sn3,cs,alpha,beta){this.b0=(1+cs)*.5;this.b1=-(1+cs);this.b2=(1+cs)*.5;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}bandpass(A2,sn3,cs,alpha,beta){this.b0=alpha;this.b1=0;this.b2=-alpha;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}notch(A2,sn3,cs,alpha,beta){this.b0=1;this.b1=-2*cs;this.b2=1;this.a0=1+alpha;this.a1=-2*cs;this.a2=1-alpha}peak(A2,sn3,cs,alpha,beta){this.b0=1+alpha*A2;this.b1=-2*cs;this.b2=1-alpha*A2;this.a0=1+alpha/A2;this.a1=-2*cs;this.a2=1-alpha/A2}lowshelf(A2,sn3,cs,alpha,beta){this.b0=A2*(A2+1-(A2-1)*cs+beta*sn3);this.b1=2*A2*(A2-1-(A2+1)*cs);this.b2=A2*(A2+1-(A2-1)*cs-beta*sn3);this.a0=A2+1+(A2+1)*cs+beta*sn3;this.a1=2*(A2-1+(A2+1)*cs);this.a2=A2+1+(A2-1)*cs-beta*sn3}highshelf(A2,sn3,cs,alpha,beta){this.b0=A2*(A2+1+(A2-1)*cs+beta*sn3);this.b1=2*A2*(A2-1+(A2+1)*cs);this.b2=A2*(A2+1-(A2-1)*cs-beta*sn3);this.a0=A2+1-(A2+1)*cs-beta*sn3;this.a1=2*(A2-1-(A2+1)*cs);this.a2=A2+1-(A2-1)*cs-beta*sn3}applyFilter(signal_step){let y2=this.b0*signal_step+this.b1*this.x1+this.b2*this.x2-this.a1*this.y1-this.a2*this.y2;this.x2=this.x1;this.x1=signal_step;this.y2=this.y1;this.y1=y2;return y2}zResult(freq){try{let phi=Math.pow(Math.sin(Math.PI*freq*2/(2*this.sps)),2);let result=(Math.pow(this.b0+this.b1+this.b2,2)-4*(this.b0*this.b1+4*this.b0*this.b2+this.b1*this.b2)*phi+16*this.b0*this.b2*phi*phi)/(Math.pow(1+this.a1+this.a2,2)-4*(this.a1+4*this.a2+this.a1*this.a2)*phi+16*this.a2*phi*phi);return result}catch(err){return-200}}static calcCenterFrequency(freqStart,freqEnd){return(freqStart+freqEnd)/2}static calcBandwidth(freqStart,freqEnd){return freqEnd-this.calcCenterFrequency(freqStart,freqEnd)}static calcBandpassQ(frequency,bandwidth,resonance=Math.pow(10,Math.floor(Math.log10(frequency)))){let Q2=resonance*Math.sqrt((frequency-bandwidth)*(frequency+bandwidth))/(2*bandwidth);return Q2}static calcNotchQ(frequency,bandwidth,resonance=Math.pow(10,Math.floor(Math.log10(frequency)))){let Q2=resonance*frequency*bandwidth/Math.sqrt((frequency-bandwidth)*(frequency+bandwidth));return Q2}};var DCBlocker=class{constructor(r=.995){this.r=r;this.y1=this.y2=this.x1=this.x2=0}applyFilter(signal_step){this.x2=this.x1;this.x1=signal_step;let y2=this.x1-this.x2+this.r*this.y1;this.y2=this.y1;this.y1=y2;return y2}};var makeNotchFilter=(frequency,sps11,bandwidth)=>{return new Biquad("notch",frequency,sps11,Biquad.calcNotchQ(frequency,bandwidth),0)};var makeBandpassFilter=(freqStart,freqEnd,sps11,resonance=Math.pow(10,Math.floor(Math.log10(Biquad.calcCenterFrequency(freqStart,freqEnd)))))=>{return new Biquad("bandpass",Biquad.calcCenterFrequency(freqStart,freqEnd),sps11,Biquad.calcBandpassQ(Biquad.calcCenterFrequency(freqStart,freqEnd),Biquad.calcBandwidth(freqStart,freqEnd),resonance),0)};function loadStreamWorkerGlobals(){globalThis.WebSerial=WebSerial;globalThis.decoders=decoders;globalThis.decoder="raw";globalThis.ByteParser=ByteParser;globalThis.Devices=Devices;globalThis.filtering=true;globalThis.filters={};globalThis.BiquadChannelFilterer=BiquadChannelFilterer;globalThis.ArrayManip=ArrayManip}if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope){loadStreamWorkerGlobals()}var streamWorkerRoutes={"receiveDecoder":function receiveDecoder(decoder2,decoderName){globalThis.decoders[decoderName]=(0,eval)("("+decoder2+")")},"receiveCodec":function receiveDeviceCodec(decoder2,deviceType,device,service,characteristic){let codec=parseFunctionFromText(decoder2);if(codec){if(deviceType==="BLE"&&service&&characteristic){if(globalThis.Devices[deviceType][device]){if(globalThis.Devices[deviceType][device][service]){if(globalThis.Devices[deviceType][device][characteristic]){globalThis.Devices[deviceType][device][characteristic].codec=codec}else{globalThis.Devices[deviceType][device][characteristic]={codec}}}else{globalThis.Devices[deviceType][device]={[characteristic]:{codec}}}}}else if(globalThis.Devices[deviceType][device]?.codec){if(globalThis.Devices[deviceType][device])globalThis.Devices[deviceType][device].codec=codec;else{globalThis.Devices[deviceType][device]={codec}}}}},"decode":function decode(data){return globalThis.decoder(data)},"decodeAndParse":function decodeAndParse(data){let decoded=this.graph.run("decode",data);if(decoded){let parsed=globalThis.ArrayManip.reformatData(decoded);if(parsed){if(globalThis.filtering){for(const prop in parsed){if(globalThis.filters[prop]){let filter=globalThis.filters[prop];if(Array.isArray(parsed[prop])){parsed[prop]=parsed[prop].map(v=>filter.apply(v))}else if(parsed[prop]?.values){parsed[prop].values=parsed[prop].values.map(v=>filter.apply(v))}}}}return parsed}}return decoded},"setActiveDecoder":function setActiveDecoder(deviceType,device,service,characteristic){if(globalThis.Devices[deviceType][device]?.codec)globalThis.decoder=globalThis.Devices[deviceType][device]?.codec;else if(deviceType==="BLE"&&service&&characteristic&&globalThis.Devices[deviceType][device]?.[service]?.[characteristic]?.codec)globalThis.decoder=globalThis.Devices[deviceType][device][service][characteristic].codec;return true},"decodeDevice":function decodeDevice(data,deviceType,device,service,characteristic){if(globalThis.Devices[deviceType][device]?.codec)return globalThis.Devices[deviceType][device].codec(data);else if(deviceType==="BLE"&&service&&characteristic&&globalThis.Devices[deviceType][device]?.[service]?.[characteristic]?.codec)return globalThis.Devices[deviceType][device][service][characteristic].codec(data)},"decodeAndParseDevice":function decodeAndParseDevice(data,deviceType,deviceName,service,characteristic){let decoded;if(deviceType==="BLE"&&service&&characteristic&&globalThis.Devices[deviceType][deviceName]?.services[service]?.[characteristic]?.codec)decoded=globalThis.Devices[deviceType][deviceName].services[service][characteristic].codec(data);else if(globalThis.Devices[deviceType][deviceName]?.codec)decoded=globalThis.Devices[deviceType][deviceName].codec(data);else decoded=data;if(decoded){let parsed=globalThis.ArrayManip.reformatData(decoded);if(parsed){if(globalThis.filtering){for(const prop in parsed){if(globalThis.filters[prop]){let filter=globalThis.filters[prop];if(Array.isArray(parsed[prop])){parsed[prop]=parsed[prop].map(v=>filter.apply(v))}else if(parsed[prop]?.values){parsed[prop].values=parsed[prop].values.map(v=>filter.apply(v))}else if(typeof parsed[prop]==="number"){parsed[prop]=filter.apply(parsed[prop])}}}}return parsed}}return decoded},"toggleAnim":function toggleAnim(){globalThis.runningAnim=!globalThis.runningAnim;return globalThis.runningAnim},"setFilters":function setFilters(filters,clearFilters=false){if(!globalThis.filters||clearFilters)globalThis.filters={};for(const key in filters){globalThis.filters[key]=new BiquadChannelFilterer(filters[key])}return true},"getFilterSettings":function getFilterSettings(){if(globalThis.filters){let filters={};for(const key in globalThis.filters){filters[key]={sps:globalThis.filters[key].sps,useScaling:globalThis.filters[key].useScaling,scalar:globalThis.filters[key].scalar,useNotch50:globalThis.filters[key].useNotch50,useNotch60:globalThis.filters[key].useNotch60,useDCBlock:globalThis.filters[key].useDCBlock,useLowpass:globalThis.filters[key].useLowpass,lowpassHz:globalThis.filters[key].lowpassHz,useBandpass:globalThis.filters[key].useBandpass,bandpassLower:globalThis.filters[key].bandpassLower,bandpassUpper:globalThis.filters[key].bandpassUpper}}return filters}return void 0},"setupSerial":function setupSerial(){globalThis.Serial=new globalThis.WebSerial;globalThis.decoder="raw";console.log("worker: Setting up Serial",globalThis.Serial);return true},"openPort":function openPort(settings){const WorkerService2=this.graph;if(!globalThis.Serial)WorkerService2.run("setupSerial");return new Promise((res,rej)=>{globalThis.Serial.getPorts().then(ports=>{const Serial=globalThis.Serial;let port=ports.find(port2=>{return port2.getInfo().usbVendorId===settings.usbVendorId&&port2.getInfo().usbProductId===settings.usbProductId});if(port){Serial.openPort(port,settings).then(()=>{const stream=Serial.createStream({port,settings,frequency:settings.frequency?settings.frequency:10,buffering:settings.buffering,ondata:value=>{if(stream.settings.pipeTo){if(typeof stream.settings.pipeTo==="string")WorkerService2.transmit(value,stream.settings.pipeTo,[value.buffer]);else if(stream.settings.pipeTo?.route){let args=value;if(stream.settings.pipeTo.extraArgs)args=[value,...stream.settings.pipeTo.extraArgs];WorkerService2.transmit({route:stream.settings.pipeTo.route,args},stream.settings.pipeTo._id,[value.buffer])}}else{WorkerService2.transmit(value,void 0,[value.buffer])}}});Serial.readStream(stream);port.ondisconnect=()=>{postMessage(`${stream._id} disconnected`)};res({_id:stream._id,settings,info:stream.info})}).catch(()=>{postMessage(`disconnected`)});;}else{rej(false)}})})},"closeStream":function closeStream(streamId){return new Promise((res,rej)=>{const Serial=globalThis.Serial;let ondisconnect;if(Serial.streams[streamId].port?.ondisconnect)ondisconnect=Serial.streams[streamId].port.ondisconnect;Serial.closeStream(Serial.streams[streamId]).then(resolved=>{if(ondisconnect)ondisconnect(void 0);res(resolved)}).catch(rej)})},"writeStream":function writeStream(streamId,message){globalThis.Serial.writeStream(globalThis.Serial.streams[streamId],message);return true},"updateStreamSettings":function updateStreamSettings(streamId,settings){if(globalThis.Serial?.streams[streamId]){for(const key in settings){if(typeof settings[key]==="object"){Object.assign(globalThis.Serial.streams[streamId].settings[key],settings[key])}else globalThis.Serial.streams[streamId][key]=settings[key]}}}};if(typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope){const worker=new WorkerService({routes:[workerCanvasRoutes,subprocessRoutes,streamWorkerRoutes],includeClassName:false})}var stream_worker_default=self;})();
